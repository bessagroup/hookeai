<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>hookeai.model_architectures.rnn_base_model.train.training.train_model &mdash; hookeai 1.0.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/readthedocs-custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="hookeai.model_architectures.rnn_base_model.train.training.write_training_summary_file" href="hookeai.model_architectures.rnn_base_model.train.training.write_training_summary_file.html" />
    <link rel="prev" title="hookeai.model_architectures.rnn_base_model.train.training.seed_worker" href="hookeai.model_architectures.rnn_base_model.train.training.seed_worker.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            hookeai
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rst_doc_files/getting_started/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst_doc_files/getting_started/installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rst_doc_files/features/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst_doc_files/features/data_generation.html">Data generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst_doc_files/features/material_models.html">Material model architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst_doc_files/features/local_model_updating.html">Local material model updating</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst_doc_files/features/global_model_updating.html">Global material model updating</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst_doc_files/features/data_analysis.html">Data analysis and visualization tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst_doc_files/features/tensor_matrix.html">Tensorial algebra and matrix operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst_doc_files/features/other.html">Other utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="hookeai.html">Code</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="hookeai.data_generation.html">hookeai.data_generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="hookeai.ioput.html">hookeai.ioput</a></li>
<li class="toctree-l2"><a class="reference internal" href="hookeai.material_model_finder.html">hookeai.material_model_finder</a></li>
<li class="toctree-l2"><a class="reference internal" href="hookeai.miscellaneous.html">hookeai.miscellaneous</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="hookeai.model_architectures.html">hookeai.model_architectures</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="hookeai.model_architectures.hybrid_base_model.html">hookeai.model_architectures.hybrid_base_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="hookeai.model_architectures.materials.html">hookeai.model_architectures.materials</a></li>
<li class="toctree-l3"><a class="reference internal" href="hookeai.model_architectures.procedures.html">hookeai.model_architectures.procedures</a></li>
<li class="toctree-l3"><a class="reference internal" href="hookeai.model_architectures.rc_base_model.html">hookeai.model_architectures.rc_base_model</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="hookeai.model_architectures.rnn_base_model.html">hookeai.model_architectures.rnn_base_model</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="hookeai.model_architectures.rnn_base_model.custom.html">hookeai.model_architectures.rnn_base_model.custom</a></li>
<li class="toctree-l4"><a class="reference internal" href="hookeai.model_architectures.rnn_base_model.model.html">hookeai.model_architectures.rnn_base_model.model</a></li>
<li class="toctree-l4"><a class="reference internal" href="hookeai.model_architectures.rnn_base_model.optimization.html">hookeai.model_architectures.rnn_base_model.optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="hookeai.model_architectures.rnn_base_model.predict.html">hookeai.model_architectures.rnn_base_model.predict</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="hookeai.model_architectures.rnn_base_model.train.html">hookeai.model_architectures.rnn_base_model.train</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hookeai.simulators.html">hookeai.simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="hookeai.time_series_data.html">hookeai.time_series_data</a></li>
<li class="toctree-l2"><a class="reference internal" href="hookeai.utilities.html">hookeai.utilities</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">License</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../license.html">MIT License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">hookeai</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="hookeai.html">hookeai</a></li>
          <li class="breadcrumb-item"><a href="hookeai.model_architectures.html">hookeai.model_architectures</a></li>
          <li class="breadcrumb-item"><a href="hookeai.model_architectures.rnn_base_model.html">hookeai.model_architectures.rnn_base_model</a></li>
          <li class="breadcrumb-item"><a href="hookeai.model_architectures.rnn_base_model.train.html">hookeai.model_architectures.rnn_base_model.train</a></li>
          <li class="breadcrumb-item"><a href="hookeai.model_architectures.rnn_base_model.train.training.html">hookeai.model_architectures.rnn_base_model.train.training</a></li>
      <li class="breadcrumb-item active">hookeai.model_architectures.rnn_base_model.train.training.train_model</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="hookeai-model-architectures-rnn-base-model-train-training-train-model">
<h1>hookeai.model_architectures.rnn_base_model.train.training.train_model<a class="headerlink" href="#hookeai-model-architectures-rnn-base-model-train-training-train-model" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="hookeai.model_architectures.rnn_base_model.train.training.train_model">
<span class="sig-name descname"><span class="pre">train_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_max_epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_init_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_nature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'features_out'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mse'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_scaling_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean-std'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_scaling_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_sampler_shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_early_stopping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stopping_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_load_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_every</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_file_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hookeai/model_architectures/rnn_base_model/train/training.html#train_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hookeai.model_architectures.rnn_base_model.train.training.train_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Training of recurrent neural network model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_max_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Maximum number of training epochs.</p></li>
<li><p><strong>dataset</strong> (<em>torch.utils.data.Dataset</em>) – Time series data set. Each sample is stored as a dictionary where
each feature (key, str) data is a torch.Tensor(2d) of shape
(sequence_length, n_features).</p></li>
<li><p><strong>model_init_args</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Recurrent neural network model class initialization parameters (check
class GRURNNModel).</p></li>
<li><p><strong>lr_init</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Initial value optimizer learning rate. Constant learning rate value if
no learning rate scheduler is specified (lr_scheduler_type=None).</p></li>
<li><p><strong>opt_algorithm</strong> (<em>{'adam'</em><em>,</em><em>}</em><em>, </em><em>default='adam'</em>) – <p>Optimization algorithm:</p>
<p>’adam’  : Adam (torch.optim.Adam)</p>
</p></li>
<li><p><strong>lr_scheduler_type</strong> (<em>{'steplr'</em><em>, </em><em>'explr'</em><em>, </em><em>'linlr'}</em><em>, </em><em>default=None</em>) – <p>Type of learning rate scheduler:</p>
<p>’steplr’  : Step-based decay (torch.optim.lr_scheduler.SetpLR)</p>
<p>’explr’   : Exponential decay (torch.optim.lr_scheduler.ExponentialLR)</p>
<p>’linlr’   : Linear decay (torch.optim.lr_scheduler.LinearLR)</p>
</p></li>
<li><p><strong>lr_scheduler_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>default={}</em>) – Arguments of torch.optim.lr_scheduler.LRScheduler initializer.</p></li>
<li><p><strong>loss_nature</strong> (<em>{'features_out'</em><em>,</em><em>}</em><em>, </em><em>default='features_out'</em>) – <p>Loss nature:</p>
<p>’features_out’ : Based on output features</p>
</p></li>
<li><p><strong>loss_type</strong> (<em>{'mse'</em><em>,</em><em>}</em><em>, </em><em>default='mse'</em>) – <p>Loss function type:</p>
<p>’mse’  : MSE (torch.nn.MSELoss)</p>
</p></li>
<li><p><strong>loss_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>default={}</em>) – Arguments of torch.nn._Loss initializer.</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>default=1</em>) – Number of samples loaded per batch.</p></li>
<li><p><strong>data_scaling_type</strong> (<em>{'min-max'</em><em>, </em><em>'mean-std'}</em><em>, </em><em>default='mean-std'</em>) – Type of data scaling. Min-Max scaling (‘min-max’) or
standardization (‘mean-std’). Only effective if model input or output
features are normalized.</p></li>
<li><p><strong>data_scaling_parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>default={}</em>) – Data scaling parameters (item, dict) for each features type
(key, str). For ‘min-max’ data scaling, the parameters are the
‘minimum’ and ‘maximum’ features normalization tensors, as well as
the ‘norm_minimum’ and ‘norm_maximum’ normalization bounds. For
‘mean-std’ data scaling, the parameters are the ‘mean’ and ‘std’
features normalization tensors. Only effective if model input or output
features are normalized.</p></li>
<li><p><strong>is_sampler_shuffle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>default=False</em>) – If True, shuffles data set samples at every epoch.</p></li>
<li><p><strong>is_early_stopping</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>default=False</em>) – If True, then training process is halted when early stopping criterion
is triggered.</p></li>
<li><p><strong>early_stopping_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>default={}</em>) – Early stopping criterion parameters (key, str, item, value).</p></li>
<li><p><strong>model_load_state</strong> (<em>{'default'</em><em>, </em><em>'init'</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>'best'</em><em>, </em><em>'last'}</em><em>,</em>) – <p>default=’default’
Available model state to be loaded from the model directory.
Options:</p>
<p>’default’   : Model default state file</p>
<p>’init’      : Model initial state</p>
<p>int         : Model state of given training epoch</p>
<p>’best’      : Model state of best performance</p>
<p>’last’      : Model state of latest training epoch</p>
</p></li>
<li><p><strong>save_every</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>default=None</em>) – Save model every save_every epochs. If None, then saves only initial,
last epoch and best performance states.</p></li>
<li><p><strong>dataset_file_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>default=None</em>) – Time series data set file path if such file exists. Only used for
output purposes.</p></li>
<li><p><strong>device_type</strong> (<em>{'cpu'</em><em>, </em><em>'cuda'}</em><em>, </em><em>default='cpu'</em>) – Type of device on which torch.Tensor is allocated.</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>default=None</em>) – Seed used to initialize the random number generators of Python and
other libraries (e.g., NumPy, PyTorch) for all devices to preserve
reproducibility. Does also set workers seed in PyTorch data loaders.</p></li>
<li><p><strong>is_verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>default=False</em>) – If True, enable verbose output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – Recurrent neural network model.</p></li>
<li><p><strong>best_loss</strong> (<em>float</em>) – Best loss during training process.</p></li>
<li><p><strong>best_training_epoch</strong> (<em>int</em>) – Training epoch corresponding to best loss during training process.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hookeai.model_architectures.rnn_base_model.train.training.seed_worker.html" class="btn btn-neutral float-left" title="hookeai.model_architectures.rnn_base_model.train.training.seed_worker" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hookeai.model_architectures.rnn_base_model.train.training.write_training_summary_file.html" class="btn btn-neutral float-right" title="hookeai.model_architectures.rnn_base_model.train.training.write_training_summary_file" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Bernardo Ferreira.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>