<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>user_scripts.synthetic_data.gen_response_dataset &mdash; hookeai 1.0.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/readthedocs-custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            hookeai
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/getting_started/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/getting_started/installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/features/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/features/data_generation.html">Data generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/features/material_models.html">Material model architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/features/local_model_updating.html">Local material model updating</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/features/global_model_updating.html">Global material model updating</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/features/data_analysis.html">Data analysis and visualization tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/features/tensor_matrix.html">Tensorial algebra and matrix operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/features/other.html">Other utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../_autosummary/hookeai.html">Code</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">License</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">MIT License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">hookeai</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">user_scripts.synthetic_data.gen_response_dataset</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for user_scripts.synthetic_data.gen_response_dataset</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Generate strain-stress material response data set.</span>

<span class="sd">Classes</span>
<span class="sd">-------</span>
<span class="sd">MaterialResponseDatasetGenerator</span>
<span class="sd">    Strain-stress material response path data set generator.</span>
<span class="sd">    </span>
<span class="sd">Functions</span>
<span class="sd">---------</span>
<span class="sd">generate_dataset_plots</span>
<span class="sd">    Generate plots for strain-stress material response path data set.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#</span>
<span class="c1">#                                                                       Modules</span>
<span class="c1"># =============================================================================</span>
<span class="c1"># Standard</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>
<span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="c1"># Add project root directory to sys.path</span>
<span class="n">root_dir</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parents</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="k">if</span> <span class="n">root_dir</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">root_dir</span><span class="p">)</span>
<span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="c1"># Third-party</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tqdm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="c1"># Local</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">time_series_data.time_dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesDatasetInMemory</span><span class="p">,</span> \
    <span class="n">TimeSeriesDataset</span><span class="p">,</span> <span class="n">get_time_series_data_loader</span><span class="p">,</span> <span class="n">save_dataset</span><span class="p">,</span> <span class="n">load_dataset</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">data_generation.strain_paths.interface</span><span class="w"> </span><span class="kn">import</span> <span class="n">StrainPathGenerator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">data_generation.strain_paths.random_path</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomStrainPathGenerator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">data_generation.strain_paths.proportional_path</span><span class="w"> </span><span class="kn">import</span> \
    <span class="n">ProportionalStrainPathGenerator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">simulators.fetorch.math.matrixops</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_problem_type_parameters</span><span class="p">,</span> \
    <span class="n">get_tensor_from_mf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">simulators.fetorch.material.material_su</span><span class="w"> </span><span class="kn">import</span> <span class="n">material_state_update</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">simulators.fetorch.material.models.standard.elastic</span><span class="w"> </span><span class="kn">import</span> <span class="n">Elastic</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">simulators.fetorch.material.models.standard.von_mises</span><span class="w"> </span><span class="kn">import</span> <span class="n">VonMises</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">simulators.fetorch.material.models.standard.drucker_prager</span><span class="w"> </span><span class="kn">import</span> \
    <span class="n">DruckerPrager</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">simulators.fetorch.material.models.standard.lou</span><span class="w"> </span><span class="kn">import</span> <span class="n">LouZhangYoon</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">simulators.fetorch.material.models.standard.hardening</span><span class="w"> </span><span class="kn">import</span> \
    <span class="n">get_hardening_law</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ioput.iostandard</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_directory</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ioput.plots</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_xy_data</span><span class="p">,</span> <span class="n">plot_xyz_data</span><span class="p">,</span> <span class="n">scatter_xy_data</span><span class="p">,</span> \
    <span class="n">plot_histogram</span><span class="p">,</span> <span class="n">plot_boxplots</span><span class="p">,</span> <span class="n">save_figure</span>
<span class="c1">#</span>
<span class="c1">#                                                          Authorship &amp; Credits</span>
<span class="c1"># =============================================================================</span>
<span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;Bernardo Ferreira (bernardo_ferreira@brown.edu)&#39;</span>
<span class="n">__credits__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Bernardo Ferreira&#39;</span><span class="p">,</span> <span class="p">]</span>
<span class="n">__status__</span> <span class="o">=</span> <span class="s1">&#39;Stable&#39;</span>
<span class="c1"># =============================================================================</span>
<span class="c1">#</span>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="MaterialResponseDatasetGenerator"><a class="viewcode-back" href="../../../_autosummary/hookeai.miscellaneous.materials.compare_material_models.MaterialResponseDatasetGenerator.html#hookeai.miscellaneous.dataset_processing.read_csv_response_dataset.MaterialResponseDatasetGenerator">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">MaterialResponseDatasetGenerator</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Strain-stress material response path data set generator.</span>
<span class="sd">    </span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    _strain_formulation: {&#39;infinitesimal&#39;, &#39;finite&#39;}</span>
<span class="sd">        Strain formulation.</span>
<span class="sd">    _problem_type : int</span>
<span class="sd">        Problem type: 2D plane strain (1), 2D plane stress (2),</span>
<span class="sd">        2D axisymmetric (3) and 3D (4).</span>
<span class="sd">    _n_dim : int</span>
<span class="sd">        Problem number of spatial dimensions.</span>
<span class="sd">    _comp_order_sym : tuple[str]</span>
<span class="sd">        Strain/Stress components symmetric order.</span>
<span class="sd">    _comp_order_nsym : tuple[str]</span>
<span class="sd">        Strain/Stress components nonsymmetric order.</span>
<span class="sd">    </span>
<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    generate_response_dataset(self, n_path, strain_path_type,</span>
<span class="sd">                              strain_path_kwargs, model_name, \</span>
<span class="sd">                              model_parameters, state_features={}, \</span>
<span class="sd">                              is_in_memory_dataset=True, \</span>
<span class="sd">                              dataset_directory=None, \</span>
<span class="sd">                              dataset_basename=None, \</span>
<span class="sd">                              save_dir=None, is_save_fig=False, \</span>
<span class="sd">                              is_verbose=False)</span>
<span class="sd">        Generate strain-stress material response path data set.</span>
<span class="sd">    compute_stress_path(self, strain_comps, time_hist, strain_path, \</span>
<span class="sd">                        constitutive_model)</span>
<span class="sd">        Compute material stress response for given strain path.</span>
<span class="sd">    build_tensor_from_comps(n_dim, comps, comps_array, is_symmetric=False)</span>
<span class="sd">        Build strain/stress tensor from given components.</span>
<span class="sd">    store_tensor_comps(comps, tensor)</span>
<span class="sd">        Store strain/stress tensor components in array.</span>
<span class="sd">    gen_response_dataset_from_csv(self, response_file_paths, \</span>
<span class="sd">                                  is_in_memory_dataset=True, \</span>
<span class="sd">                                  dataset_directory, save_dir=None, \</span>
<span class="sd">                                  is_save_fig=False, is_verbose=False)</span>
<span class="sd">    gen_response_dataset_from_strain_dataset(self, dataset_path, model_name, \</span>
<span class="sd">                                             model_parameters, \</span>
<span class="sd">                                             state_features={}, \</span>
<span class="sd">                                             is_verbose=False)</span>
<span class="sd">        Generate material response data set from strain data set.</span>
<span class="sd">    plot_material_response_path(cls, strain_formulation, n_dim, \</span>
<span class="sd">                                strain_comps_order, strain_path, \</span>
<span class="sd">                                stress_comps_order, stress_path, \</span>
<span class="sd">                                time_hist, \</span>
<span class="sd">                                is_plot_strain_stress_paths=False, \</span>
<span class="sd">                                is_plot_eq_strain_stress=False, \</span>
<span class="sd">                                stress_units=&#39;&#39;, \</span>
<span class="sd">                                filename=&#39;response_path&#39;, \</span>
<span class="sd">                                save_dir=None, is_save_fig=False, \</span>
<span class="sd">                                is_stdout_display=False, is_latex=False)</span>
<span class="sd">        Plot strain-stress material response path.</span>
<span class="sd">    plot_stress_space_metrics(cls, strain_formulation, stress_comps_order, \</span>
<span class="sd">                              stress_path, time_hist, \</span>
<span class="sd">                              is_plot_principal_stress_path=False, \</span>
<span class="sd">                              is_plot_stress_invar_hist=False, \</span>
<span class="sd">                              is_plot_stress_invar_box=False, \</span>
<span class="sd">                              is_plot_stress_path_triax_lode=False, \</span>
<span class="sd">                              is_plot_stress_triax_lode_hist=False, \</span>
<span class="sd">                              is_plot_stress_triax_lode_box=False, \</span>
<span class="sd">                              stress_units=&#39;&#39;, \</span>
<span class="sd">                              filename=&#39;stress_path&#39;, \</span>
<span class="sd">                              save_dir=None, is_save_fig=False, \</span>
<span class="sd">                              is_stdout_display=False, is_latex=False)</span>
<span class="sd">        Plot strain-stress material response path in principal stress space.</span>
<span class="sd">    compute_stress_invariants(stress)</span>
<span class="sd">        Compute stress invariants.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="MaterialResponseDatasetGenerator.__init__"><a class="viewcode-back" href="../../../_autosummary/hookeai.miscellaneous.materials.compare_material_models.MaterialResponseDatasetGenerator.html#hookeai.miscellaneous.dataset_processing.read_csv_response_dataset.MaterialResponseDatasetGenerator.__init__">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strain_formulation</span><span class="p">,</span> <span class="n">problem_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        strain_formulation: {&#39;infinitesimal&#39;, &#39;finite&#39;}</span>
<span class="sd">            Strain formulation.</span>
<span class="sd">        problem_type : int</span>
<span class="sd">            Problem type: 2D plane strain (1), 2D plane stress (2),</span>
<span class="sd">            2D axisymmetric (3) and 3D (4).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Set problem strain formulation and type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span> <span class="o">=</span> <span class="n">strain_formulation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_problem_type</span> <span class="o">=</span> <span class="n">problem_type</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Get problem type parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_dim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comp_order_sym</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comp_order_nsym</span> <span class="o">=</span> \
            <span class="n">get_problem_type_parameters</span><span class="p">(</span><span class="n">problem_type</span><span class="p">)</span></div>
    <span class="c1"># -------------------------------------------------------------------------</span>
<div class="viewcode-block" id="MaterialResponseDatasetGenerator.generate_response_dataset"><a class="viewcode-back" href="../../../_autosummary/hookeai.miscellaneous.materials.compare_material_models.MaterialResponseDatasetGenerator.html#hookeai.miscellaneous.dataset_processing.read_csv_response_dataset.MaterialResponseDatasetGenerator.generate_response_dataset">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_response_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_path</span><span class="p">,</span> <span class="n">strain_path_type</span><span class="p">,</span>
                                  <span class="n">strain_path_kwargs</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span>
                                  <span class="n">model_parameters</span><span class="p">,</span> <span class="n">state_features</span><span class="o">=</span><span class="p">{},</span>
                                  <span class="n">is_in_memory_dataset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                  <span class="n">dataset_directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">dataset_basename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">save_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                  <span class="n">is_verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate strain-stress material response path data set.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n_path : int</span>
<span class="sd">            Number of strain-stress paths.</span>
<span class="sd">        strain_path_type : {&#39;random&#39;, &#39;proportional&#39;}</span>
<span class="sd">            Strain path type that sets the corresponding generator. </span>
<span class="sd">        strain_path_kwargs : dict</span>
<span class="sd">            Parameters of strain path generator method set by strain_path_type.</span>
<span class="sd">        model_name : str</span>
<span class="sd">            FETorch material constitutive model name.</span>
<span class="sd">        model_parameters : dict</span>
<span class="sd">            FETorch material constitutive model parameters.</span>
<span class="sd">        state_features : dict, default={}</span>
<span class="sd">            FETorch material constitutive model state variables (key, str) and</span>
<span class="sd">            corresponding dimensionality (item, int) for which the path history</span>
<span class="sd">            is additionally included in the data set. Tensorial state variables</span>
<span class="sd">            stored in matricial form are included in the data set without any</span>
<span class="sd">            matricial form coefficients (true components are extracted).</span>
<span class="sd">            Unavailable state variables are ignored.</span>
<span class="sd">        is_in_memory_dataset : bool, default=True</span>
<span class="sd">            If True, then generate in-memory time series data set, otherwise</span>
<span class="sd">            time series data set samples are stored in local directory.</span>
<span class="sd">        dataset_directory : str, default=None</span>
<span class="sd">            Directory where the time series data set is stored (all data set</span>
<span class="sd">            samples files). Required if is_in_memory_dataset=False.</span>
<span class="sd">        dataset_basename : str, default=None</span>
<span class="sd">            Data set file base name. Required if is_in_memory_dataset=False.</span>
<span class="sd">        save_dir : str, default=None</span>
<span class="sd">            Directory where figure is saved. If None, then figure is saved in</span>
<span class="sd">            current working directory.</span>
<span class="sd">        is_save_fig : bool, default=False</span>
<span class="sd">            Save figure.</span>
<span class="sd">        is_verbose : bool, default=False</span>
<span class="sd">            If True, enable verbose output.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dataset : torch.utils.data.Dataset</span>
<span class="sd">            Time series data set. Each sample is stored as a dictionary where</span>
<span class="sd">            each feature (key, str) data is a torch.Tensor(2d) of shape</span>
<span class="sd">            (sequence_length, n_features).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start_time_sec</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">is_verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Generate strain-stress material response path data set&#39;</span>
                  <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">------------------------------------------------------&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Check data set parameters requirements</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_in_memory_dataset</span><span class="p">:</span>
            <span class="c1"># Check data set directory</span>
            <span class="k">if</span> <span class="n">dataset_directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Time series data set directory must be &#39;</span>
                                   <span class="s1">&#39;provided when is_in_memory_dataset=False.&#39;</span><span class="p">)</span>
            <span class="c1"># Check data set file base name</span>
            <span class="k">if</span> <span class="n">dataset_basename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Time series data set file base name must &#39;</span>
                                   <span class="s1">&#39;be provided when &#39;</span>
                                   <span class="s1">&#39;is_in_memory_dataset=False.&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Initialize strain path generator</span>
        <span class="k">if</span> <span class="n">strain_path_type</span> <span class="o">==</span> <span class="s1">&#39;random&#39;</span><span class="p">:</span>
            <span class="n">strain_path_generator</span> <span class="o">=</span> <span class="n">RandomStrainPathGenerator</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_dim</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">strain_path_type</span> <span class="o">==</span> <span class="s1">&#39;proportional&#39;</span><span class="p">:</span>
            <span class="n">strain_path_generator</span> <span class="o">=</span> <span class="n">ProportionalStrainPathGenerator</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_dim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Unknown strain path type.&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Initialize constitutive model</span>
        <span class="k">if</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;elastic&#39;</span><span class="p">:</span>
            <span class="n">constitutive_model</span> <span class="o">=</span> <span class="n">Elastic</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem_type</span><span class="p">,</span> <span class="n">model_parameters</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;von_mises&#39;</span><span class="p">:</span>
            <span class="n">constitutive_model</span> <span class="o">=</span> <span class="n">VonMises</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem_type</span><span class="p">,</span> <span class="n">model_parameters</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;drucker_prager&#39;</span><span class="p">:</span>
            <span class="n">constitutive_model</span> <span class="o">=</span> <span class="n">DruckerPrager</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem_type</span><span class="p">,</span> <span class="n">model_parameters</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;lou_zhang_yoon&#39;</span><span class="p">:</span>
            <span class="n">constitutive_model</span> <span class="o">=</span> <span class="n">LouZhangYoon</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem_type</span><span class="p">,</span> <span class="n">model_parameters</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unknown material constitutive model &#39;</span>
                               <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="se">\&#39;</span><span class="s1">.&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set maximum number of sample trials</span>
        <span class="n">max_path_trials</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="c1"># Initialize total number of failed sample trials</span>
        <span class="n">total_n_path_fail</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Initialize time series data set samples</span>
        <span class="k">if</span> <span class="n">is_in_memory_dataset</span><span class="p">:</span>
            <span class="n">dataset_samples</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dataset_sample_files</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">if</span> <span class="n">is_verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&gt; Strain paths type: </span><span class="si">{</span><span class="n">strain_path_type</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&gt; Starting strain-stress paths generation process...</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Loop over samples</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_path</span><span class="p">),</span>
                           <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;&gt; Generating strain-stress paths: &#39;</span><span class="p">,</span>
                           <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="n">is_verbose</span><span class="p">):</span>
            <span class="c1"># Initialize number of sample trials</span>
            <span class="n">n_path_trials</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="c1"># Initialize stress response path failure flag</span>
            <span class="n">is_stress_path_fail</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Attempt to compute material response</span>
            <span class="k">while</span> <span class="n">is_stress_path_fail</span><span class="p">:</span>
                <span class="c1"># Increment number of sample trials</span>
                <span class="n">n_path_trials</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="c1"># Generate strain path</span>
                <span class="n">strain_comps_order</span><span class="p">,</span> <span class="n">time_hist</span><span class="p">,</span> <span class="n">strain_path</span> <span class="o">=</span> \
                    <span class="n">strain_path_generator</span><span class="o">.</span><span class="n">generate_strain_path</span><span class="p">(</span>
                        <span class="o">**</span><span class="n">strain_path_kwargs</span><span class="p">)</span>
                <span class="c1"># Compute material response</span>
                <span class="n">stress_comps_order</span><span class="p">,</span> <span class="n">stress_path</span><span class="p">,</span> <span class="n">state_path</span><span class="p">,</span> \
                    <span class="n">is_stress_path_fail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_stress_path</span><span class="p">(</span>
                        <span class="n">strain_comps_order</span><span class="p">,</span> <span class="n">time_hist</span><span class="p">,</span> <span class="n">strain_path</span><span class="p">,</span>
                        <span class="n">constitutive_model</span><span class="p">,</span> <span class="n">state_features</span><span class="o">=</span><span class="n">state_features</span><span class="p">,</span>
                        <span class="n">is_verbose</span><span class="o">=</span><span class="n">is_verbose</span><span class="p">)</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Update total number of failed sample trials</span>
                <span class="k">if</span> <span class="n">is_stress_path_fail</span><span class="p">:</span>
                    <span class="n">total_n_path_fail</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Check maximum number of sample trials</span>
                <span class="k">if</span> <span class="n">n_path_trials</span> <span class="o">&gt;</span> <span class="n">max_path_trials</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The maximum of number of trials &#39;</span>
                                       <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="n">max_path_trials</span><span class="si">}</span><span class="s1">) to compute &#39;</span>
                                       <span class="sa">f</span><span class="s1">&#39;a material response path sample was &#39;</span>
                                       <span class="sa">f</span><span class="s1">&#39;reached without success.&#39;</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Initialize material response path data</span>
            <span class="n">response_path</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1"># Assemble strain-stress material response path</span>
            <span class="n">response_path</span><span class="p">[</span><span class="s1">&#39;strain_comps_order&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strain_comps_order</span>
            <span class="n">response_path</span><span class="p">[</span><span class="s1">&#39;strain_path&#39;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">strain_path</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">get_default_dtype</span><span class="p">())</span>
            <span class="n">response_path</span><span class="p">[</span><span class="s1">&#39;stress_comps_order&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stress_comps_order</span>
            <span class="n">response_path</span><span class="p">[</span><span class="s1">&#39;stress_path&#39;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">stress_path</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">get_default_dtype</span><span class="p">())</span>
            <span class="c1"># Assemble time path</span>
            <span class="n">response_path</span><span class="p">[</span><span class="s1">&#39;time_hist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
                <span class="n">time_hist</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">get_default_dtype</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c1"># Assemble state variables path</span>
            <span class="k">for</span> <span class="n">state_var</span> <span class="ow">in</span> <span class="n">state_path</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">response_path</span><span class="p">[</span><span class="n">state_var</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
                    <span class="n">state_path</span><span class="p">[</span><span class="n">state_var</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">get_default_dtype</span><span class="p">())</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Store strain-stress material response path</span>
            <span class="k">if</span> <span class="n">is_in_memory_dataset</span><span class="p">:</span>
                <span class="c1"># Store material response path (in memory)</span>
                <span class="n">dataset_samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">response_path</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Set material response path file path</span>
                <span class="n">sample_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dataset_directory</span><span class="p">,</span>
                                                <span class="sa">f</span><span class="s1">&#39;ss_response_path_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">.pt&#39;</span><span class="p">)</span>
                <span class="c1"># Store material response path (local directory)</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">response_path</span><span class="p">,</span> <span class="n">sample_file_path</span><span class="p">)</span>
                <span class="c1"># Append material response path file path</span>
                <span class="n">dataset_sample_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sample_file_path</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Plot material response path</span>
            <span class="k">if</span> <span class="n">is_save_fig</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">save_dir</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_material_response_path</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_dim</span><span class="p">,</span>
                    <span class="n">strain_comps_order</span><span class="p">,</span> <span class="n">strain_path</span><span class="p">,</span>
                    <span class="n">stress_comps_order</span><span class="p">,</span> <span class="n">stress_path</span><span class="p">,</span>
                    <span class="n">time_hist</span><span class="p">,</span>
                    <span class="n">is_plot_strain_stress_paths</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">is_plot_eq_strain_stress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;response_path_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                    <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">,</span> <span class="n">is_save_fig</span><span class="o">=</span><span class="n">is_save_fig</span><span class="p">,</span>
                    <span class="n">is_stdout_display</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">if</span> <span class="n">is_verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&gt; Finished strain-stress paths generation process!</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">if</span> <span class="n">is_verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&gt; Total number of failed sample trials: &#39;</span>
                  <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">total_n_path_fail</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Create strain-stress material response path data set</span>
        <span class="k">if</span> <span class="n">is_in_memory_dataset</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="n">TimeSeriesDatasetInMemory</span><span class="p">(</span><span class="n">dataset_samples</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="n">TimeSeriesDataset</span><span class="p">(</span><span class="n">dataset_directory</span><span class="p">,</span>
                                        <span class="n">dataset_sample_files</span><span class="p">,</span>
                                        <span class="n">dataset_basename</span><span class="o">=</span><span class="n">dataset_basename</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Compute total generation time and average generation time per path</span>
        <span class="n">total_time_sec</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time_sec</span>
        <span class="n">avg_time_sec</span> <span class="o">=</span> <span class="n">total_time_sec</span><span class="o">/</span><span class="n">n_path</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">if</span> <span class="n">is_verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&gt; Total generation time: &#39;</span>
                  <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">total_time_sec</span><span class="p">)))</span><span class="si">}</span><span class="s1"> | &#39;</span>
                  <span class="sa">f</span><span class="s1">&#39;Avg. generation time per path: &#39;</span>
                  <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">avg_time_sec</span><span class="p">)))</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">return</span> <span class="n">dataset</span></div>
    <span class="c1"># -------------------------------------------------------------------------</span>
<div class="viewcode-block" id="MaterialResponseDatasetGenerator.compute_stress_path"><a class="viewcode-back" href="../../../_autosummary/hookeai.miscellaneous.materials.compare_material_models.MaterialResponseDatasetGenerator.html#hookeai.miscellaneous.dataset_processing.read_csv_response_dataset.MaterialResponseDatasetGenerator.compute_stress_path">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">compute_stress_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strain_comps_order</span><span class="p">,</span> <span class="n">time_hist</span><span class="p">,</span> <span class="n">strain_path</span><span class="p">,</span>
                            <span class="n">constitutive_model</span><span class="p">,</span> <span class="n">state_features</span><span class="o">=</span><span class="p">{},</span>
                            <span class="n">is_verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute material stress response for given strain path.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        strain_comps_order : tuple[str]</span>
<span class="sd">            Strain components order.</span>
<span class="sd">        time_hist : numpy.ndarray(1d)</span>
<span class="sd">            Discrete time history.</span>
<span class="sd">        strain_path : numpy.ndarray(2d)</span>
<span class="sd">            Strain path history stored as numpy.ndarray(2d) of shape</span>
<span class="sd">            (sequence_length, n_strain_comps).</span>
<span class="sd">        constitutive_model : ConstitutiveModel</span>
<span class="sd">            FETorch material constitutive model.</span>
<span class="sd">        state_features : dict, default={}</span>
<span class="sd">            FETorch material constitutive model state variables (key, str) and</span>
<span class="sd">            corresponding dimensionality (item, int) for which the path history</span>
<span class="sd">            is additionally included in the data set. Tensorial state variables</span>
<span class="sd">            stored in matricial form are included in the data set without any</span>
<span class="sd">            matricial form coefficients (true components are extracted).</span>
<span class="sd">            Unavailable state variables are ignored.</span>
<span class="sd">        is_verbose : bool, default=False</span>
<span class="sd">            If True, enable verbose output.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        stress_comps_order : tuple</span>
<span class="sd">            Stress components order.</span>
<span class="sd">        stress_path : numpy.ndarray(2d)</span>
<span class="sd">            Stress path history stored as numpy.ndarray(2d) of shape</span>
<span class="sd">            (sequence_length, n_stress_comps).</span>
<span class="sd">        state_path : dict</span>
<span class="sd">            Store each requested constitutive model state variable (key, str)</span>
<span class="sd">            path history as numpy.ndarray(2d) of shape</span>
<span class="sd">            (sequence_length, n_features).</span>
<span class="sd">        is_stress_path_fail : bool</span>
<span class="sd">            Stress response path failure flag.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Set stress components order</span>
        <span class="n">stress_comps_order</span> <span class="o">=</span> <span class="n">strain_comps_order</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Get time history length</span>
        <span class="n">n_time</span> <span class="o">=</span> <span class="n">time_hist</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Initialize stress path history</span>
        <span class="n">stress_path</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_time</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">stress_comps_order</span><span class="p">)))</span>
        <span class="c1"># Initialize state path history</span>
        <span class="n">state_path</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">state_var</span><span class="p">,</span> <span class="n">n_features</span> <span class="ow">in</span> <span class="n">state_features</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">state_path</span><span class="p">[</span><span class="n">state_var</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_time</span><span class="p">,</span> <span class="n">n_features</span><span class="p">))</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Initialize constitutive model state variables</span>
        <span class="n">state_variables</span> <span class="o">=</span> <span class="n">constitutive_model</span><span class="o">.</span><span class="n">state_init</span><span class="p">()</span>
        <span class="c1"># Initialize last converged material constitutive state variables</span>
        <span class="n">state_variables_old</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">state_variables</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Initialize stress response failure flag</span>
        <span class="n">is_stress_path_fail</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Loop over discrete time</span>
        <span class="k">for</span> <span class="n">time_idx</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span>
                <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_time</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;  &gt; Computing time steps state update: &#39;</span><span class="p">,</span>
                <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="n">is_verbose</span><span class="p">):</span>    
            <span class="c1"># Get previous and current strain tensors</span>
            <span class="n">strain_tensor_old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_tensor_from_comps</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_n_dim</span><span class="p">,</span> <span class="n">strain_comps_order</span><span class="p">,</span> <span class="n">strain_path</span><span class="p">[</span><span class="n">time_idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:],</span>
                <span class="n">is_symmetric</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span> <span class="o">==</span> <span class="s1">&#39;infinitesimal&#39;</span><span class="p">)</span>
            <span class="n">strain_tensor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_tensor_from_comps</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_n_dim</span><span class="p">,</span> <span class="n">strain_comps_order</span><span class="p">,</span> <span class="n">strain_path</span><span class="p">[</span><span class="n">time_idx</span><span class="p">,</span> <span class="p">:],</span>
                <span class="n">is_symmetric</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span> <span class="o">==</span> <span class="s1">&#39;infinitesimal&#39;</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Compute incremental strain tensor</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span> <span class="o">==</span> <span class="s1">&#39;infinitesimal&#39;</span><span class="p">:</span>
                <span class="c1"># Compute incremental infinitesimal strain tensor</span>
                <span class="n">inc_strain</span> <span class="o">=</span> <span class="n">strain_tensor</span> <span class="o">-</span> <span class="n">strain_tensor_old</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Not implemented.&#39;</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Convert incremental strain tensor to Torch tensor</span>
            <span class="n">inc_strain</span> <span class="o">=</span> \
                <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">inc_strain</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">get_default_dtype</span><span class="p">())</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Material state update</span>
            <span class="n">state_variables</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">material_state_update</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem_type</span><span class="p">,</span>
                <span class="n">constitutive_model</span><span class="p">,</span> <span class="n">inc_strain</span><span class="p">,</span> <span class="n">state_variables_old</span><span class="p">,</span>
                <span class="n">def_gradient_old</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Check material state update convergence</span>
            <span class="k">if</span> <span class="n">state_variables</span><span class="p">[</span><span class="s1">&#39;is_su_fail&#39;</span><span class="p">]:</span>
                <span class="n">is_stress_path_fail</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1"># Stop computation of material response path</span>
            <span class="k">if</span> <span class="n">is_stress_path_fail</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Update last converged material constitutive state variables</span>
            <span class="n">state_variables_old</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">state_variables</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Get stress tensor</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span> <span class="o">==</span> <span class="s1">&#39;infinitesimal&#39;</span><span class="p">:</span>
                <span class="c1"># Get Cauchy stress tensor</span>
                <span class="n">stress</span> <span class="o">=</span> <span class="n">get_tensor_from_mf</span><span class="p">(</span><span class="n">state_variables</span><span class="p">[</span><span class="s1">&#39;stress_mf&#39;</span><span class="p">],</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">_n_dim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comp_order_sym</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Not implemented.&#39;</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Store stress tensor</span>
            <span class="n">stress_path</span><span class="p">[</span><span class="n">time_idx</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">store_tensor_comps</span><span class="p">(</span><span class="n">stress_comps_order</span><span class="p">,</span> <span class="n">stress</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Loop over state variables</span>
            <span class="k">for</span> <span class="n">state_var</span> <span class="ow">in</span> <span class="n">state_features</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="c1"># Skip if state variable is not available</span>
                <span class="k">if</span> <span class="n">state_var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">state_variables</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">state_var</span> <span class="ow">in</span> <span class="n">state_path</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">state_path</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">state_var</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Store state variable</span>
                <span class="k">if</span> <span class="s1">&#39;strain_mf&#39;</span> <span class="ow">in</span> <span class="n">state_var</span><span class="p">:</span>
                    <span class="c1"># Build strain tensor</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span> <span class="o">==</span> <span class="s1">&#39;infinitesimal&#39;</span><span class="p">:</span>
                        <span class="n">strain</span> <span class="o">=</span> <span class="n">get_tensor_from_mf</span><span class="p">(</span>
                            <span class="n">state_variables</span><span class="p">[</span><span class="n">state_var</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_dim</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_comp_order_sym</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Not implemented.&#39;</span><span class="p">)</span>
                    <span class="c1"># Store strain tensor</span>
                    <span class="n">state_path</span><span class="p">[</span><span class="n">state_var</span><span class="p">][</span><span class="n">time_idx</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> \
                        <span class="bp">self</span><span class="o">.</span><span class="n">store_tensor_comps</span><span class="p">(</span><span class="n">strain_comps_order</span><span class="p">,</span> <span class="n">strain</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Store generic state variable</span>
                    <span class="n">state_path</span><span class="p">[</span><span class="n">state_var</span><span class="p">][</span><span class="n">time_idx</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> \
                        <span class="n">state_variables</span><span class="p">[</span><span class="n">state_var</span><span class="p">]</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">return</span> <span class="n">stress_comps_order</span><span class="p">,</span> <span class="n">stress_path</span><span class="p">,</span> <span class="n">state_path</span><span class="p">,</span> <span class="n">is_stress_path_fail</span></div>
    <span class="c1"># -------------------------------------------------------------------------</span>
<div class="viewcode-block" id="MaterialResponseDatasetGenerator.build_tensor_from_comps"><a class="viewcode-back" href="../../../_autosummary/hookeai.miscellaneous.materials.compare_material_models.MaterialResponseDatasetGenerator.html#hookeai.miscellaneous.dataset_processing.read_csv_response_dataset.MaterialResponseDatasetGenerator.build_tensor_from_comps">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">build_tensor_from_comps</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">n_dim</span><span class="p">,</span> <span class="n">comps</span><span class="p">,</span> <span class="n">comps_array</span><span class="p">,</span>
                                <span class="n">is_symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Build strain/stress tensor from given components.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n_dim : int</span>
<span class="sd">            Problem number of spatial dimensions.</span>
<span class="sd">        comps : tuple[str]</span>
<span class="sd">            Strain/Stress components order.</span>
<span class="sd">        comps_array : numpy.ndarray(1d)</span>
<span class="sd">            Strain/Stress components array.</span>
<span class="sd">        is_symmetric : bool, default=False</span>
<span class="sd">            If True, then assembles off-diagonal strain components from</span>
<span class="sd">            symmetric component.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tensor : numpy.ndarray(2d)</span>
<span class="sd">            Strain/Stress tensor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize tensor</span>
        <span class="n">tensor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_dim</span><span class="p">,</span> <span class="n">n_dim</span><span class="p">))</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Loop over components</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">comp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">comps</span><span class="p">):</span>
            <span class="c1"># Get component indexes</span>
            <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">comp</span><span class="p">]</span>
            <span class="c1"># Assemble tensor component</span>
            <span class="n">tensor</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">comps_array</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="c1"># Assemble symmetric tensor component</span>
            <span class="k">if</span> <span class="n">is_symmetric</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                <span class="n">tensor</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">comps_array</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">return</span> <span class="n">tensor</span></div>
    <span class="c1"># -------------------------------------------------------------------------</span>
<div class="viewcode-block" id="MaterialResponseDatasetGenerator.store_tensor_comps"><a class="viewcode-back" href="../../../_autosummary/hookeai.miscellaneous.materials.compare_material_models.MaterialResponseDatasetGenerator.html#hookeai.miscellaneous.dataset_processing.read_csv_response_dataset.MaterialResponseDatasetGenerator.store_tensor_comps">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">store_tensor_comps</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">comps</span><span class="p">,</span> <span class="n">tensor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Store strain/stress tensor components in array.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        comps : tuple[str]</span>
<span class="sd">            Strain/Stress components order.</span>
<span class="sd">        tensor : numpy.ndarray(2d)</span>
<span class="sd">            Strain/Stress tensor.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        comps_array : numpy.ndarray(1d)</span>
<span class="sd">            Strain/Stress components array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize tensor components array</span>
        <span class="n">comps_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">comps</span><span class="p">))</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Loop over components</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">comp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">comps</span><span class="p">):</span>
            <span class="c1"># Get component indexes</span>
            <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">comp</span><span class="p">]</span>
            <span class="c1"># Assemble tensor component</span>
            <span class="n">comps_array</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">return</span> <span class="n">comps_array</span></div>
    <span class="c1"># -------------------------------------------------------------------------</span>
<div class="viewcode-block" id="MaterialResponseDatasetGenerator.gen_response_dataset_from_csv"><a class="viewcode-back" href="../../../_autosummary/hookeai.miscellaneous.materials.compare_material_models.MaterialResponseDatasetGenerator.html#hookeai.miscellaneous.dataset_processing.read_csv_response_dataset.MaterialResponseDatasetGenerator.gen_response_dataset_from_csv">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">gen_response_dataset_from_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response_file_paths</span><span class="p">,</span>
                                      <span class="n">is_in_memory_dataset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">dataset_directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                      <span class="n">is_save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate strain-stress path data set from set of .csv files.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        response_file_paths : tuple</span>
<span class="sd">            Strain-stress response paths data files paths (.csv).</span>
<span class="sd">        is_in_memory_dataset : bool, default=True</span>
<span class="sd">            If True, then generate in-memory time series data set, otherwise</span>
<span class="sd">            time series data set samples are stored in local directory.</span>
<span class="sd">        dataset_directory : str, default=None</span>
<span class="sd">            Directory where the time series data set is stored (all data set</span>
<span class="sd">            samples files). Required if is_in_memory_dataset=False.</span>
<span class="sd">        dataset_basename : str, default=None</span>
<span class="sd">            Data set file base name. Required if is_in_memory_dataset=False.</span>
<span class="sd">        save_dir : str, default=None</span>
<span class="sd">            Directory where figure is saved. If None, then figure is saved in</span>
<span class="sd">            current working directory.</span>
<span class="sd">        is_save_fig : bool, default=False</span>
<span class="sd">            Save figure.</span>
<span class="sd">        is_verbose : bool, default=False</span>
<span class="sd">            If True, enable verbose output.</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dataset : torch.utils.data.Dataset</span>
<span class="sd">            Time series data set. Each sample is stored as a dictionary where</span>
<span class="sd">            each feature (key, str) data is a torch.Tensor(2d) of shape</span>
<span class="sd">            (sequence_length, n_features).</span>
<span class="sd">        &quot;&quot;&quot;</span>   
        <span class="n">start_time_sec</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">is_verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Generate strain-stress material response path data set&#39;</span>
                  <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">------------------------------------------------------&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Check data set parameters requirements</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_in_memory_dataset</span><span class="p">:</span>
            <span class="c1"># Check data set directory</span>
            <span class="k">if</span> <span class="n">dataset_directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Time series data set directory must be &#39;</span>
                                   <span class="s1">&#39;provided when is_in_memory_dataset=False.&#39;</span><span class="p">)</span>
            <span class="c1"># Check data set file base name</span>
            <span class="k">if</span> <span class="n">dataset_basename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Time series data set file base name must &#39;</span>
                                   <span class="s1">&#39;be provided when &#39;</span>
                                   <span class="s1">&#39;is_in_memory_dataset=False.&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Get strain and stress components order</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span> <span class="o">==</span> <span class="s1">&#39;infinitesimal&#39;</span><span class="p">:</span>
            <span class="n">strain_comps_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comp_order_sym</span>
            <span class="n">stress_comps_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comp_order_sym</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Not implemented.&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Sort response path files</span>
        <span class="n">response_file_paths</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
            <span class="nb">sorted</span><span class="p">(</span><span class="n">response_file_paths</span><span class="p">,</span>
                   <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(\d+)\D*$&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set total number of response paths files</span>
        <span class="n">n_path_files</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">response_file_paths</span><span class="p">)</span>
        <span class="c1"># Initialize number of invalid response paths files</span>
        <span class="n">n_path_files_invalid</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ v SECTION TO BE REMOVED</span>
        <span class="c1"># Set volume fraction input flag </span>
        <span class="n">is_input_volume_fraction</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Gather volume fraction data</span>
        <span class="k">if</span> <span class="n">is_input_volume_fraction</span><span class="p">:</span>
            <span class="c1"># Set volume fraction data file path</span>
            <span class="n">vf_data_file_path</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;/home/username/Documents/brown/&#39;</span>
                                 <span class="s1">&#39;projects/darpa_project/2_local_rnn_training/&#39;</span>
                                 <span class="s1">&#39;composite_rve/dataset_07_2024/0_yaga_files/&#39;</span>
                                 <span class="s1">&#39;exp_Ti6Al4V_3D_input.csv&#39;</span><span class="p">)</span>
            <span class="c1"># Load volume fraction data</span>
            <span class="n">df_vf</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">vf_data_file_path</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="c1"># Get volume fraction data</span>
            <span class="n">volume_fractions_data</span> <span class="o">=</span> <span class="n">df_vf</span><span class="o">.</span><span class="n">values</span>
            <span class="c1"># Initialize valid response paths volume fractions</span>
            <span class="n">vf_path_valid</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ^ SECTION TO BE REMOVED</span>
        <span class="c1"># Initialize time series data set samples</span>
        <span class="k">if</span> <span class="n">is_in_memory_dataset</span><span class="p">:</span>
            <span class="n">dataset_samples</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dataset_sample_files</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">if</span> <span class="n">is_verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&gt; Starting strain-stress paths reading process...</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Loop over samples</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data_file_path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span>
                <span class="n">response_file_paths</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;&gt; Reading strain-stress paths: &#39;</span><span class="p">,</span>
                <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="n">is_verbose</span><span class="p">)):</span>
            <span class="c1"># Load data</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_file_path</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Check data</span>
            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">13</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Expecting data frame to have 13 columns, &#39;</span>
                                   <span class="sa">f</span><span class="s1">&#39;but </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1"> were found. </span><span class="se">\n\n</span><span class="s1">&#39;</span>
                                   <span class="sa">f</span><span class="s1">&#39;Expected columns: TIME | E11 E22 E33 E12 &#39;</span>
                                   <span class="sa">f</span><span class="s1">&#39;E23 E13 | S11 S22 S33 S12 S23 S13&#39;</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Get response path data</span>
            <span class="n">response_path_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span>
            <span class="c1"># Get discrete time history</span>
            <span class="n">time_hist</span> <span class="o">=</span> <span class="n">response_path_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="c1"># Get strain and stress paths</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">strain_path</span> <span class="o">=</span> <span class="n">response_path_data</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
                <span class="n">stress_path</span> <span class="o">=</span> <span class="n">response_path_data</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">strain_path</span> <span class="o">=</span> <span class="n">response_path_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>
                <span class="n">stress_path</span> <span class="o">=</span> <span class="n">response_path_data</span><span class="p">[:,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">13</span><span class="p">]</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Initialize material response path data</span>
            <span class="n">response_path</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1"># Assemble strain-stress material response path</span>
            <span class="n">response_path</span><span class="p">[</span><span class="s1">&#39;strain_comps_order&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strain_comps_order</span>
            <span class="n">response_path</span><span class="p">[</span><span class="s1">&#39;strain_path&#39;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">strain_path</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">get_default_dtype</span><span class="p">())</span>
            <span class="n">response_path</span><span class="p">[</span><span class="s1">&#39;stress_comps_order&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stress_comps_order</span>
            <span class="n">response_path</span><span class="p">[</span><span class="s1">&#39;stress_path&#39;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">stress_path</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">get_default_dtype</span><span class="p">())</span>
            <span class="c1"># Assemble time path</span>
            <span class="n">response_path</span><span class="p">[</span><span class="s1">&#39;time_hist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
                <span class="n">time_hist</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">get_default_dtype</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ v SECTION TO BE REMOVED</span>
            <span class="c1"># Get volume fraction path</span>
            <span class="k">if</span> <span class="n">is_input_volume_fraction</span><span class="p">:</span>
                <span class="c1"># Get response path volume fraction</span>
                <span class="n">vf</span> <span class="o">=</span> <span class="n">volume_fractions_data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                <span class="c1"># Set volume fraction path</span>
                <span class="n">vf_path</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span>
                    <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">vf</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">get_default_dtype</span><span class="p">()),</span>
                    <span class="p">(</span><span class="n">time_hist</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
                <span class="c1"># Assemble volume fraction path</span>
                <span class="n">response_path</span><span class="p">[</span><span class="s1">&#39;vf_path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vf_path</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ^ SECTION TO BE REMOVED</span>
            <span class="c1"># Initialize response path invalid flag</span>
            <span class="n">is_invalid_path</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="c1"># Evaluate strain-stress material response path</span>
            <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">response_path</span><span class="p">[</span><span class="s1">&#39;stress_path&#39;</span><span class="p">],</span>
                              <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">response_path</span><span class="p">[</span><span class="s1">&#39;stress_path&#39;</span><span class="p">])):</span>
                <span class="n">n_path_files_invalid</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">is_invalid_path</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Store or discard strain-stress material response path</span>
            <span class="k">if</span> <span class="n">is_invalid_path</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">is_in_memory_dataset</span><span class="p">:</span>
                    <span class="c1"># Store material response path (in memory)</span>
                    <span class="n">dataset_samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">response_path</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Set material response path file path</span>
                    <span class="n">sample_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dataset_directory</span><span class="p">,</span>
                                                    <span class="sa">f</span><span class="s1">&#39;ss_response_path_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">.pt&#39;</span><span class="p">)</span>
                    <span class="c1"># Store material response path (local directory)</span>
                    <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">response_path</span><span class="p">,</span> <span class="n">sample_file_path</span><span class="p">)</span>
                    <span class="c1"># Append material response path file path</span>
                    <span class="n">dataset_sample_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sample_file_path</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ v SECTION TO BE REMOVED</span>
            <span class="c1"># Store valid response path volume fraction</span>
            <span class="k">if</span> <span class="n">is_input_volume_fraction</span><span class="p">:</span>
                <span class="n">vf_path_valid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vf</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ^ SECTION TO BE REMOVED</span>
            <span class="c1"># Plot material response path</span>
            <span class="k">if</span> <span class="n">is_save_fig</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">save_dir</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_material_response_path</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_dim</span><span class="p">,</span>
                    <span class="n">strain_comps_order</span><span class="p">,</span> <span class="n">strain_path</span><span class="p">,</span>
                    <span class="n">stress_comps_order</span><span class="p">,</span> <span class="n">stress_path</span><span class="p">,</span>
                    <span class="n">time_hist</span><span class="p">,</span>
                    <span class="n">is_plot_strain_stress_paths</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">is_plot_eq_strain_stress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;response_path_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                    <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">,</span> <span class="n">is_save_fig</span><span class="o">=</span><span class="n">is_save_fig</span><span class="p">,</span>
                    <span class="n">is_stdout_display</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">if</span> <span class="n">is_verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&gt; Finished strain-stress paths reading process!</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Compute valid response file paths</span>
        <span class="n">n_path_files_valid</span> <span class="o">=</span> <span class="n">n_path_files</span> <span class="o">-</span> <span class="n">n_path_files_invalid</span>
        <span class="c1"># Compute ratio of valid and invalid response file paths</span>
        <span class="n">ratio_valid</span> <span class="o">=</span> <span class="n">n_path_files_valid</span><span class="o">/</span><span class="n">n_path_files</span>
        <span class="n">ratio_invalid</span> <span class="o">=</span> <span class="n">n_path_files_invalid</span><span class="o">/</span><span class="n">n_path_files</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">if</span> <span class="n">is_verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&gt; Number of response path files: </span><span class="si">{</span><span class="n">n_path_files</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">  &gt; Number of valid response path files: &#39;</span>
                  <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">n_path_files_valid</span><span class="si">:</span><span class="s1">d</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">n_path_files</span><span class="si">:</span><span class="s1">d</span><span class="si">}</span><span class="s1"> &#39;</span>
                  <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">ratio_valid</span><span class="si">:</span><span class="s1">&gt;.1f</span><span class="si">}</span><span class="s1">%)&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">  &gt; Number of invalid response path files: &#39;</span>
                  <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">n_path_files_invalid</span><span class="si">:</span><span class="s1">d</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">n_path_files</span><span class="si">:</span><span class="s1">d</span><span class="si">}</span><span class="s1"> &#39;</span>
                  <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">ratio_invalid</span><span class="si">:</span><span class="s1">&gt;.1f</span><span class="si">}</span><span class="s1">%)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Create strain-stress material response path data set</span>
        <span class="k">if</span> <span class="n">is_in_memory_dataset</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="n">TimeSeriesDatasetInMemory</span><span class="p">(</span><span class="n">dataset_samples</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="n">TimeSeriesDataset</span><span class="p">(</span><span class="n">dataset_directory</span><span class="p">,</span>
                                        <span class="n">dataset_sample_files</span><span class="p">,</span>
                                        <span class="n">dataset_basename</span><span class="o">=</span><span class="n">dataset_basename</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Get number of strain-stress paths</span>
        <span class="n">n_path</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Compute total generation time and average generation time per path</span>
        <span class="n">total_time_sec</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time_sec</span>
        <span class="n">avg_time_sec</span> <span class="o">=</span> <span class="n">total_time_sec</span><span class="o">/</span><span class="n">n_path</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">if</span> <span class="n">is_verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&gt; Total generation time: &#39;</span>
                  <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">total_time_sec</span><span class="p">)))</span><span class="si">}</span><span class="s1"> | &#39;</span>
                  <span class="sa">f</span><span class="s1">&#39;Avg. processing time per path: &#39;</span>
                  <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">avg_time_sec</span><span class="p">)))</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ v SECTION TO BE REMOVED      </span>
        <span class="c1"># Plot valid response paths volume fraction</span>
        <span class="k">if</span> <span class="n">is_input_volume_fraction</span><span class="p">:</span>
            <span class="c1"># Plot valid response paths volume fraction</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> \
                <span class="n">plot_histogram</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vf_path_valid</span><span class="p">),),</span>
                                <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">x_lims</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                                <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;Volume fraction&#39;</span><span class="p">,</span>
                                <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;Number of valid response paths&#39;</span><span class="p">,</span>
                                <span class="n">is_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># Save figure</span>
            <span class="n">save_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;ss_paths_valid_vf_hist_</span><span class="si">{</span><span class="n">n_path_files_valid</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                        <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">)</span>        
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ^ SECTION TO BE REMOVED</span>
        <span class="k">return</span> <span class="n">dataset</span></div>
    <span class="c1"># -------------------------------------------------------------------------</span>
<div class="viewcode-block" id="MaterialResponseDatasetGenerator.gen_response_dataset_from_strain_dataset"><a class="viewcode-back" href="../../../_autosummary/hookeai.miscellaneous.materials.compare_material_models.MaterialResponseDatasetGenerator.html#hookeai.miscellaneous.dataset_processing.read_csv_response_dataset.MaterialResponseDatasetGenerator.gen_response_dataset_from_strain_dataset">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">gen_response_dataset_from_strain_dataset</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">dataset_path</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model_parameters</span><span class="p">,</span>
            <span class="n">state_features</span><span class="o">=</span><span class="p">{},</span> <span class="n">is_verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate material response data set from strain data set.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset_file_path : str</span>
<span class="sd">            Data set file path.</span>
<span class="sd">        model_name : str</span>
<span class="sd">            FETorch material constitutive model name.</span>
<span class="sd">        model_parameters : dict</span>
<span class="sd">            FETorch material constitutive model parameters.</span>
<span class="sd">        state_features : dict, default={}</span>
<span class="sd">            FETorch material constitutive model state variables (key, str) and</span>
<span class="sd">            corresponding dimensionality (item, int) for which the path history</span>
<span class="sd">            is additionally included in the data set. Tensorial state variables</span>
<span class="sd">            stored in matricial form are included in the data set without any</span>
<span class="sd">            matricial form coefficients (true components are extracted).</span>
<span class="sd">            Unavailable state variables are ignored.</span>
<span class="sd">        is_verbose : bool, default=False</span>
<span class="sd">            If True, enable verbose output.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dataset : torch.utils.data.Dataset</span>
<span class="sd">            Time series data set. Each sample is stored as a dictionary where</span>
<span class="sd">            each feature (key, str) data is a torch.Tensor(2d) of shape</span>
<span class="sd">            (sequence_length, n_features).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start_time_sec</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">is_verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Generate material response data set from strain data set&#39;</span>
                  <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--------------------------------------------------------&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Check data set file path</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">dataset_path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Data set file </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">dataset_path</span><span class="si">}</span><span class="se">\&#39;</span><span class="s1"> has not &#39;</span>
                               <span class="sa">f</span><span class="s1">&#39;been found.&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Load strain data set</span>
        <span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="n">dataset_path</span><span class="p">)</span>
        <span class="c1"># Get number of strain paths</span>
        <span class="n">n_path</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Initialize constitutive model</span>
        <span class="k">if</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;elastic&#39;</span><span class="p">:</span>
            <span class="n">constitutive_model</span> <span class="o">=</span> <span class="n">Elastic</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem_type</span><span class="p">,</span> <span class="n">model_parameters</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;von_mises&#39;</span><span class="p">:</span>
            <span class="n">constitutive_model</span> <span class="o">=</span> <span class="n">VonMises</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem_type</span><span class="p">,</span> <span class="n">model_parameters</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;drucker_prager&#39;</span><span class="p">:</span>
            <span class="n">constitutive_model</span> <span class="o">=</span> <span class="n">DruckerPrager</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem_type</span><span class="p">,</span> <span class="n">model_parameters</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;lou_zhang_yoon&#39;</span><span class="p">:</span>
            <span class="n">constitutive_model</span> <span class="o">=</span> <span class="n">LouZhangYoon</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_strain_formulation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem_type</span><span class="p">,</span> <span class="n">model_parameters</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unknown material constitutive model &#39;</span>
                               <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="se">\&#39;</span><span class="s1">.&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Initialize time series data set samples</span>
        <span class="n">dataset_samples</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">if</span> <span class="n">is_verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&gt; Starting stress paths computation process...</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Loop over samples</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_path</span><span class="p">),</span>
                           <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;&gt; Computing stress paths: &#39;</span><span class="p">,</span>
                           <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="n">is_verbose</span><span class="p">):</span>
            <span class="c1"># Get strain path sample</span>
            <span class="n">sample</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="c1"># Get strain components order</span>
            <span class="n">strain_comps_order</span> <span class="o">=</span> <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;strain_comps_order&#39;</span><span class="p">]</span>
            <span class="c1"># Get strain path</span>
            <span class="n">strain_path</span> <span class="o">=</span> <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;strain_path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
            <span class="c1"># Get discrete time history</span>
            <span class="n">time_hist</span> <span class="o">=</span> <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;time_hist&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>                
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Compute material response</span>
            <span class="n">stress_comps_order</span><span class="p">,</span> <span class="n">stress_path</span><span class="p">,</span> <span class="n">state_path</span><span class="p">,</span> \
                <span class="n">is_stress_path_fail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_stress_path</span><span class="p">(</span>
                    <span class="n">strain_comps_order</span><span class="p">,</span> <span class="n">time_hist</span><span class="p">,</span> <span class="n">strain_path</span><span class="p">,</span>
                    <span class="n">constitutive_model</span><span class="p">,</span> <span class="n">state_features</span><span class="o">=</span><span class="n">state_features</span><span class="p">,</span>
                    <span class="n">is_verbose</span><span class="o">=</span><span class="n">is_verbose</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Check material response stress computation failure</span>
            <span class="k">if</span> <span class="n">is_stress_path_fail</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Stress path computation failed &#39;</span>
                                   <span class="sa">f</span><span class="s1">&#39;for sample </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">. Handling of state update &#39;</span>
                                   <span class="sa">f</span><span class="s1">&#39;failure is not implemented in this &#39;</span>
                                   <span class="sa">f</span><span class="s1">&#39;context.&#39;</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Initialize material response path data</span>
            <span class="n">response_path</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1"># Assemble strain-stress material response path</span>
            <span class="n">response_path</span><span class="p">[</span><span class="s1">&#39;strain_comps_order&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strain_comps_order</span>
            <span class="n">response_path</span><span class="p">[</span><span class="s1">&#39;strain_path&#39;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">strain_path</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">get_default_dtype</span><span class="p">())</span>
            <span class="n">response_path</span><span class="p">[</span><span class="s1">&#39;stress_comps_order&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stress_comps_order</span>
            <span class="n">response_path</span><span class="p">[</span><span class="s1">&#39;stress_path&#39;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">stress_path</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">get_default_dtype</span><span class="p">())</span>
            <span class="c1"># Assemble time path</span>
            <span class="n">response_path</span><span class="p">[</span><span class="s1">&#39;time_hist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
                <span class="n">time_hist</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">get_default_dtype</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c1"># Assemble state variables path</span>
            <span class="k">for</span> <span class="n">state_var</span> <span class="ow">in</span> <span class="n">state_path</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">response_path</span><span class="p">[</span><span class="n">state_var</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
                    <span class="n">state_path</span><span class="p">[</span><span class="n">state_var</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">get_default_dtype</span><span class="p">())</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Store material response path (in memory)</span>
            <span class="n">dataset_samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">response_path</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">if</span> <span class="n">is_verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&gt; Finished stress paths computation process!</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Create strain-stress material response path data set</span>
        <span class="n">dataset</span> <span class="o">=</span> <span class="n">TimeSeriesDatasetInMemory</span><span class="p">(</span><span class="n">dataset_samples</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Compute total generation time and average generation time per path</span>
        <span class="n">total_time_sec</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time_sec</span>
        <span class="n">avg_time_sec</span> <span class="o">=</span> <span class="n">total_time_sec</span><span class="o">/</span><span class="n">n_path</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">if</span> <span class="n">is_verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&gt; Total computation time: &#39;</span>
                  <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">total_time_sec</span><span class="p">)))</span><span class="si">}</span><span class="s1"> | &#39;</span>
                  <span class="sa">f</span><span class="s1">&#39;Avg. computation time per path: &#39;</span>
                  <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">avg_time_sec</span><span class="p">)))</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">return</span> <span class="n">dataset</span></div>
    <span class="c1"># -------------------------------------------------------------------------</span>
<div class="viewcode-block" id="MaterialResponseDatasetGenerator.plot_material_response_path"><a class="viewcode-back" href="../../../_autosummary/hookeai.miscellaneous.materials.compare_material_models.MaterialResponseDatasetGenerator.html#hookeai.miscellaneous.dataset_processing.read_csv_response_dataset.MaterialResponseDatasetGenerator.plot_material_response_path">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_material_response_path</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">strain_formulation</span><span class="p">,</span> <span class="n">n_dim</span><span class="p">,</span>
                                    <span class="n">strain_comps_order</span><span class="p">,</span> <span class="n">strain_path</span><span class="p">,</span>
                                    <span class="n">stress_comps_order</span><span class="p">,</span> <span class="n">stress_path</span><span class="p">,</span>
                                    <span class="n">time_hist</span><span class="p">,</span>
                                    <span class="n">is_plot_strain_stress_paths</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">is_plot_eq_strain_stress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">stress_units</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                                    <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;response_path&#39;</span><span class="p">,</span>
                                    <span class="n">save_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">is_stdout_display</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_latex</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot strain-stress material response path.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        strain_formulation: {&#39;infinitesimal&#39;, &#39;finite&#39;}</span>
<span class="sd">            Problem strain formulation.</span>
<span class="sd">        n_dim : int</span>
<span class="sd">            Problem number of spatial dimensions.</span>
<span class="sd">        strain_comps_order : tuple[str]</span>
<span class="sd">            Strain components order.</span>
<span class="sd">        strain_path : numpy.ndarray(2d)</span>
<span class="sd">            Strain path history stored as numpy.ndarray(2d) of shape</span>
<span class="sd">            (sequence_length, n_strain_comps).</span>
<span class="sd">        stress_comps_order : tuple</span>
<span class="sd">            Stress components order.</span>
<span class="sd">        stress_path : numpy.ndarray(2d)</span>
<span class="sd">            Stress path history stored as numpy.ndarray(2d) of shape</span>
<span class="sd">            (sequence_length, n_stress_comps).</span>
<span class="sd">        time_hist : numpy.ndarray(1d)</span>
<span class="sd">            Discrete time history.</span>
<span class="sd">        is_plot_strain_stress_paths : bool, default=False</span>
<span class="sd">            Plot strain and stress components path (only available for single</span>
<span class="sd">            path).</span>
<span class="sd">        is_plot_eq_strain_stress : bool, default=False</span>
<span class="sd">            Plot equivalent strain-stress path.</span>
<span class="sd">        stress_units : str, default=&#39;&#39;</span>
<span class="sd">            Stress units label.</span>
<span class="sd">        filename : str, default=&#39;response_path&#39;</span>
<span class="sd">            Figure name.</span>
<span class="sd">        save_dir : str, default=None</span>
<span class="sd">            Directory where figure is saved. If None, then figure is saved in</span>
<span class="sd">            current working directory.</span>
<span class="sd">        is_save_fig : bool, default=False</span>
<span class="sd">            Save figure.</span>
<span class="sd">        is_stdout_display : bool, default=False</span>
<span class="sd">            True if displaying figure to standard output device, False</span>
<span class="sd">            otherwise.</span>
<span class="sd">        is_latex : bool, default=False</span>
<span class="sd">            If True, then render all strings in LaTeX. If LaTex is not</span>
<span class="sd">            available, then this option is silently set to False and all input</span>
<span class="sd">            strings are processed to remove $(...)$ enclosure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check strain-stress paths data</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_hist</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="c1"># Get number of strain-stress paths</span>
            <span class="n">n_path</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">)</span>
            <span class="c1"># Get longest path</span>
            <span class="n">n_time_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">time_hist</span><span class="p">])</span>
            <span class="c1"># Get minimum and maximum discrete times</span>
            <span class="n">time_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">time_hist</span><span class="p">])</span>
            <span class="n">time_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">time_hist</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Set number of strain-stress paths</span>
            <span class="n">n_path</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="c1"># Set longest strain-stress path</span>
            <span class="n">n_time_max</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">)</span>
            <span class="c1"># Set minimum and maximum discrete times</span>
            <span class="n">time_min</span> <span class="o">=</span> <span class="n">time_hist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">time_max</span> <span class="o">=</span> <span class="n">time_hist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1"># Store discrete time history and strain-stress path in list</span>
            <span class="n">time_hist</span> <span class="o">=</span> <span class="p">[</span><span class="n">time_hist</span><span class="p">,]</span>
            <span class="n">strain_path</span> <span class="o">=</span> <span class="p">[</span><span class="n">strain_path</span><span class="p">,]</span>
            <span class="n">stress_path</span> <span class="o">=</span> <span class="p">[</span><span class="n">stress_path</span><span class="p">,]</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Store file basename</span>
        <span class="n">basename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Plot strain-stress path</span>
        <span class="k">if</span> <span class="n">is_plot_strain_stress_paths</span> <span class="ow">and</span> <span class="n">n_path</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Loop over path types</span>
            <span class="k">for</span> <span class="n">path_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;strain&#39;</span><span class="p">,</span> <span class="s1">&#39;stress&#39;</span><span class="p">):</span>
                <span class="c1"># Set path specific parameters</span>
                <span class="k">if</span> <span class="n">path_type</span> <span class="o">==</span> <span class="s1">&#39;strain&#39;</span><span class="p">:</span>
                    <span class="c1"># Set components</span>
                    <span class="n">comps</span> <span class="o">=</span> <span class="n">strain_comps_order</span>
                    <span class="c1"># Set component label</span>
                    <span class="n">comp_label</span> <span class="o">=</span> <span class="s1">&#39;Strain&#39;</span>
                    <span class="c1"># Set y-axis label</span>
                    <span class="n">y_label</span> <span class="o">=</span> <span class="s1">&#39;Strain&#39;</span>
                    <span class="c1"># Set path</span>
                    <span class="n">path</span> <span class="o">=</span> <span class="n">strain_path</span>
                    <span class="c1"># Set filename</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">basename</span> <span class="o">+</span> <span class="s1">&#39;_strain&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Set components</span>
                    <span class="n">comps</span> <span class="o">=</span> <span class="n">stress_comps_order</span>
                    <span class="c1"># Set component label</span>
                    <span class="n">comp_label</span> <span class="o">=</span> <span class="s1">&#39;Stress&#39;</span>
                    <span class="c1"># Set y-axis label</span>
                    <span class="n">y_label</span> <span class="o">=</span> <span class="s1">&#39;Stress&#39;</span> <span class="o">+</span> <span class="n">stress_units</span>
                    <span class="c1"># Set path</span>
                    <span class="n">path</span> <span class="o">=</span> <span class="n">stress_path</span>
                    <span class="c1"># Set filename</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">basename</span> <span class="o">+</span> <span class="s1">&#39;_stress&#39;</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Initialize data array</span>
                <span class="n">data_xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_time_max</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">comps</span><span class="p">)))</span>
                <span class="c1"># Set data array</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">comps</span><span class="p">)):</span>
                    <span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_hist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="n">j</span><span class="p">]</span>
                <span class="c1"># Set data labels</span>
                <span class="n">data_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">comp_label</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">comps</span><span class="p">]</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Plot path</span>
                <span class="n">figure</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_xy_data</span><span class="p">(</span><span class="n">data_xy</span><span class="p">,</span> <span class="n">data_labels</span><span class="o">=</span><span class="n">data_labels</span><span class="p">,</span>
                                         <span class="n">x_lims</span><span class="o">=</span><span class="p">(</span><span class="n">time_min</span><span class="p">,</span> <span class="n">time_max</span><span class="p">),</span>
                                         <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span>
                                         <span class="n">is_latex</span><span class="o">=</span><span class="n">is_latex</span><span class="p">)</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Save figure</span>
                <span class="k">if</span> <span class="n">is_save_fig</span><span class="p">:</span>
                    <span class="n">save_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span>
                                <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Initialize equivalent strain and stress paths</span>
        <span class="n">eq_strain_paths</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">eq_stress_paths</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Loop over strain-stress paths</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_path</span><span class="p">):</span>
            <span class="c1"># Initialize equivalent strain and stress path</span>
            <span class="n">eq_strain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_time_max</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">eq_stress</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_time_max</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="c1"># Loop over discrete time</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">[</span><span class="n">k</span><span class="p">])):</span>
                <span class="c1"># Get strain tensor</span>
                <span class="n">strain</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">build_tensor_from_comps</span><span class="p">(</span>
                    <span class="n">n_dim</span><span class="p">,</span> <span class="n">strain_comps_order</span><span class="p">,</span> <span class="n">strain_path</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span>
                    <span class="n">is_symmetric</span><span class="o">=</span><span class="n">strain_formulation</span> <span class="o">==</span> <span class="s1">&#39;infinitesimal&#39;</span><span class="p">)</span>
                <span class="c1"># Get stress tensor</span>
                <span class="n">stress</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">build_tensor_from_comps</span><span class="p">(</span>
                    <span class="n">n_dim</span><span class="p">,</span> <span class="n">stress_comps_order</span><span class="p">,</span> <span class="n">stress_path</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span>
                    <span class="n">is_symmetric</span><span class="o">=</span><span class="n">strain_formulation</span> <span class="o">==</span> <span class="s1">&#39;infinitesimal&#39;</span><span class="p">)</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Compute equivalent strain and stress</span>
                <span class="k">if</span> <span class="n">strain_formulation</span> <span class="o">==</span> <span class="s1">&#39;infinitesimal&#39;</span><span class="p">:</span>
                    <span class="n">eq_strain</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
                        <span class="n">strain</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">strain</span><span class="p">))</span>
                    <span class="n">eq_stress</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
                        <span class="n">stress</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">stress</span><span class="p">))</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Store equivalent strain and stress path</span>
            <span class="n">eq_strain_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eq_strain</span><span class="p">)</span>
            <span class="n">eq_stress_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eq_stress</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Plot equivalent strain-stress path</span>
        <span class="k">if</span> <span class="n">n_dim</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">is_plot_eq_strain_stress</span><span class="p">:</span>
            <span class="c1"># Build equivalent strain-stress paths data array</span>
            <span class="n">eq_strain_stress_data_xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">eq_strain_paths</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">eq_stress_paths</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span>
                                <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_path</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Plot equivalent strain-stress path</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_xy_data</span><span class="p">(</span>
                <span class="n">data_xy</span><span class="o">=</span><span class="n">eq_strain_stress_data_xy</span><span class="p">,</span>
                <span class="n">x_lims</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="n">y_lims</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;Equivalent strain&#39;</span><span class="p">,</span>
                <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;Equivalent stress&#39;</span> <span class="o">+</span> <span class="n">stress_units</span><span class="p">,</span>
                <span class="n">is_latex</span><span class="o">=</span><span class="n">is_latex</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Save figure</span>
            <span class="k">if</span> <span class="n">is_save_fig</span><span class="p">:</span>
                <span class="n">save_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">basename</span> <span class="o">+</span> <span class="s1">&#39;_eq_strain_stress&#39;</span><span class="p">,</span>
                            <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Display figure</span>
        <span class="k">if</span> <span class="n">is_stdout_display</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Close plot</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span></div>
    <span class="c1"># -------------------------------------------------------------------------</span>
<div class="viewcode-block" id="MaterialResponseDatasetGenerator.plot_stress_space_metrics"><a class="viewcode-back" href="../../../_autosummary/hookeai.miscellaneous.materials.compare_material_models.MaterialResponseDatasetGenerator.html#hookeai.miscellaneous.dataset_processing.read_csv_response_dataset.MaterialResponseDatasetGenerator.plot_stress_space_metrics">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_stress_space_metrics</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">strain_formulation</span><span class="p">,</span> <span class="n">stress_comps_order</span><span class="p">,</span>
                                  <span class="n">stress_path</span><span class="p">,</span> <span class="n">time_hist</span><span class="p">,</span>
                                  <span class="n">is_plot_principal_stress_path</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                  <span class="n">is_plot_pi_stress_path_pairs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                  <span class="n">is_plot_stress_invar_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                  <span class="n">is_plot_stress_invar_box</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                  <span class="n">is_plot_stress_path_triax_lode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                  <span class="n">is_plot_stress_triax_lode_space</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                  <span class="n">is_plot_stress_triax_lode_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                  <span class="n">is_plot_stress_triax_lode_box</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                  <span class="n">stress_units</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                                  <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;stress_path&#39;</span><span class="p">,</span>
                                  <span class="n">save_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                  <span class="n">is_stdout_display</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_latex</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot strain-stress material response path in principal stress space.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        strain_formulation: {&#39;infinitesimal&#39;, &#39;finite&#39;}</span>
<span class="sd">            Problem strain formulation.</span>
<span class="sd">        n_dim : int</span>
<span class="sd">            Problem number of spatial dimensions.</span>
<span class="sd">        stress_comps_order : tuple</span>
<span class="sd">            Stress components order.</span>
<span class="sd">        stress_path : {numpy.ndarray(2d), list[numpy.ndarray(2d)]}</span>
<span class="sd">            Stress path history stored as numpy.ndarray(2d) of shape</span>
<span class="sd">            (sequence_length, n_stress_comps) or list of multiple stress path</span>
<span class="sd">            histories.</span>
<span class="sd">        time_hist : {numpy.ndarray(1d), list[numpy.ndarray(1d)]}</span>
<span class="sd">            Discrete time history or list of multiple discrete time histories.</span>
<span class="sd">        is_plot_principal_stress_path : bool, default=False</span>
<span class="sd">            Plot stress path in the principal stress space.</span>
<span class="sd">        is_plot_pi_stress_path_pairs : bool, default=False</span>
<span class="sd">            Plot the stress path for pairs of pi-stress components in the</span>
<span class="sd">            principal stress space.</span>
<span class="sd">        is_plot_stress_invar_hist : bool, default=False</span>
<span class="sd">            Plot distribution of stress invariants.</span>
<span class="sd">        is_plot_stress_invar_box : bool, default=False</span>
<span class="sd">            Plot box plot with stress invariants.</span>
<span class="sd">        is_plot_stress_path_triax_lode : bool, default=False</span>
<span class="sd">            Plot stress triaxiality and Lode parameter paths.</span>
<span class="sd">        is_plot_stress_triax_lode_space : bool, default=False</span>
<span class="sd">            Plot stress triaxiality and Lode parameter space.</span>
<span class="sd">        is_plot_stress_triax_lode_hist : bool, default=False</span>
<span class="sd">            Plot stress triaxiality and Lode parameter distributions.</span>
<span class="sd">        is_plot_stress_triax_lode_box : bool, default=False</span>
<span class="sd">            Plot box plot with stress triaxiality and Lodeb parameter.</span>
<span class="sd">        stress_units : str, default=&#39;&#39;</span>
<span class="sd">            Stress units label.</span>
<span class="sd">        filename : str, default=&#39;stress_path&#39;</span>
<span class="sd">            Figure name.</span>
<span class="sd">        save_dir : str, default=None</span>
<span class="sd">            Directory where figure is saved. If None, then figure is saved in</span>
<span class="sd">            current working directory.</span>
<span class="sd">        is_save_fig : bool, default=False</span>
<span class="sd">            Save figure.</span>
<span class="sd">        is_stdout_display : bool, default=False</span>
<span class="sd">            True if displaying figure to standard output device, False</span>
<span class="sd">            otherwise.</span>
<span class="sd">        is_latex : bool, default=False</span>
<span class="sd">            If True, then render all strings in LaTeX. If LaTex is not</span>
<span class="sd">            available, then this option is silently set to False and all input</span>
<span class="sd">            strings are processed to remove $(...)$ enclosure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Set number of spatial dimensions</span>
        <span class="n">n_dim</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Check dimensionality</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stress_comps_order</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Strain-stress material response plots in the &#39;</span>
                               <span class="s1">&#39;principal stress space are only available if &#39;</span>
                               <span class="s1">&#39;the complete 3D stress path is provided.&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Check stress paths data</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_hist</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stress_path</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="c1"># Check multiple strain paths</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_hist</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stress_path</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Inconsistent discrete time histories and &#39;</span>
                                   <span class="s1">&#39;stress path histories when providing &#39;</span>
                                   <span class="s1">&#39;multiple stress paths.&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">stress_path</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Inconsistent discrete time histories and &#39;</span>
                                   <span class="s1">&#39;stress path histories when providing &#39;</span>
                                   <span class="s1">&#39;multiple stress paths.&#39;</span><span class="p">)</span>
            <span class="c1"># Get number of strain paths</span>
            <span class="n">n_path</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">stress_path</span><span class="p">)</span>
            <span class="c1"># Get longest strain path</span>
            <span class="n">n_time_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">time_hist</span><span class="p">])</span>
            <span class="c1"># Get minimum and maximum discrete times</span>
            <span class="n">time_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">time_hist</span><span class="p">])</span>
            <span class="n">time_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">time_hist</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Set number of strain paths</span>
            <span class="n">n_path</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="c1"># Set longest strain path</span>
            <span class="n">n_time_max</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">)</span>
            <span class="c1"># Set minimum and maximum discrete times</span>
            <span class="n">time_min</span> <span class="o">=</span> <span class="n">time_hist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">time_max</span> <span class="o">=</span> <span class="n">time_hist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1"># Store discrete time history and stress path in list</span>
            <span class="n">time_hist</span> <span class="o">=</span> <span class="p">[</span><span class="n">time_hist</span><span class="p">,]</span>
            <span class="n">stress_path</span> <span class="o">=</span> <span class="p">[</span><span class="n">stress_path</span><span class="p">,]</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Initialize principal stresses</span>
        <span class="n">stress_paths_principal</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Compute stress invariants</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_path</span><span class="p">):</span>
            <span class="c1"># Initialize principal stresses</span>
            <span class="n">stress_eigen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_time_max</span><span class="p">,</span> <span class="n">n_dim</span><span class="p">))</span>
            <span class="c1"># Loop over discrete time</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">[</span><span class="n">k</span><span class="p">])):</span>
                <span class="c1"># Get stress tensor</span>
                <span class="n">stress</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">build_tensor_from_comps</span><span class="p">(</span>
                    <span class="n">n_dim</span><span class="p">,</span> <span class="n">stress_comps_order</span><span class="p">,</span> <span class="n">stress_path</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span>
                    <span class="n">is_symmetric</span><span class="o">=</span><span class="n">strain_formulation</span> <span class="o">==</span> <span class="s1">&#39;infinitesimal&#39;</span><span class="p">)</span>
                <span class="c1"># Compute principal stresses</span>
                <span class="n">eigenvalues</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">stress</span><span class="p">)</span>
                <span class="c1"># Store principal stresses</span>
                <span class="n">is_sort_principal</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">is_sort_principal</span><span class="p">:</span>
                    <span class="c1"># Sort principal stresses in descending order</span>
                    <span class="n">stress_eigen</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Keep principal stresses order stemming from eigenvalues</span>
                    <span class="c1"># computation algorithm</span>
                    <span class="n">stress_eigen</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">eigenvalues</span>
            <span class="c1"># Store stress path principal stresses</span>
            <span class="n">stress_paths_principal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stress_eigen</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Plot stress path in principal stress space</span>
        <span class="k">if</span> <span class="n">is_plot_principal_stress_path</span><span class="p">:</span>
            <span class="c1"># Initialize stress data array</span>
            <span class="n">stress_data_xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">n_time_max</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">n_path</span><span class="p">),</span>
                                      <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="c1"># Loop over stress paths</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_path</span><span class="p">):</span>
                <span class="c1"># Set stress data array</span>
                <span class="n">stress_data_xyz</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="n">stress_paths_principal</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="c1"># Plot stress path in principal stress space</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_xyz_data</span><span class="p">(</span>
                <span class="n">data_xyz</span><span class="o">=</span><span class="n">stress_data_xyz</span><span class="p">,</span>
                <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;Stress 1&#39;</span> <span class="o">+</span> <span class="n">stress_units</span><span class="p">,</span>
                <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;Stress 2&#39;</span> <span class="o">+</span> <span class="n">stress_units</span><span class="p">,</span>
                <span class="n">z_label</span><span class="o">=</span><span class="s1">&#39;Stress 3&#39;</span> <span class="o">+</span> <span class="n">stress_units</span><span class="p">,</span>
                <span class="n">view_angles_deg</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">is_latex</span><span class="o">=</span><span class="n">is_latex</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Save figure</span>
            <span class="k">if</span> <span class="n">is_save_fig</span><span class="p">:</span>
                <span class="n">save_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;_principal&#39;</span><span class="p">,</span>
                            <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~        </span>
        <span class="c1"># Plot stress path in principal stress space (pi stress coordinates)</span>
        <span class="k">if</span> <span class="n">is_plot_pi_stress_path_pairs</span><span class="p">:</span>
            <span class="c1"># Set rotation matrix between principal stress coordinates to pi</span>
            <span class="c1"># stress coordinates</span>
            <span class="n">rotation_matrix</span> <span class="o">=</span> \
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)],</span>
                          <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)],</span>
                          <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)]])</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Initialize pi stresses</span>
            <span class="n">stress_paths_pi</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># Loop over stress paths</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_path</span><span class="p">):</span>
                <span class="c1"># Randomize path principal stresses order (same permutation is</span>
                <span class="c1"># applied for all time steps)</span>
                <span class="n">stress_path_principal_random</span> <span class="o">=</span> \
                    <span class="n">stress_paths_principal</span><span class="p">[</span><span class="n">k</span><span class="p">][:,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Initialize stresses in pi-stress space</span>
                <span class="n">stress_pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_time_max</span><span class="p">,</span> <span class="n">n_dim</span><span class="p">))</span>
                <span class="c1"># Loop over discrete time</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">[</span><span class="n">k</span><span class="p">])):</span>
                    <span class="c1"># Get principal stresses</span>
                    <span class="n">stress_eigen</span> <span class="o">=</span> <span class="n">stress_path_principal_random</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
                    <span class="c1"># Compute pi stresses</span>
                    <span class="n">stress_pi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">rotation_matrix</span><span class="p">,</span> <span class="n">stress_eigen</span><span class="p">)</span>
                <span class="c1"># Store stress path pi stresses</span>
                <span class="n">stress_paths_pi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stress_pi</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Set pi stress pairs</span>
            <span class="n">pi_stress_pairs</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">))</span>
            <span class="c1"># Loop over pi stress pairs</span>
            <span class="k">for</span> <span class="n">pi_stress_pair</span> <span class="ow">in</span> <span class="n">pi_stress_pairs</span><span class="p">:</span>
                <span class="c1"># Get pi stress components indexes</span>
                <span class="n">j_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pi_stress_pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">j_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pi_stress_pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="c1"># Initialize stress data array</span>
                <span class="n">stress_data_xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">n_time_max</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">n_path</span><span class="p">),</span>
                                         <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                <span class="c1"># Loop over stress paths </span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_path</span><span class="p">):</span>
                    <span class="c1"># Set stress data array</span>
                    <span class="n">stress_data_xy</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="n">stress_paths_pi</span><span class="p">[</span><span class="n">k</span><span class="p">][:,</span> <span class="n">j_x</span><span class="p">]</span>
                    <span class="n">stress_data_xy</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="n">stress_paths_pi</span><span class="p">[</span><span class="n">k</span><span class="p">][:,</span> <span class="n">j_y</span><span class="p">]</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Plot stress path for pi stress components pair</span>
                <span class="n">figure</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_xy_data</span><span class="p">(</span>
                    <span class="n">data_xy</span><span class="o">=</span><span class="n">stress_data_xy</span><span class="p">,</span>
                    <span class="n">x_label</span><span class="o">=</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pi-Stress </span><span class="si">{</span><span class="n">pi_stress_pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
                             <span class="o">+</span> <span class="n">stress_units</span><span class="p">),</span>
                    <span class="n">y_label</span><span class="o">=</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pi-Stress </span><span class="si">{</span><span class="n">pi_stress_pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
                             <span class="o">+</span> <span class="n">stress_units</span><span class="p">),</span>
                    <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">is_latex</span><span class="o">=</span><span class="n">is_latex</span><span class="p">)</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Save figure</span>
                <span class="k">if</span> <span class="n">is_save_fig</span><span class="p">:</span>
                    <span class="n">save_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;_pi_stress_&#39;</span>
                                <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pi_stress_pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">v</span><span class="si">{</span><span class="n">pi_stress_pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                                <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Initialize stress invariants</span>
        <span class="n">stress_paths_invar</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">stress_paths_invar_dev</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Compute stress invariants</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_path</span><span class="p">):</span>
            <span class="c1"># Initialize stress invariants</span>
            <span class="n">stress_invar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_time_max</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
            <span class="n">stress_invar_dev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_time_max</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
            <span class="c1"># Loop over discrete time</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">[</span><span class="n">k</span><span class="p">])):</span>
                <span class="c1"># Get stress tensor</span>
                <span class="n">stress</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">build_tensor_from_comps</span><span class="p">(</span>
                    <span class="n">n_dim</span><span class="p">,</span> <span class="n">stress_comps_order</span><span class="p">,</span> <span class="n">stress_path</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span>
                    <span class="n">is_symmetric</span><span class="o">=</span><span class="n">strain_formulation</span><span class="o">==</span><span class="s1">&#39;infinitesimal&#39;</span><span class="p">)</span>
                <span class="c1"># Compute stress invariants</span>
                <span class="n">invar</span><span class="p">,</span> <span class="n">invar_dev</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">compute_stress_invariants</span><span class="p">(</span><span class="n">stress</span><span class="p">)</span>
                <span class="c1"># Store stress invariants</span>
                <span class="n">stress_invar</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">invar</span>
                <span class="n">stress_invar_dev</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">invar_dev</span>
            <span class="c1"># Store stress path invariants</span>
            <span class="n">stress_paths_invar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stress_invar</span><span class="p">)</span>
            <span class="n">stress_paths_invar_dev</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stress_invar_dev</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Plot stress invariants (distribution and box plot)</span>
        <span class="k">if</span> <span class="n">is_plot_stress_invar_hist</span> <span class="ow">or</span> <span class="n">is_plot_stress_invar_box</span><span class="p">:</span>
            <span class="c1"># Set stress invariants data labels</span>
            <span class="n">invar_labels</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;I1&#39;</span><span class="p">,</span> <span class="s1">&#39;I2&#39;</span><span class="p">,</span> <span class="s1">&#39;I3&#39;</span><span class="p">,</span> <span class="s1">&#39;J1&#39;</span><span class="p">,</span> <span class="s1">&#39;J2&#39;</span><span class="p">,</span> <span class="s1">&#39;J3&#39;</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Concatenate stress paths</span>
            <span class="n">stress_invar_data</span> <span class="o">=</span> \
                <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">stress_paths_invar</span><span class="p">),</span>
                           <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">stress_paths_invar_dev</span><span class="p">)])</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Plot stress invariants distribution</span>
            <span class="k">if</span> <span class="n">is_plot_stress_invar_hist</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">invariant</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">invar_labels</span><span class="p">):</span>
                    <span class="n">figure</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_histogram</span><span class="p">(</span>
                        <span class="p">(</span><span class="n">stress_invar_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">x_label</span><span class="o">=</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Stress invariant (</span><span class="si">{</span><span class="n">invariant</span><span class="si">}</span><span class="s1">)&#39;</span>
                                 <span class="o">+</span> <span class="n">stress_units</span><span class="p">),</span>
                        <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;Probability density&#39;</span><span class="p">,</span>
                        <span class="n">is_latex</span><span class="o">=</span><span class="n">is_latex</span><span class="p">)</span>
                    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                    <span class="c1"># Save figure</span>
                    <span class="k">if</span> <span class="n">is_save_fig</span><span class="p">:</span>
                        <span class="n">save_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">filename</span>
                                    <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;_invariant_</span><span class="si">{</span><span class="n">invariant</span><span class="si">}</span><span class="s1">_hist&#39;</span><span class="p">,</span>
                                    <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Plot stress invariants box plot</span>
            <span class="k">if</span> <span class="n">is_plot_stress_invar_box</span><span class="p">:</span>
                <span class="n">figure</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_boxplots</span><span class="p">(</span><span class="n">stress_invar_data</span><span class="p">,</span> <span class="n">invar_labels</span><span class="p">,</span>
                                          <span class="n">x_label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Stress invariants&#39;</span><span class="p">,</span>
                                          <span class="n">y_label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Stress&#39;</span> <span class="o">+</span> <span class="n">stress_units</span><span class="p">,</span>
                                          <span class="n">y_scale</span><span class="o">=</span><span class="s1">&#39;symlog&#39;</span><span class="p">,</span>
                                          <span class="n">is_latex</span><span class="o">=</span><span class="n">is_latex</span><span class="p">)</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Save figure</span>
                <span class="k">if</span> <span class="n">is_save_fig</span><span class="p">:</span>
                    <span class="n">save_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;invariants_boxplot&#39;</span><span class="p">,</span>
                                <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Initialize triaxiality and Lode parameter</span>
        <span class="n">stress_paths_triax</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">stress_paths_lode</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Compute triaxiality and Lode parameter</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_path</span><span class="p">):</span>
            <span class="c1"># Initialize stress invariants</span>
            <span class="n">stress_triax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_time_max</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">stress_lode</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_time_max</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="c1"># Get stress path stress invariants</span>
            <span class="n">stress_invar</span> <span class="o">=</span> <span class="n">stress_paths_invar</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">stress_invar_dev</span> <span class="o">=</span> <span class="n">stress_paths_invar_dev</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="c1"># Loop over discrete time</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">[</span><span class="n">k</span><span class="p">])):</span>
                <span class="c1"># Get stress invariants</span>
                <span class="n">i1</span> <span class="o">=</span> <span class="n">stress_invar</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                <span class="n">j2</span> <span class="o">=</span> <span class="n">stress_invar_dev</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">j3</span> <span class="o">=</span> <span class="n">stress_invar_dev</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="c1"># Compute triaxiality and Lode parameter</span>
                <span class="n">tolerance</span> <span class="o">=</span> <span class="mf">1e-8</span>
                <span class="k">if</span> <span class="n">j2</span> <span class="o">&lt;</span> <span class="n">tolerance</span><span class="p">:</span>
                    <span class="n">stress_triax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                    <span class="n">stress_lode</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                <span class="k">else</span><span class="p">:</span>                    
                    <span class="n">stress_triax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(((</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">i1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="o">*</span><span class="n">j2</span><span class="p">)))</span>
                    <span class="n">stress_lode</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">j3</span><span class="o">/</span><span class="p">(</span><span class="n">j2</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>
            <span class="c1"># Store stress path triaxiality and Lode parameter</span>
            <span class="n">stress_paths_triax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stress_triax</span><span class="p">)</span>
            <span class="n">stress_paths_lode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stress_lode</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Plot stress triaxiality and Lode parameter paths</span>
        <span class="k">if</span> <span class="n">is_plot_stress_path_triax_lode</span><span class="p">:</span>
            <span class="c1"># Set stress triaxiality data array</span>
            <span class="n">triax_data_xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_time_max</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">n_path</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_path</span><span class="p">):</span>
                <span class="n">triax_data_xy</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_hist</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">triax_data_xy</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="n">stress_paths_triax</span><span class="p">[</span><span class="n">k</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Plot stress triaxility path</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_xy_data</span><span class="p">(</span><span class="n">data_xy</span><span class="o">=</span><span class="n">triax_data_xy</span><span class="p">,</span>
                                     <span class="n">x_lims</span><span class="o">=</span><span class="p">(</span><span class="n">time_min</span><span class="p">,</span> <span class="n">time_max</span><span class="p">),</span>
                                     <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;Triaxiality&#39;</span><span class="p">,</span>
                                     <span class="n">is_latex</span><span class="o">=</span><span class="n">is_latex</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Save figure</span>
            <span class="k">if</span> <span class="n">is_save_fig</span><span class="p">:</span>
                <span class="n">save_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;_triaxiality&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span>
                            <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Set stress Lode parameter data array</span>
            <span class="n">lode_data_xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_time_max</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">n_path</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_path</span><span class="p">):</span>
                <span class="n">lode_data_xy</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_hist</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">lode_data_xy</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="n">stress_paths_lode</span><span class="p">[</span><span class="n">k</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Plot stress Lode parameter path</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_xy_data</span><span class="p">(</span><span class="n">data_xy</span><span class="o">=</span><span class="n">lode_data_xy</span><span class="p">,</span>
                                     <span class="n">x_lims</span><span class="o">=</span><span class="p">(</span><span class="n">time_min</span><span class="p">,</span> <span class="n">time_max</span><span class="p">),</span>
                                     <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;Lode parameter&#39;</span><span class="p">,</span>
                                     <span class="n">is_latex</span><span class="o">=</span><span class="n">is_latex</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Save figure</span>
            <span class="k">if</span> <span class="n">is_save_fig</span><span class="p">:</span>
                <span class="n">save_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;_lode_parameter&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span>
                            <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Plot stress invariants (distribution and box plot)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">is_plot_stress_triax_lode_space</span> <span class="ow">or</span> <span class="n">is_plot_stress_triax_lode_hist</span>
                <span class="ow">or</span> <span class="n">is_plot_stress_triax_lode_box</span><span class="p">):</span>
            <span class="c1"># Set stress triaxiality and Lode parameter data labels</span>
            <span class="n">data_labels</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Triaxiality&#39;</span><span class="p">,</span> <span class="s1">&#39;Lode parameter&#39;</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Concatenate stress paths</span>
            <span class="n">stress_triax_lode_data</span> <span class="o">=</span> \
                <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">stress_paths_triax</span><span class="p">),</span>
                           <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">stress_paths_lode</span><span class="p">)])</span>
            <span class="n">stress_triax_lode_data</span> <span class="o">=</span> <span class="n">stress_triax_lode_data</span><span class="p">[</span>
                <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">stress_triax_lode_data</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="p">:]</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Plot stress triaxiality and Lode parameter space</span>
            <span class="k">if</span> <span class="n">is_plot_stress_triax_lode_space</span><span class="p">:</span>
                <span class="c1"># Set concatenation option</span>
                <span class="n">is_concatenate_paths</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="c1"># Set scatter plot data</span>
                <span class="k">if</span> <span class="n">is_concatenate_paths</span><span class="p">:</span>
                    <span class="n">stress_triax_lode_data_xy</span> <span class="o">=</span> <span class="n">stress_triax_lode_data</span><span class="p">[:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Initialize data array</span>
                    <span class="n">stress_triax_lode_data_xy</span> <span class="o">=</span> \
                        <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_time_max</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">n_path</span><span class="p">))</span>
                    <span class="c1"># Loop over stress paths</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_path</span><span class="p">):</span>
                        <span class="c1"># Assemble stress path data</span>
                        <span class="n">stress_triax_lode_data_xy</span><span class="p">[:,</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> \
                            <span class="n">stress_paths_lode</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                        <span class="n">stress_triax_lode_data_xy</span><span class="p">[:,</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> \
                            <span class="n">stress_paths_triax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="n">figure</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">scatter_xy_data</span><span class="p">(</span>
                    <span class="n">data_xy</span><span class="o">=</span><span class="n">stress_triax_lode_data_xy</span><span class="p">,</span>
                    <span class="n">x_label</span><span class="o">=</span><span class="n">data_labels</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">y_label</span><span class="o">=</span><span class="n">data_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">is_marginal_dists</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="n">x_lims</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">is_latex</span><span class="o">=</span><span class="n">is_latex</span><span class="p">)</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Save figure</span>
                <span class="k">if</span> <span class="n">is_save_fig</span><span class="p">:</span>
                    <span class="n">save_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">filename</span>
                                <span class="o">+</span> <span class="s1">&#39;_triaxiality_lode_marginals&#39;</span><span class="p">,</span>
                                <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Plot stress triaxiality and Lode parameter distributions</span>
            <span class="k">if</span> <span class="n">is_plot_stress_triax_lode_hist</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">metric</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_labels</span><span class="p">):</span>
                    <span class="n">figure</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_histogram</span><span class="p">(</span>
                        <span class="p">(</span><span class="n">stress_triax_lode_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">x_label</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;Probability density&#39;</span><span class="p">,</span>
                        <span class="n">is_latex</span><span class="o">=</span><span class="n">is_latex</span><span class="p">)</span>
                    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                    <span class="c1"># Save figure</span>
                    <span class="k">if</span> <span class="n">is_save_fig</span><span class="p">:</span>
                        <span class="n">save_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">filename</span>
                                    <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;_</span><span class="si">{</span><span class="n">metric</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
                                    <span class="o">+</span> <span class="s1">&#39;_hist&#39;</span><span class="p">,</span>
                                    <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Plot stress triaxiality and Lode parameter box plot</span>
            <span class="k">if</span> <span class="n">is_plot_stress_triax_lode_box</span><span class="p">:</span>
                <span class="n">figure</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_boxplots</span><span class="p">(</span>
                    <span class="n">stress_triax_lode_data</span><span class="p">,</span> <span class="n">data_labels</span><span class="p">,</span>
                    <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;Stress invariants&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span>
                    <span class="n">is_latex</span><span class="o">=</span><span class="n">is_latex</span><span class="p">)</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Save figure</span>
                <span class="k">if</span> <span class="n">is_save_fig</span><span class="p">:</span>
                    <span class="n">save_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;_triaxiality_lode_boxplot&#39;</span><span class="p">,</span>
                                <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Display figures</span>
        <span class="k">if</span> <span class="n">is_stdout_display</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Close plot</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span></div>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<div class="viewcode-block" id="MaterialResponseDatasetGenerator.compute_stress_invariants"><a class="viewcode-back" href="../../../_autosummary/hookeai.miscellaneous.materials.compare_material_models.MaterialResponseDatasetGenerator.html#hookeai.miscellaneous.dataset_processing.read_csv_response_dataset.MaterialResponseDatasetGenerator.compute_stress_invariants">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_stress_invariants</span><span class="p">(</span><span class="n">stress</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute stress invariants.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        stress : np.ndarray(2d)</span>
<span class="sd">            Stress tensor.</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        stress_invar : np.ndarray(1d)</span>
<span class="sd">            Stress invariants.</span>
<span class="sd">        stress_invar_dev : np.ndarray(1d)</span>
<span class="sd">            Deviatoric stress invariants</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize stress invariants</span>
        <span class="n">stress_invar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="c1"># Compute stress invariants</span>
        <span class="n">stress_invar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">stress</span><span class="p">)</span>
        <span class="n">stress_invar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> \
            <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">stress</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">stress</span><span class="p">,</span> <span class="n">stress</span><span class="p">)))</span>
        <span class="n">stress_invar</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">stress</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Initialize deviatoric stress invariants</span>
        <span class="n">stress_invar_dev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="c1"># Compute deviatoric stress invariants</span>
        <span class="n">stress_invar_dev</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">stress_invar_dev</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">stress_invar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">stress_invar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">stress_invar_dev</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">27.0</span><span class="p">)</span><span class="o">*</span><span class="n">stress_invar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span>
                               <span class="o">-</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">stress_invar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">stress_invar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                               <span class="o">+</span> <span class="n">stress_invar</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">return</span> <span class="n">stress_invar</span><span class="p">,</span> <span class="n">stress_invar_dev</span></div>
    <span class="c1"># -------------------------------------------------------------------------</span>
<div class="viewcode-block" id="MaterialResponseDatasetGenerator.plot_state_history"><a class="viewcode-back" href="../../../_autosummary/hookeai.miscellaneous.materials.compare_material_models.MaterialResponseDatasetGenerator.html#hookeai.miscellaneous.dataset_processing.read_csv_response_dataset.MaterialResponseDatasetGenerator.plot_state_history">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_state_history</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">strain_formulation</span><span class="p">,</span> <span class="n">strain_comps_order</span><span class="p">,</span>
                           <span class="n">stress_comps_order</span><span class="p">,</span> <span class="n">state_variable_name</span><span class="p">,</span>
                           <span class="n">state_variable_label</span><span class="p">,</span> <span class="n">state_path</span><span class="p">,</span> <span class="n">time_hist</span><span class="p">,</span>
                           <span class="n">state_units</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                           <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;state_variable_path&#39;</span><span class="p">,</span>
                           <span class="n">save_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">is_stdout_display</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_latex</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot constitutive state variable path.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        strain_formulation: {&#39;infinitesimal&#39;, &#39;finite&#39;}</span>
<span class="sd">            Problem strain formulation.</span>
<span class="sd">        n_dim : int</span>
<span class="sd">            Problem number of spatial dimensions.</span>
<span class="sd">        strain_comps_order : tuple</span>
<span class="sd">            Stress components order.</span>
<span class="sd">        stress_comps_order : tuple</span>
<span class="sd">            Stress components order.</span>
<span class="sd">        state_variable_name : str</span>
<span class="sd">            State variable name.</span>
<span class="sd">        state_variable_label : str</span>
<span class="sd">            State variable label.</span>
<span class="sd">        state_path : {numpy.ndarray(2d), list[numpy.ndarray(2d)]}</span>
<span class="sd">            State variable path history stored as numpy.ndarray(2d) of shape</span>
<span class="sd">            (sequence_length, n_features) or list of multiple state variable</span>
<span class="sd">            path histories.</span>
<span class="sd">        time_hist : {numpy.ndarray(1d), list[numpy.ndarray(1d)]}</span>
<span class="sd">            Discrete time history or list of multiple discrete time histories.</span>
<span class="sd">        state_units : str, default=&#39;&#39;</span>
<span class="sd">            State variable units label.</span>
<span class="sd">        filename : str, default=&#39;state_variable_path&#39;</span>
<span class="sd">            Figure name.</span>
<span class="sd">        save_dir : str, default=None</span>
<span class="sd">            Directory where figure is saved. If None, then figure is saved in</span>
<span class="sd">            current working directory.</span>
<span class="sd">        is_save_fig : bool, default=False</span>
<span class="sd">            Save figure.</span>
<span class="sd">        is_stdout_display : bool, default=False</span>
<span class="sd">            True if displaying figure to standard output device, False</span>
<span class="sd">            otherwise.</span>
<span class="sd">        is_latex : bool, default=False</span>
<span class="sd">            If True, then render all strings in LaTeX. If LaTex is not</span>
<span class="sd">            available, then this option is silently set to False and all input</span>
<span class="sd">            strings are processed to remove $(...)$ enclosure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check state paths data</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_hist</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state_path</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="c1"># Check multiple state paths</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_hist</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state_path</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Inconsistent discrete time histories and &#39;</span>
                                   <span class="s1">&#39;state path histories when providing &#39;</span>
                                   <span class="s1">&#39;multiple state paths.&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">state_path</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Inconsistent discrete time histories and &#39;</span>
                                   <span class="s1">&#39;state path histories when providing &#39;</span>
                                   <span class="s1">&#39;multiple state paths.&#39;</span><span class="p">)</span>
            <span class="c1"># Get number of state paths</span>
            <span class="n">n_path</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">state_path</span><span class="p">)</span>
            <span class="c1"># Get longest state path</span>
            <span class="n">n_time_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">time_hist</span><span class="p">])</span>
            <span class="c1"># Get minimum and maximum discrete times</span>
            <span class="n">time_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">time_hist</span><span class="p">])</span>
            <span class="n">time_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">time_hist</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Set number of state paths</span>
            <span class="n">n_path</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="c1"># Set longest state path</span>
            <span class="n">n_time_max</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">)</span>
            <span class="c1"># Set minimum and maximum discrete times</span>
            <span class="n">time_min</span> <span class="o">=</span> <span class="n">time_hist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">time_max</span> <span class="o">=</span> <span class="n">time_hist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1"># Store discrete time history and stress path in list</span>
            <span class="n">time_hist</span> <span class="o">=</span> <span class="p">[</span><span class="n">time_hist</span><span class="p">,]</span>
            <span class="n">state_path</span> <span class="o">=</span> <span class="p">[</span><span class="n">state_path</span><span class="p">,]</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Initialize figure</span>
        <span class="n">figure</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Probe dimensionality of state variable</span>
        <span class="n">n_features</span> <span class="o">=</span> <span class="n">state_path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Plot state variable path</span>
        <span class="k">if</span> <span class="n">n_features</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Initialize state variable data array</span>
            <span class="n">state_data_xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">n_time_max</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">n_path</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="c1"># Loop over strain paths</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_path</span><span class="p">):</span>
                <span class="n">state_data_xy</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_hist</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">state_data_xy</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">time_hist</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="n">state_path</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Plot state variable path</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> \
                <span class="n">plot_xy_data</span><span class="p">(</span><span class="n">data_xy</span><span class="o">=</span><span class="n">state_data_xy</span><span class="p">,</span>
                             <span class="n">x_lims</span><span class="o">=</span><span class="p">(</span><span class="n">time_min</span><span class="p">,</span> <span class="n">time_max</span><span class="p">),</span>
                             <span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span>
                             <span class="n">y_label</span><span class="o">=</span><span class="n">state_variable_label</span> <span class="o">+</span> <span class="n">state_units</span><span class="p">,</span>
                             <span class="n">is_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Save figure</span>
            <span class="k">if</span> <span class="n">is_save_fig</span><span class="p">:</span>
                <span class="n">save_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Concatenate state variable paths</span>
            <span class="n">state_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">state_path</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># Plot state variable distribution</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_histogram</span><span class="p">(</span>
                <span class="p">(</span><span class="n">state_data</span><span class="p">,),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">x_label</span><span class="o">=</span><span class="n">state_variable_label</span> <span class="o">+</span> <span class="n">state_units</span><span class="p">,</span>
                <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;Probability density&#39;</span><span class="p">,</span>
                <span class="n">is_latex</span><span class="o">=</span><span class="n">is_latex</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Save figure</span>
            <span class="k">if</span> <span class="n">is_save_fig</span><span class="p">:</span>
                <span class="n">save_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;_hist&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span>
                            <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Not implemented.&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Display figures</span>
        <span class="k">if</span> <span class="n">is_stdout_display</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Close plot</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span></div></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="generate_dataset_plots"><a class="viewcode-back" href="../../../_autosummary/hookeai.simulators.links.utilities.links_out_to_dataset.generate_dataset_plots.html#hookeai.miscellaneous.dataset_processing.read_csv_response_dataset.generate_dataset_plots">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">generate_dataset_plots</span><span class="p">(</span><span class="n">strain_formulation</span><span class="p">,</span> <span class="n">n_dim</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span>
                           <span class="n">save_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">is_stdout_display</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate plots for strain-stress material response path data set.</span>
<span class="sd">    </span>
<span class="sd">    The different plots options must be set manually by means of the</span>
<span class="sd">    corresponding plotting methods arguments.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    strain_formulation: {&#39;infinitesimal&#39;, &#39;finite&#39;}</span>
<span class="sd">        Problem strain formulation.</span>
<span class="sd">    n_dim : int</span>
<span class="sd">        Problem number of spatial dimensions.</span>
<span class="sd">    dataset : torch.utils.data.Dataset</span>
<span class="sd">        Time series data set. Each sample is stored as a dictionary where each</span>
<span class="sd">        feature (key, str) data is a torch.Tensor(2d) of shape</span>
<span class="sd">        (sequence_length, n_features).</span>
<span class="sd">    save_dir : str</span>
<span class="sd">        Directory where data set plots are saved. If None, then plots are</span>
<span class="sd">        saved in current working directory.</span>
<span class="sd">    is_save_fig : bool, default=False</span>
<span class="sd">        Save data set plots.</span>
<span class="sd">    is_stdout_display : bool, default=False</span>
<span class="sd">        True if displaying data set plots to standard output device, False</span>
<span class="sd">        otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get data loader</span>
    <span class="n">data_loader</span> <span class="o">=</span> <span class="n">get_time_series_data_loader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Initialize strain-stress paths data</span>
    <span class="n">time_hists</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">strain_paths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">stress_paths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Loop over strain-stress paths</span>
    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">data_loader</span><span class="p">:</span>
        <span class="c1"># Collect strain-stress path data</span>
        <span class="n">time_hists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="s1">&#39;time_hist&#39;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">strain_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="s1">&#39;strain_path&#39;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]))</span>
        <span class="n">stress_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="s1">&#39;stress_path&#39;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]))</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Get strain components order</span>
    <span class="n">strain_comps_order</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;strain_comps_order&#39;</span><span class="p">]</span>
    <span class="c1"># Plot strain paths data</span>
    <span class="n">StrainPathGenerator</span><span class="o">.</span><span class="n">plot_strain_path</span><span class="p">(</span>
        <span class="n">strain_formulation</span><span class="p">,</span> <span class="n">n_dim</span><span class="p">,</span>
        <span class="n">strain_comps_order</span><span class="p">,</span> <span class="n">time_hists</span><span class="p">,</span> <span class="n">strain_paths</span><span class="p">,</span>
        <span class="n">is_plot_strain_path</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">is_plot_strain_comp_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_plot_strain_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_plot_strain_norm_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_plot_inc_strain_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_plot_inc_strain_norm_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_plot_strain_path_pairs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_plot_strain_pairs_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_plot_strain_pairs_marginals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_plot_strain_comp_box</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">strain_label</span><span class="o">=</span><span class="s1">&#39;Strain&#39;</span><span class="p">,</span>
        <span class="n">strain_units</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;strain_path&#39;</span><span class="p">,</span>
        <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">,</span>
        <span class="n">is_save_fig</span><span class="o">=</span><span class="n">is_save_fig</span><span class="p">,</span>
        <span class="n">is_stdout_display</span><span class="o">=</span><span class="n">is_stdout_display</span><span class="p">,</span>
        <span class="n">is_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Plot stress paths data</span>
    <span class="n">StrainPathGenerator</span><span class="o">.</span><span class="n">plot_strain_path</span><span class="p">(</span>
        <span class="n">strain_formulation</span><span class="p">,</span> <span class="n">n_dim</span><span class="p">,</span>
        <span class="n">strain_comps_order</span><span class="p">,</span> <span class="n">time_hists</span><span class="p">,</span> <span class="n">stress_paths</span><span class="p">,</span>
        <span class="n">is_plot_strain_path</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">is_plot_strain_comp_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_plot_strain_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_plot_strain_norm_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_plot_inc_strain_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_plot_inc_strain_norm_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_plot_strain_path_pairs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_plot_strain_pairs_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_plot_strain_pairs_marginals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_plot_strain_comp_box</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">strain_label</span><span class="o">=</span><span class="s1">&#39;Stress&#39;</span><span class="p">,</span>
        <span class="n">strain_units</span><span class="o">=</span><span class="s1">&#39; (MPa)&#39;</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;stress_path&#39;</span><span class="p">,</span>
        <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">,</span>
        <span class="n">is_save_fig</span><span class="o">=</span><span class="n">is_save_fig</span><span class="p">,</span>
        <span class="n">is_stdout_display</span><span class="o">=</span><span class="n">is_stdout_display</span><span class="p">,</span>
        <span class="n">is_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Get stress components order</span>
    <span class="n">stress_comps_order</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;stress_comps_order&#39;</span><span class="p">]</span>
    <span class="c1"># Plot stress paths data</span>
    <span class="k">if</span> <span class="n">n_dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">MaterialResponseDatasetGenerator</span><span class="o">.</span><span class="n">plot_stress_space_metrics</span><span class="p">(</span>
            <span class="n">strain_formulation</span><span class="p">,</span> <span class="n">stress_comps_order</span><span class="p">,</span>
            <span class="n">stress_paths</span><span class="p">,</span> <span class="n">time_hists</span><span class="p">,</span>
            <span class="n">is_plot_principal_stress_path</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">is_plot_pi_stress_path_pairs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">is_plot_stress_invar_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">is_plot_stress_invar_box</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">is_plot_stress_path_triax_lode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">is_plot_stress_triax_lode_space</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">is_plot_stress_triax_lode_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">is_plot_stress_triax_lode_box</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">stress_units</span><span class="o">=</span><span class="s1">&#39; (MPa)&#39;</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;stress_path&#39;</span><span class="p">,</span>
            <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">,</span>
            <span class="n">is_save_fig</span><span class="o">=</span><span class="n">is_save_fig</span><span class="p">,</span>
            <span class="n">is_stdout_display</span><span class="o">=</span><span class="n">is_stdout_display</span><span class="p">,</span> <span class="n">is_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Plot state variable paths data</span>
    <span class="n">is_plot_state_variable_paths</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">is_plot_state_variable_paths</span><span class="p">:</span>
        <span class="c1"># Initialize state variable path data</span>
        <span class="n">state_paths</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set state variable name and label</span>
        <span class="n">state_variable_name</span> <span class="o">=</span> <span class="s1">&#39;acc_p_strain&#39;</span>
        <span class="n">state_variable_label</span> <span class="o">=</span> <span class="s1">&#39;Accumulated plastic strain&#39;</span>
        <span class="c1"># Loop over strain-stress paths</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">data_loader</span><span class="p">:</span>
            <span class="c1"># Check state variable</span>
            <span class="k">if</span> <span class="n">state_variable_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">continue</span>
            <span class="c1"># Collect state variable path data</span>
            <span class="n">state_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="n">state_variable_name</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]))</span>
        <span class="c1"># Plot state variable paths data</span>
        <span class="k">if</span> <span class="n">state_paths</span><span class="p">:</span>
            <span class="n">MaterialResponseDatasetGenerator</span><span class="o">.</span><span class="n">plot_state_history</span><span class="p">(</span>
                <span class="n">strain_formulation</span><span class="p">,</span> <span class="n">strain_comps_order</span><span class="p">,</span> <span class="n">stress_comps_order</span><span class="p">,</span>
                <span class="n">state_variable_name</span><span class="p">,</span> <span class="n">state_variable_label</span><span class="p">,</span> <span class="n">state_paths</span><span class="p">,</span>
                <span class="n">time_hists</span><span class="p">,</span> <span class="n">state_units</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;acc_p_strain_path&#39;</span><span class="p">,</span>
                <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">,</span> <span class="n">is_save_fig</span><span class="o">=</span><span class="n">is_save_fig</span><span class="p">,</span>
                <span class="n">is_stdout_display</span><span class="o">=</span><span class="n">is_stdout_display</span><span class="p">,</span> <span class="n">is_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>
<span class="c1"># =============================================================================</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1"># Set float precision</span>
    <span class="n">is_double_precision</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">is_double_precision</span><span class="p">:</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">set_default_dtype</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">set_default_dtype</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set data set type</span>
    <span class="n">dataset_type</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;training&#39;</span><span class="p">,</span> <span class="s1">&#39;validation&#39;</span><span class="p">,</span> <span class="s1">&#39;testing_id&#39;</span><span class="p">,</span> <span class="s1">&#39;testing_od&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># Set data set storage type</span>
    <span class="n">is_in_memory_dataset</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># Set save dataset plots flags</span>
    <span class="n">is_save_dataset_plots</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set data set sizes</span>
    <span class="k">if</span> <span class="n">dataset_type</span> <span class="o">==</span> <span class="s1">&#39;training&#39;</span><span class="p">:</span>
        <span class="n">n_paths_dirs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">1280</span><span class="p">,</span> <span class="mi">2560</span><span class="p">)</span>
        <span class="n">n_paths</span> <span class="o">=</span> <span class="n">n_paths_dirs</span>
    <span class="k">elif</span> <span class="n">dataset_type</span> <span class="o">==</span> <span class="s1">&#39;validation&#39;</span><span class="p">:</span>
        <span class="n">n_paths_dirs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">1280</span><span class="p">,</span> <span class="mi">2560</span><span class="p">)</span>
        <span class="n">n_paths</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">dataset_type</span> <span class="o">==</span> <span class="s1">&#39;testing_id&#39;</span><span class="p">:</span>
        <span class="n">n_paths_dirs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">512</span><span class="p">,)</span>
        <span class="n">n_paths</span> <span class="o">=</span> <span class="p">(</span><span class="mi">512</span><span class="p">,)</span>
    <span class="k">elif</span> <span class="n">dataset_type</span> <span class="o">==</span> <span class="s1">&#39;testing_od&#39;</span><span class="p">:</span>
        <span class="n">n_paths_dirs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">512</span><span class="p">,)</span>
        <span class="n">n_paths</span> <span class="o">=</span> <span class="p">(</span><span class="mi">512</span><span class="p">,)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set shuffle data set samples flag (only effective for multiple data sets)</span>
    <span class="n">is_shuffle_dataset_samples</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Loop over data set sizes</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n_path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_paths</span><span class="p">):</span>
        <span class="c1"># Set data sets base directory</span>
        <span class="n">datasets_base_dir</span> <span class="o">=</span> \
            <span class="p">(</span><span class="s1">&#39;/home/username/Documents/brown/projects/darpa_project/&#39;</span>
             <span class="s1">&#39;8_global_random_specimen/von_mises/0_local_datasets&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Check data sets directory</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">datasets_base_dir</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;The data sets base directory has not been &#39;</span>
                               <span class="s1">&#39;found:</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">datasets_base_dir</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set data set directory (current number of paths)</span>
        <span class="n">dataset_size_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">datasets_base_dir</span><span class="p">),</span>
                                        <span class="sa">f</span><span class="s1">&#39;n</span><span class="si">{</span><span class="n">n_paths_dirs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># Create data set directory</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">dataset_size_dir</span><span class="p">):</span>
            <span class="n">make_directory</span><span class="p">(</span><span class="n">dataset_size_dir</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set data set file basename</span>
        <span class="n">dataset_basename</span> <span class="o">=</span> <span class="s1">&#39;ss_paths_dataset&#39;</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set data set directory</span>
        <span class="k">if</span> <span class="n">dataset_type</span> <span class="o">==</span> <span class="s1">&#39;training&#39;</span><span class="p">:</span>
            <span class="n">dataset_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">dataset_size_dir</span><span class="p">),</span> <span class="s1">&#39;1_training_dataset&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dataset_type</span> <span class="o">==</span> <span class="s1">&#39;validation&#39;</span><span class="p">:</span>
            <span class="n">dataset_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">dataset_size_dir</span><span class="p">),</span> <span class="s1">&#39;2_validation_dataset&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dataset_type</span> <span class="o">==</span> <span class="s1">&#39;testing_id&#39;</span><span class="p">:</span>
            <span class="n">dataset_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">dataset_size_dir</span><span class="p">),</span> <span class="s1">&#39;5_testing_id_dataset&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dataset_type</span> <span class="o">==</span> <span class="s1">&#39;testing_od&#39;</span><span class="p">:</span>
            <span class="n">dataset_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">dataset_size_dir</span><span class="p">),</span> <span class="s1">&#39;6_testing_od_dataset&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Unknown data set type.&#39;</span><span class="p">)</span>
        <span class="c1"># Create data set directory (overwrite existing directory)</span>
        <span class="n">make_directory</span><span class="p">(</span><span class="n">dataset_directory</span><span class="p">,</span> <span class="n">is_overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set strain formulation</span>
        <span class="n">strain_formulation</span> <span class="o">=</span> <span class="s1">&#39;infinitesimal&#39;</span>
        <span class="c1"># Set problem type</span>
        <span class="n">problem_type</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="c1"># Get problem type parameters</span>
        <span class="n">n_dim</span><span class="p">,</span> <span class="n">comp_order_sym</span><span class="p">,</span> <span class="n">comp_order_nsym</span> <span class="o">=</span> \
            <span class="n">get_problem_type_parameters</span><span class="p">(</span><span class="n">problem_type</span><span class="p">)</span>
        <span class="c1"># Set strain components order</span>
        <span class="k">if</span> <span class="n">strain_formulation</span> <span class="o">==</span> <span class="s1">&#39;infinitesimal&#39;</span><span class="p">:</span>
            <span class="n">strain_comps_order</span> <span class="o">=</span> <span class="n">comp_order_sym</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Not implemented.&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set number of discrete times</span>
        <span class="n">n_time</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="c1"># Set initial and final time</span>
        <span class="n">time_init</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">time_end</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set strain components bounds</span>
        <span class="n">strain_bounds</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">strain_comps_order</span><span class="p">}</span>
        <span class="c1"># Set incremental strain norm</span>
        <span class="n">inc_strain_norm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Set strain noise</span>
        <span class="n">strain_noise_std</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Set number of loading cycles</span>
        <span class="n">n_cycle</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set constitutive model</span>
        <span class="n">model_name</span> <span class="o">=</span> <span class="s1">&#39;lou_zhang_yoon&#39;</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set constitutive model parameters:</span>
        <span class="k">if</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;von_mises&#39;</span><span class="p">:</span>
            <span class="c1"># Set constitutive model parameters</span>
            <span class="n">model_parameters</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;elastic_symmetry&#39;</span><span class="p">:</span> <span class="s1">&#39;isotropic&#39;</span><span class="p">,</span>
                <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="mf">110e3</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="mf">0.33</span><span class="p">,</span>
                <span class="s1">&#39;euler_angles&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                <span class="s1">&#39;hardening_law&#39;</span><span class="p">:</span> <span class="n">get_hardening_law</span><span class="p">(</span><span class="s1">&#39;nadai_ludwik&#39;</span><span class="p">),</span>
                <span class="s1">&#39;hardening_parameters&#39;</span><span class="p">:</span>
                    <span class="p">{</span><span class="s1">&#39;s0&#39;</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">900</span><span class="p">,</span>
                     <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">700</span><span class="p">,</span>
                     <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                     <span class="s1">&#39;ep0&#39;</span><span class="p">:</span> <span class="mf">1e-5</span><span class="p">}}</span>
            <span class="c1"># Set constitutive state variables to be additionally included in</span>
            <span class="c1"># the data set</span>
            <span class="n">state_features</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;acc_p_strain&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                              <span class="s1">&#39;e_strain_mf&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">strain_comps_order</span><span class="p">)}</span>
        <span class="k">elif</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;drucker_prager&#39;</span><span class="p">:</span>
            <span class="c1"># Set frictional angle</span>
            <span class="n">friction_angle</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
            <span class="c1"># Set dilatancy angle</span>
            <span class="n">dilatancy_angle</span> <span class="o">=</span> <span class="n">friction_angle</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Compute angle-related material parameters</span>
            <span class="c1"># (matching with Mohr-Coulomb under uniaxial tension and</span>
            <span class="c1"># compression)</span>
            <span class="c1"># Set yield surface cohesion parameter</span>
            <span class="n">yield_cohesion_parameter</span> <span class="o">=</span> \
                <span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">friction_angle</span><span class="p">)</span>
            <span class="c1"># Set yield pressure parameter</span>
            <span class="n">yield_pressure_parameter</span> <span class="o">=</span> \
                <span class="p">(</span><span class="mf">3.0</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">friction_angle</span><span class="p">)</span>
            <span class="c1"># Set plastic flow pressure parameter</span>
            <span class="n">flow_pressure_parameter</span> <span class="o">=</span> \
                <span class="p">(</span><span class="mf">3.0</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dilatancy_angle</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Set constitutive model parameters</span>
            <span class="c1"># (matching Von Mises yield surface for null pressure)</span>
            <span class="n">model_parameters</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;elastic_symmetry&#39;</span><span class="p">:</span> <span class="s1">&#39;isotropic&#39;</span><span class="p">,</span>
                <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="mf">110e3</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="mf">0.33</span><span class="p">,</span>
                <span class="s1">&#39;euler_angles&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                <span class="s1">&#39;hardening_law&#39;</span><span class="p">:</span> <span class="n">get_hardening_law</span><span class="p">(</span><span class="s1">&#39;nadai_ludwik&#39;</span><span class="p">),</span>
                <span class="s1">&#39;hardening_parameters&#39;</span><span class="p">:</span>
                    <span class="p">{</span><span class="s1">&#39;s0&#39;</span><span class="p">:</span> <span class="mi">900</span><span class="o">/</span><span class="n">yield_cohesion_parameter</span><span class="p">,</span>
                    <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">700</span><span class="o">/</span><span class="n">yield_cohesion_parameter</span><span class="p">,</span>
                    <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                    <span class="s1">&#39;ep0&#39;</span><span class="p">:</span> <span class="mf">1e-5</span><span class="p">},</span>
                <span class="s1">&#39;yield_cohesion_parameter&#39;</span><span class="p">:</span> <span class="n">yield_cohesion_parameter</span><span class="p">,</span>
                <span class="s1">&#39;yield_pressure_parameter&#39;</span><span class="p">:</span> <span class="n">yield_pressure_parameter</span><span class="p">,</span>
                <span class="s1">&#39;flow_pressure_parameter&#39;</span><span class="p">:</span> <span class="n">flow_pressure_parameter</span><span class="p">,</span>
                <span class="s1">&#39;friction_angle&#39;</span><span class="p">:</span> <span class="n">friction_angle</span><span class="p">}</span>
            <span class="c1"># Set constitutive state variables to be additionally included in</span>
            <span class="c1"># the data set</span>
            <span class="n">state_features</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;e_strain_mf&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">strain_comps_order</span><span class="p">)}</span>
        <span class="k">elif</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;lou_zhang_yoon&#39;</span><span class="p">:</span>
            <span class="c1"># Set constitutive model parameters</span>
            <span class="n">model_parameters</span> <span class="o">=</span> \
                <span class="p">{</span><span class="s1">&#39;elastic_symmetry&#39;</span><span class="p">:</span> <span class="s1">&#39;isotropic&#39;</span><span class="p">,</span>
                <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="mf">110e3</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="mf">0.33</span><span class="p">,</span>
                <span class="s1">&#39;euler_angles&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                <span class="s1">&#39;hardening_law&#39;</span><span class="p">:</span> <span class="n">get_hardening_law</span><span class="p">(</span><span class="s1">&#39;nadai_ludwik&#39;</span><span class="p">),</span>
                <span class="s1">&#39;hardening_parameters&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;s0&#39;</span><span class="p">:</span> <span class="mi">900</span><span class="p">,</span>
                                         <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">700</span><span class="p">,</span>
                                         <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                                         <span class="s1">&#39;ep0&#39;</span><span class="p">:</span> <span class="mf">1e-5</span><span class="p">},</span>
                <span class="s1">&#39;a_hardening_law&#39;</span><span class="p">:</span> <span class="n">get_hardening_law</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">),</span>
                <span class="s1">&#39;a_hardening_parameters&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;s0&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                                           <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
                <span class="s1">&#39;b_hardening_law&#39;</span><span class="p">:</span> <span class="n">get_hardening_law</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">),</span>
                <span class="s1">&#39;b_hardening_parameters&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;s0&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
                                           <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
                <span class="s1">&#39;c_hardening_law&#39;</span><span class="p">:</span> <span class="n">get_hardening_law</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">),</span>
                <span class="s1">&#39;c_hardening_parameters&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;s0&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                                           <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
                <span class="s1">&#39;d_hardening_law&#39;</span><span class="p">:</span> <span class="n">get_hardening_law</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">),</span>
                <span class="s1">&#39;d_hardening_parameters&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;s0&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                                           <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
                <span class="s1">&#39;is_associative_hardening&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
            <span class="c1"># Set constitutive state variables to be additionally included in</span>
            <span class="c1"># the data set</span>
            <span class="n">state_features</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">elif</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;bazant_m7&#39;</span><span class="p">:</span>
            <span class="c1"># Set constitutive model parameters</span>
            <span class="n">model_parameters</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1"># Set constitutive state variables to include in data set</span>
            <span class="n">state_features</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Set constitutive model parameters</span>
            <span class="n">model_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;elastic_symmetry&#39;</span><span class="p">:</span> <span class="s1">&#39;isotropic&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
                                <span class="s1">&#39;euler_angles&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)}</span>
            <span class="c1"># Set constitutive state variables to include in data set</span>
            <span class="n">state_features</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set strain path generators parameters</span>
        <span class="n">strain_path_kwargs_type</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Proportional strain path generator</span>
        <span class="n">strain_path_kwargs_type</span><span class="p">[</span><span class="s1">&#39;proportional&#39;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="p">{</span><span class="s1">&#39;strain_bounds&#39;</span><span class="p">:</span> <span class="n">strain_bounds</span><span class="p">,</span>
             <span class="s1">&#39;n_time&#39;</span><span class="p">:</span> <span class="n">n_time</span><span class="p">,</span>
             <span class="s1">&#39;time_init&#39;</span><span class="p">:</span> <span class="n">time_init</span><span class="p">,</span>
             <span class="s1">&#39;time_end&#39;</span><span class="p">:</span> <span class="n">time_end</span><span class="p">,</span>
             <span class="s1">&#39;inc_strain_norm&#39;</span><span class="p">:</span> <span class="n">inc_strain_norm</span><span class="p">,</span>
             <span class="s1">&#39;strain_noise_std&#39;</span><span class="p">:</span> <span class="n">strain_noise_std</span><span class="p">,</span>
             <span class="s1">&#39;n_cycle&#39;</span><span class="p">:</span> <span class="n">n_cycle</span><span class="p">}</span>
        <span class="c1"># Random strain path generator </span>
        <span class="n">strain_path_kwargs_type</span><span class="p">[</span><span class="s1">&#39;random&#39;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="p">{</span><span class="s1">&#39;n_control&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
             <span class="s1">&#39;strain_bounds&#39;</span><span class="p">:</span> <span class="n">strain_bounds</span><span class="p">,</span>
             <span class="s1">&#39;n_time&#39;</span><span class="p">:</span> <span class="n">n_time</span><span class="p">,</span>
             <span class="s1">&#39;generative_type&#39;</span><span class="p">:</span> <span class="s1">&#39;polynomial&#39;</span><span class="p">,</span>
             <span class="s1">&#39;time_init&#39;</span><span class="p">:</span> <span class="n">time_init</span><span class="p">,</span>
             <span class="s1">&#39;time_end&#39;</span><span class="p">:</span> <span class="n">time_end</span><span class="p">,</span>
             <span class="s1">&#39;inc_strain_norm&#39;</span><span class="p">:</span> <span class="n">inc_strain_norm</span><span class="p">,</span>
             <span class="s1">&#39;strain_noise_std&#39;</span><span class="p">:</span> <span class="n">strain_noise_std</span><span class="p">,</span>
             <span class="s1">&#39;n_cycle&#39;</span><span class="p">:</span> <span class="n">n_cycle</span><span class="p">}</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Initialize strain-stress material response path data set generator</span>
        <span class="n">dataset_generator</span> <span class="o">=</span> \
            <span class="n">MaterialResponseDatasetGenerator</span><span class="p">(</span><span class="n">strain_formulation</span><span class="p">,</span> <span class="n">problem_type</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Initialize data sets</span>
        <span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set data sets option</span>
        <span class="n">datasets_option</span> <span class="o">=</span> <span class="s1">&#39;strain_loading_types&#39;</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">if</span> <span class="n">datasets_option</span> <span class="o">==</span> <span class="s1">&#39;strain_loading_types&#39;</span><span class="p">:</span>
            <span class="c1"># Set number of strain-stress paths of each type</span>
            <span class="n">n_path_type</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">{</span><span class="s1">&#39;proportional&#39;</span><span class="p">:</span> <span class="n">n_path</span><span class="p">,</span>        <span class="s1">&#39;random&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;proportional&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>             <span class="s1">&#39;random&#39;</span><span class="p">:</span> <span class="n">n_path</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;proportional&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_path</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;random&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_path</span><span class="o">/</span><span class="mi">2</span><span class="p">)})[</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Loop over data set types</span>
            <span class="k">for</span> <span class="n">strain_path_type</span><span class="p">,</span> <span class="n">n_path</span> <span class="ow">in</span> <span class="n">n_path_type</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># Check number of strain-stress paths</span>
                <span class="k">if</span> <span class="n">n_path</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Get strain path generators parameters</span>
                <span class="n">strain_path_kwargs</span> <span class="o">=</span> <span class="n">strain_path_kwargs_type</span><span class="p">[</span><span class="n">strain_path_type</span><span class="p">]</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Generate data set</span>
                <span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset_generator</span><span class="o">.</span><span class="n">generate_response_dataset</span><span class="p">(</span>
                    <span class="n">n_path</span><span class="p">,</span> <span class="n">strain_path_type</span><span class="p">,</span> <span class="n">strain_path_kwargs</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span>
                    <span class="n">model_parameters</span><span class="p">,</span> <span class="n">state_features</span><span class="o">=</span><span class="n">state_features</span><span class="p">,</span>
                    <span class="n">is_in_memory_dataset</span><span class="o">=</span><span class="n">is_in_memory_dataset</span><span class="p">,</span>
                    <span class="n">dataset_directory</span><span class="o">=</span><span class="n">dataset_directory</span><span class="p">,</span>
                    <span class="n">dataset_basename</span><span class="o">=</span><span class="n">dataset_basename</span><span class="p">,</span> <span class="n">is_verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Store data set</span>
                <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">elif</span> <span class="n">datasets_option</span> <span class="o">==</span> <span class="s1">&#39;strain_regions&#39;</span><span class="p">:</span>
            <span class="c1"># Set strain path type per strain region</span>
            <span class="n">strain_path_type_region</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">strain_path_type_region</span><span class="p">[</span><span class="s1">&#39;apex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;proportional&#39;</span>
            <span class="n">strain_path_type_region</span><span class="p">[</span><span class="s1">&#39;cone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;random&#39;</span>
            <span class="c1"># Set number of strain-stress paths per strain region</span>
            <span class="n">n_path_region</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">n_path_region</span><span class="p">[</span><span class="s1">&#39;apex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">n_path</span><span class="p">)</span>
            <span class="n">n_path_region</span><span class="p">[</span><span class="s1">&#39;cone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_path</span> <span class="o">-</span> <span class="n">n_path_region</span><span class="p">[</span><span class="s1">&#39;apex&#39;</span><span class="p">]</span>
            <span class="c1"># Loop over data set strain regions</span>
            <span class="k">for</span> <span class="n">dataset_region</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;apex&#39;</span><span class="p">,</span> <span class="s1">&#39;cone&#39;</span><span class="p">):</span>
                <span class="c1"># Get strain path type</span>
                <span class="n">strain_path_type</span> <span class="o">=</span> <span class="n">strain_path_type_region</span><span class="p">[</span><span class="n">dataset_region</span><span class="p">]</span>
                <span class="c1"># Get number of strain-stress paths</span>
                <span class="n">n_path</span> <span class="o">=</span> <span class="n">n_path_region</span><span class="p">[</span><span class="n">dataset_region</span><span class="p">]</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Check number of strain-stress paths</span>
                <span class="k">if</span> <span class="n">n_path</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Get strain path generators parameters</span>
                <span class="n">strain_path_kwargs</span> <span class="o">=</span> <span class="n">strain_path_kwargs_type</span><span class="p">[</span><span class="n">strain_path_type</span><span class="p">]</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Set strain bounds according with data set strain region</span>
                <span class="k">if</span> <span class="n">dataset_region</span> <span class="o">==</span> <span class="s1">&#39;apex&#39;</span><span class="p">:</span>
                    <span class="c1"># Set strain components bounds</span>
                    <span class="n">strain_bounds</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">strain_comps_order</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                            <span class="n">strain_bounds</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">strain_bounds</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">dataset_region</span> <span class="o">==</span> <span class="s1">&#39;cone&#39;</span><span class="p">:</span>
                    <span class="c1"># Set strain components bounds</span>
                    <span class="n">strain_bounds</span> <span class="o">=</span> \
                        <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">strain_comps_order</span><span class="p">}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Unknown data set type.&#39;</span><span class="p">)</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Override strain bounds</span>
                <span class="n">strain_path_kwargs</span><span class="p">[</span><span class="s1">&#39;strain_bounds&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strain_bounds</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Generate data set</span>
                <span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset_generator</span><span class="o">.</span><span class="n">generate_response_dataset</span><span class="p">(</span>
                    <span class="n">n_path</span><span class="p">,</span> <span class="n">strain_path_type</span><span class="p">,</span> <span class="n">strain_path_kwargs</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span>
                    <span class="n">model_parameters</span><span class="p">,</span> <span class="n">state_features</span><span class="o">=</span><span class="n">state_features</span><span class="p">,</span>
                    <span class="n">is_in_memory_dataset</span><span class="o">=</span><span class="n">is_in_memory_dataset</span><span class="p">,</span>
                    <span class="n">dataset_directory</span><span class="o">=</span><span class="n">dataset_directory</span><span class="p">,</span>
                    <span class="n">dataset_basename</span><span class="o">=</span><span class="n">dataset_basename</span><span class="p">,</span> <span class="n">is_verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
                <span class="c1"># Store data set</span>
                <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Unknown data sets option.&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Get joint data set</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Pick single data set</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Concatenate multiple data sets</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ConcatDataset</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span>
            <span class="c1"># Shuffle concatenated data set samples</span>
            <span class="k">if</span> <span class="n">is_shuffle_dataset_samples</span><span class="p">:</span>
                <span class="c1"># Get shuffle concatenated data set samples indices</span>
                <span class="n">shuffled_indices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randperm</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="c1"># Get concatenated data set with shuffled samples</span>
                <span class="n">dataset</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Subset</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">shuffled_indices</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Save data set</span>
        <span class="n">save_dataset</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">dataset_basename</span><span class="p">,</span> <span class="n">dataset_directory</span><span class="p">,</span>
                     <span class="n">is_append_n_sample</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Generate plots</span>
        <span class="k">if</span> <span class="n">is_save_dataset_plots</span><span class="p">:</span>
            <span class="c1"># Set data set plots directory</span>
            <span class="n">plots_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dataset_directory</span><span class="p">,</span> <span class="s1">&#39;plots&#39;</span><span class="p">)</span>
            <span class="c1"># Create plots directory</span>
            <span class="n">plots_dir</span> <span class="o">=</span> <span class="n">make_directory</span><span class="p">(</span><span class="n">plots_dir</span><span class="p">)</span>
            <span class="c1"># Generate data set plots</span>
            <span class="n">generate_dataset_plots</span><span class="p">(</span><span class="n">strain_formulation</span><span class="p">,</span> <span class="n">n_dim</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span>
                                   <span class="n">save_dir</span><span class="o">=</span><span class="n">plots_dir</span><span class="p">,</span> <span class="n">is_save_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="n">is_stdout_display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Bernardo Ferreira.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>