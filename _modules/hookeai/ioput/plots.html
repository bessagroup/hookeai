<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>hookeai.ioput.plots &mdash; hookeai 1.0.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/readthedocs-custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            hookeai
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/getting_started/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/getting_started/installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/features/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/features/data_generation.html">Data generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/features/material_models.html">Material model architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/features/local_model_updating.html">Local material model updating</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/features/global_model_updating.html">Global material model updating</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/features/data_analysis.html">Data analysis and visualization tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/features/tensor_matrix.html">Tensorial algebra and matrix operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rst_doc_files/features/other.html">Other utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../_autosummary/hookeai.html">Code</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">License</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">MIT License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">hookeai</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">hookeai.ioput.plots</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for hookeai.ioput.plots</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;General plotting tools.</span>

<span class="sd">Functions</span>
<span class="sd">---------</span>
<span class="sd">plot_xy_data</span>
<span class="sd">    Plot data in xy axes.</span>
<span class="sd">plot_xy2_data</span>
<span class="sd">    Plot data in xy axes with two y axes.</span>
<span class="sd">plot_xny_data</span>
<span class="sd">    Plot data in xy axes with given range of y-values for each x-value.</span>
<span class="sd">plot_xyz_data</span>
<span class="sd">    Plot data in xyz axes.</span>
<span class="sd">plot_surface_xyz_data</span>
<span class="sd">    Plot surface data in xyz axes.</span>
<span class="sd">scatter_xy_data</span>
<span class="sd">    Scatter data in xy axes.</span>
<span class="sd">scatter_xny_data</span>
<span class="sd">    Scatter data in xy axes with given range of y-values for each x-value.</span>
<span class="sd">grouped_bar_chart</span>
<span class="sd">    Plot grouped bar chart.</span>
<span class="sd">plot_boxplots</span>
<span class="sd">    Plot set of box plots.</span>
<span class="sd">plot_histogram</span>
<span class="sd">    Plot 1D histogram.</span>
<span class="sd">plot_histogram_2d</span>
<span class="sd">    Plot 2D histogram.</span>
<span class="sd">save_figure</span>
<span class="sd">    Save Matplotlib figure.</span>
<span class="sd">tex_str</span>
<span class="sd">    Format string according with LaTeX rendering option.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#</span>
<span class="c1">#                                                                       Modules</span>
<span class="c1"># =============================================================================</span>
<span class="c1"># Standard</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="c1"># Third-party</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.ticker</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ticker</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cycler</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sklearn.linear_model</span>
<span class="c1">#</span>
<span class="c1">#                                                          Authorship &amp; Credits</span>
<span class="c1"># =============================================================================</span>
<span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;Bernardo Ferreira (bernardo_ferreira@brown.edu)&#39;</span>
<span class="n">__credits__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Bernardo Ferreira&#39;</span><span class="p">,</span> <span class="p">]</span>
<span class="n">__status__</span> <span class="o">=</span> <span class="s1">&#39;Stable&#39;</span>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="plot_xy_data"><a class="viewcode-back" href="../../../_autosummary/hookeai.ioput.plots.plot_xy_data.html#hookeai.ioput.plots.plot_xy_data">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">plot_xy_data</span><span class="p">(</span><span class="n">data_xy</span><span class="p">,</span> <span class="n">data_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_reference_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">x_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">y_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">x_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                 <span class="n">y_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">x_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">markeredgewidth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_latex</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot data in xy axes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_xy : numpy.ndarray(2d)</span>
<span class="sd">        Data array where the plot data is stored columnwise such that the i-th</span>
<span class="sd">        data set (x_i, y_i) is stored in columns (2*i, 2*i + 1), respectively.</span>
<span class="sd">    data_labels : list, default=None</span>
<span class="sd">        Labels of data sets (x_i, y_i) provided in data_xy and sorted</span>
<span class="sd">        accordingly. If None, then no labels are displayed.</span>
<span class="sd">    is_reference_data : bool, default=False</span>
<span class="sd">        If True, then the first data set is assumed to be the reference and is</span>
<span class="sd">        formatted independently (black, dashed, on top).</span>
<span class="sd">    x_lims : tuple, default=(None, None)</span>
<span class="sd">        x-axis limits in data coordinates.</span>
<span class="sd">    y_lims : tuple, default=(None, None)</span>
<span class="sd">        y-axis limits in data coordinates.</span>
<span class="sd">    title : str, default=None</span>
<span class="sd">        Plot title.</span>
<span class="sd">    x_label : str, default=None</span>
<span class="sd">        x-axis label.</span>
<span class="sd">    y_label : str, default=None</span>
<span class="sd">        y-axis label.</span>
<span class="sd">    x_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        x-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any x-axis ticks formatting.</span>
<span class="sd">    y_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        y-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any y-axis ticks formatting.</span>
<span class="sd">    x_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        x-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    y_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        y-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    marker : str, default=None</span>
<span class="sd">        Marker type.</span>
<span class="sd">    markersize : float, default=None</span>
<span class="sd">        Marker size in points.</span>
<span class="sd">    markeredgecolor : float, default=None</span>
<span class="sd">        Marker edge color.</span>
<span class="sd">    markeredgewidth : float, default=None</span>
<span class="sd">        Marker edge width in points.</span>
<span class="sd">    is_latex : bool, default=False</span>
<span class="sd">        If True, then render all strings in LaTeX. If LaTex is not available,</span>
<span class="sd">        then this option is silently set to False and all input strings are</span>
<span class="sd">        processed to remove $(...)$ enclosure.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    figure : Matplotlib Figure</span>
<span class="sd">        Figure.</span>
<span class="sd">    axes : Matplotlib Axes</span>
<span class="sd">        Axes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Reset matplotlib internal default style</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParamsDefault</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check data</span>
    <span class="k">if</span> <span class="n">data_xy</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Data array must have an even number of columns, &#39;</span>
                           <span class="s1">&#39;two for each dataset (x_i, y_i).&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Get number of data sets</span>
        <span class="n">n_datasets</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data_xy</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check datasets labels</span>
    <span class="k">if</span> <span class="n">data_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_labels</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_datasets</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Number of data set labels is not consistent &#39;</span>
                               <span class="s1">&#39;with number of data sets.&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_labels</span> <span class="o">=</span> <span class="n">n_datasets</span><span class="o">*</span><span class="p">[</span><span class="kc">None</span><span class="p">,]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set default color cycle</span>
    <span class="n">cycler_color</span> <span class="o">=</span> <span class="n">cycler</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,[</span><span class="s1">&#39;#4477AA&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE6677&#39;</span><span class="p">,</span> <span class="s1">&#39;#228833&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CCBB44&#39;</span><span class="p">,</span> <span class="s1">&#39;#66CCEE&#39;</span><span class="p">,</span> <span class="s1">&#39;#AA3377&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#BBBBBB&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE7733&#39;</span><span class="p">,</span> <span class="s1">&#39;#009988&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CC3311&#39;</span><span class="p">,</span> <span class="s1">&#39;#DDAA33&#39;</span><span class="p">,</span> <span class="s1">&#39;#999933&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#DDCC77&#39;</span><span class="p">,</span> <span class="s1">&#39;#882255&#39;</span><span class="p">])</span>
    <span class="c1"># Set default linestyle cycle</span>
    <span class="n">cycler_linestyle</span> <span class="o">=</span> <span class="n">cycler</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;linestyle&#39;</span><span class="p">,[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;-.&#39;</span><span class="p">])</span>
    <span class="c1"># Set default cycler</span>
    <span class="n">default_cycler</span> <span class="o">=</span> <span class="n">cycler_linestyle</span><span class="o">*</span><span class="n">cycler_color</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">prop_cycle</span> <span class="o">=</span> <span class="n">default_cycler</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    </span>
    <span class="c1"># Check LaTeX availability</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;latex&#39;</span><span class="p">)):</span>
        <span class="n">is_latex</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># Set LaTeX font</span>
    <span class="k">if</span> <span class="n">is_latex</span><span class="p">:</span>
        <span class="c1"># Default LaTeX Computer Modern Roman</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;serif&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Computer Modern Roman&#39;</span><span class="p">]})</span>        
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create figure</span>
    <span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="c1"># Set figure size (inches) - stdout print purpose</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create axes</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Set title</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># Set axes labels</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set axes scales</span>
    <span class="k">if</span> <span class="n">x_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">x_scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">y_scale</span><span class="p">)</span>
    <span class="c1"># Set tick formatting functions</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">intTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:2d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">floatTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:3.1f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">expTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:7.2e}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">tick_formats</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;int&#39;</span><span class="p">:</span> <span class="n">intTickFormat</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="n">floatTickFormat</span><span class="p">,</span>
                    <span class="s1">&#39;exp&#39;</span><span class="p">:</span> <span class="n">expTickFormat</span><span class="p">}</span>
    <span class="c1"># Set axes tick formats</span>
    <span class="k">if</span> <span class="n">x_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">x_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">x_tick_format</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">y_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">y_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">y_tick_format</span><span class="p">]))</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Configure grid major lines</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1"># Configure grid minor lines</span>
    <span class="n">axis_option</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;log-log&#39;</span><span class="p">:</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="s1">&#39;log-linear&#39;</span><span class="p">:</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;linear-log&#39;</span><span class="p">:</span> <span class="s1">&#39;y&#39;</span><span class="p">}</span>
    <span class="n">xy_scale</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x_scale</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y_scale</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">if</span> <span class="n">xy_scale</span> <span class="ow">in</span> <span class="n">axis_option</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis_option</span><span class="p">[</span><span class="n">xy_scale</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                  <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Loop over data sets</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_datasets</span><span class="p">):</span>
        <span class="c1"># Plot reference data set</span>
        <span class="k">if</span> <span class="n">is_reference_data</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">],</span> <span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
                      <span class="n">label</span><span class="o">=</span><span class="n">tex_str</span><span class="p">(</span><span class="n">data_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">is_latex</span><span class="p">),</span>
                      <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">,</span>
                      <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="c1"># Plot data set</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">],</span> <span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
                  <span class="n">label</span><span class="o">=</span><span class="n">tex_str</span><span class="p">(</span><span class="n">data_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">is_latex</span><span class="p">),</span>
                  <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">,</span>
                  <span class="n">markeredgecolor</span><span class="o">=</span><span class="n">markeredgecolor</span><span class="p">,</span>
                  <span class="n">markeredgewidth</span><span class="o">=</span><span class="n">markeredgewidth</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set legend</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_labels</span><span class="p">]):</span>
        <span class="c1"># Set legend position and number of columns</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;best&#39;</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;best&#39;</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1"># Plot legend</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;inherit&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;inherit&#39;</span><span class="p">,</span>
                             <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="n">legend</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set axes limits</span>
    <span class="k">if</span> <span class="n">x_lims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_lims</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y_lims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lims</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Return figure and axes handlers</span>
    <span class="k">return</span> <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="plot_xy2_data"><a class="viewcode-back" href="../../../_autosummary/hookeai.ioput.plots.plot_xy2_data.html#hookeai.ioput.plots.plot_xy2_data">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">plot_xy2_data</span><span class="p">(</span><span class="n">data_xy1</span><span class="p">,</span> <span class="n">data_xy2</span><span class="p">,</span> <span class="n">x_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                  <span class="n">y1_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">y2_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">x_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y1_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y2_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                  <span class="n">y1_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">y2_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">x_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">y1_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y2_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_latex</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot data in xy axes with two y axes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_xy1 : numpy.ndarray(2d)</span>
<span class="sd">        Data array containing the plot data associated with the first y-axis</span>
<span class="sd">        stored columnwise as (x_i, y_i).</span>
<span class="sd">    data_xy2 : numpy.ndarray(2d)</span>
<span class="sd">        Data array containing the plot data associated with the second y-axis</span>
<span class="sd">        stored columnwise as (x_i, y_i).</span>
<span class="sd">    x_lims : tuple, default=(None, None)</span>
<span class="sd">        x-axis limits in data coordinates.</span>
<span class="sd">    y1_lims : tuple, default=(None, None)</span>
<span class="sd">        y1-axis limits in data coordinates.</span>
<span class="sd">    y2_lims : tuple, default=(None, None)</span>
<span class="sd">        y2-axis limits in data coordinates.</span>
<span class="sd">    title : str, default=None</span>
<span class="sd">        Plot title.</span>
<span class="sd">    x_label : str, default=None</span>
<span class="sd">        x-axis label.</span>
<span class="sd">    y1_label : str, default=None</span>
<span class="sd">        y1-axis label.</span>
<span class="sd">    y2_label : str, default=None</span>
<span class="sd">        y2-axis label.</span>
<span class="sd">    x_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        x-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any x-axis ticks formatting.</span>
<span class="sd">    y1_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        y1-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any y1-axis ticks formatting.</span>
<span class="sd">    y2_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        y2-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any y2-axis ticks formatting.</span>
<span class="sd">    x_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        x-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    y1_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        y1-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    y2_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        y2-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    is_latex : bool, default=False</span>
<span class="sd">        If True, then render all strings in LaTeX. If LaTex is not available,</span>
<span class="sd">        then this option is silently set to False and all input strings are</span>
<span class="sd">        processed to remove $(...)$ enclosure.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    figure : Matplotlib Figure</span>
<span class="sd">        Figure.</span>
<span class="sd">    axes : Matplotlib Axes</span>
<span class="sd">        Axes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Reset matplotlib internal default style</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParamsDefault</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check data</span>
    <span class="k">if</span> <span class="n">data_xy1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Data array for first y-axis dataset must have &#39;</span>
                           <span class="s1">&#39;shape (n_points, 2).&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data_xy2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Data array for second y-axis dataset must have &#39;</span>
                           <span class="s1">&#39;shape (n_points, 2).&#39;</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set default color cycle</span>
    <span class="n">cycler_color</span> <span class="o">=</span> <span class="n">cycler</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,[</span><span class="s1">&#39;#4477AA&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE6677&#39;</span><span class="p">,</span> <span class="s1">&#39;#228833&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CCBB44&#39;</span><span class="p">,</span> <span class="s1">&#39;#66CCEE&#39;</span><span class="p">,</span> <span class="s1">&#39;#AA3377&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#BBBBBB&#39;</span><span class="p">])</span>
    <span class="c1"># Set default linestyle cycle</span>
    <span class="n">cycler_linestyle</span> <span class="o">=</span> <span class="n">cycler</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;linestyle&#39;</span><span class="p">,[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;-.&#39;</span><span class="p">])</span>
    <span class="c1"># Set default cycler</span>
    <span class="n">default_cycler</span> <span class="o">=</span> <span class="n">cycler_linestyle</span><span class="o">*</span><span class="n">cycler_color</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">prop_cycle</span> <span class="o">=</span> <span class="n">default_cycler</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check LaTeX availability</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;latex&#39;</span><span class="p">)):</span>
        <span class="n">is_latex</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># Set LaTeX font</span>
    <span class="k">if</span> <span class="n">is_latex</span><span class="p">:</span>
        <span class="c1"># Default LaTeX Computer Modern Roman</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;serif&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Computer Modern Roman&#39;</span><span class="p">]})</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create figure</span>
    <span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="c1"># Set figure size (inches) - stdout print purpose</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create first axes</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Set first axes color</span>
    <span class="n">color_y1</span> <span class="o">=</span> <span class="s1">&#39;#4477AA&#39;</span>
    <span class="c1"># Set title</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># Set first axes labels</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">y1_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">color_y1</span><span class="p">)</span>
    <span class="c1"># Set first axes color</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">color_y1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create second axes (sharing the x axis)</span>
    <span class="n">axes2</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="c1"># Set second axes color</span>
    <span class="n">color_y2</span> <span class="o">=</span> <span class="s1">&#39;#EE6677&#39;</span>
    <span class="c1"># Configure second axes label</span>
    <span class="n">axes2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">y2_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                     <span class="n">color</span><span class="o">=</span><span class="n">color_y2</span><span class="p">)</span>
    <span class="c1"># Set second axes color</span>
    <span class="n">axes2</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axes2</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">color_y2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set first axes color</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_y1</span><span class="p">,</span>
                     <span class="n">labelcolor</span><span class="o">=</span><span class="n">color_y1</span><span class="p">)</span>
    <span class="c1"># Set first axes scales</span>
    <span class="k">if</span> <span class="n">x_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">x_scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y1_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">y1_scale</span><span class="p">)</span>
    <span class="c1"># Set tick formatting functions</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">intTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:2d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">floatTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:3.1f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">expTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:7.2e}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">tick_formats</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;int&#39;</span><span class="p">:</span> <span class="n">intTickFormat</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="n">floatTickFormat</span><span class="p">,</span>
                    <span class="s1">&#39;exp&#39;</span><span class="p">:</span> <span class="n">expTickFormat</span><span class="p">}</span>
    <span class="c1"># Set axes tick formats</span>
    <span class="k">if</span> <span class="n">x_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">x_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">x_tick_format</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">y1_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">y1_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">y1_tick_format</span><span class="p">]))</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set second axes color</span>
    <span class="n">axes2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_y2</span><span class="p">,</span>
                      <span class="n">labelcolor</span><span class="o">=</span><span class="n">color_y2</span><span class="p">)</span>
    <span class="c1"># Set second axes scales</span>
    <span class="k">if</span> <span class="n">y2_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">y2_scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y2_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">y2_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">y2_tick_format</span><span class="p">]))</span>    
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Configure grid major lines</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1"># Configure grid minor lines</span>
    <span class="n">axis_option</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;log-log&#39;</span><span class="p">:</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="s1">&#39;log-linear&#39;</span><span class="p">:</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;linear-log&#39;</span><span class="p">:</span> <span class="s1">&#39;y&#39;</span><span class="p">}</span>
    <span class="n">xy_scale</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x_scale</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y1_scale</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">if</span> <span class="n">xy_scale</span> <span class="ow">in</span> <span class="n">axis_option</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis_option</span><span class="p">[</span><span class="n">xy_scale</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                  <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Plot dataset in first axes</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_xy1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">data_xy1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color_y1</span><span class="p">)</span>
    <span class="c1"># Plot dataset in second axes</span>
    <span class="n">axes2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_xy2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">data_xy2</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color_y2</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set first axes limits</span>
    <span class="k">if</span> <span class="n">x_lims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_lims</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y1_lims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y1_lims</span><span class="p">)</span>
    <span class="c1"># Set second axes limits</span>
    <span class="k">if</span> <span class="n">y2_lims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">axes2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y2_lims</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Return figure and axes handlers</span>
    <span class="k">return</span> <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="plot_xny_data"><a class="viewcode-back" href="../../../_autosummary/hookeai.ioput.plots.plot_xny_data.html#hookeai.ioput.plots.plot_xny_data">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">plot_xny_data</span><span class="p">(</span><span class="n">data_xy_list</span><span class="p">,</span> <span class="n">range_type</span><span class="o">=</span><span class="s1">&#39;min-max&#39;</span><span class="p">,</span> <span class="n">is_error_bar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">is_error_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">data_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">is_reference_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">x_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                  <span class="n">y_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">x_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">y_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">x_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">y_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_latex</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot data in xy axes with given range of y-values for each x-value.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_xy_list : list[np.ndarray(2d)]</span>
<span class="sd">        List of data arrays. Each data array contains plot data stored</span>
<span class="sd">        columnwise such that data_array[:, 0] holds the x-axis data and</span>
<span class="sd">        data_array[:, 1:] holds the y-axis data.</span>
<span class="sd">    range_type : {&#39;min-max&#39;, &#39;mean-std&#39;, None}, default=&#39;min-max&#39;</span>
<span class="sd">        Type of range of y-values to be plotted for each x-value around the</span>
<span class="sd">        mean. If None, only the mean is plotted.</span>
<span class="sd">    is_error_bar : bool, default=True</span>
<span class="sd">        If True, then plot error bar according with range type.</span>
<span class="sd">    is_error_shading : bool, default=False,</span>
<span class="sd">        If True, then shade error according with range type.</span>
<span class="sd">    data_labels : list, default=None</span>
<span class="sd">        Labels of data arrays provided in data_xy_list and sorted accordingly.</span>
<span class="sd">        If None, then no labels are displayed.</span>
<span class="sd">    is_reference_data : bool, default=False</span>
<span class="sd">        If True, then the first data set is assumed to be the reference and is</span>
<span class="sd">        formatted independently (black, dashed, on top). Reference data is</span>
<span class="sd">        ignored for the range computation.</span>
<span class="sd">    x_lims : tuple, default=(None, None)</span>
<span class="sd">        x-axis limits in data coordinates.</span>
<span class="sd">    y_lims : tuple, default=(None, None)</span>
<span class="sd">        y-axis limits in data coordinates.</span>
<span class="sd">    title : str, default=None</span>
<span class="sd">        Plot title.</span>
<span class="sd">    x_label : str, default=None</span>
<span class="sd">        x-axis label.</span>
<span class="sd">    y_label : str, default=None</span>
<span class="sd">        y-axis label.</span>
<span class="sd">    x_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        x-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any x-axis ticks formatting.</span>
<span class="sd">    y_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        y-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any y-axis ticks formatting.</span>
<span class="sd">    x_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        x-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    y_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        y-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    is_latex : bool, default=False</span>
<span class="sd">        If True, then render all strings in LaTeX. If LaTex is not available,</span>
<span class="sd">        then this option is silently set to False and all input strings are</span>
<span class="sd">        processed to remove $(...)$ enclosure.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    figure : Matplotlib Figure</span>
<span class="sd">        Figure.</span>
<span class="sd">    axes : Matplotlib Axes</span>
<span class="sd">        Axes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Reset matplotlib internal default style</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParamsDefault</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check data</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_xy_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Data must be provided as a list of data arrays &#39;</span>
                           <span class="s1">&#39;stored as numpy.ndarray(2d).&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_xy_list</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Data must be provided as a list of data arrays &#39;</span>
                           <span class="s1">&#39;stored as numpy.ndarray(2d).&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_xy_list</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Data must be provided as a list of data arrays &#39;</span>
                           <span class="s1">&#39;stored as numpy.ndarray(2d).&#39;</span><span class="p">)</span>
    <span class="c1"># Get number of data sets</span>
    <span class="n">n_datasets</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_xy_list</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check datasets labels</span>
    <span class="k">if</span> <span class="n">data_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_labels</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_datasets</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Number of data set labels is not consistent &#39;</span>
                               <span class="s1">&#39;with list of data arrays.&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_labels</span> <span class="o">=</span> <span class="n">n_datasets</span><span class="o">*</span><span class="p">[</span><span class="kc">None</span><span class="p">,]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set default color cycle</span>
    <span class="n">cycler_color</span> <span class="o">=</span> <span class="n">cycler</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,[</span><span class="s1">&#39;#4477AA&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE6677&#39;</span><span class="p">,</span> <span class="s1">&#39;#228833&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CCBB44&#39;</span><span class="p">,</span> <span class="s1">&#39;#66CCEE&#39;</span><span class="p">,</span> <span class="s1">&#39;#AA3377&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#BBBBBB&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE7733&#39;</span><span class="p">,</span> <span class="s1">&#39;#009988&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CC3311&#39;</span><span class="p">,</span> <span class="s1">&#39;#DDAA33&#39;</span><span class="p">,</span> <span class="s1">&#39;#999933&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#DDCC77&#39;</span><span class="p">,</span> <span class="s1">&#39;#882255&#39;</span><span class="p">])</span>
    <span class="c1"># Set default linestyle cycle</span>
    <span class="n">cycler_linestyle</span> <span class="o">=</span> <span class="n">cycler</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;linestyle&#39;</span><span class="p">,[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;-.&#39;</span><span class="p">])</span>
    <span class="c1"># Set default cycler</span>
    <span class="n">default_cycler</span> <span class="o">=</span> <span class="n">cycler_linestyle</span><span class="o">*</span><span class="n">cycler_color</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">prop_cycle</span> <span class="o">=</span> <span class="n">default_cycler</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check LaTeX availability</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;latex&#39;</span><span class="p">)):</span>
        <span class="n">is_latex</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># Set LaTeX font</span>
    <span class="k">if</span> <span class="n">is_latex</span><span class="p">:</span>
        <span class="c1"># Default LaTeX Computer Modern Roman</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;serif&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Computer Modern Roman&#39;</span><span class="p">]})</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create figure</span>
    <span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="c1"># Set figure size (inches) - stdout print purpose</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create axes</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Set title</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># Set axes labels</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set axes scales</span>
    <span class="k">if</span> <span class="n">x_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">x_scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">y_scale</span><span class="p">)</span>
    <span class="c1"># Set tick formatting functions</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">intTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:2d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">floatTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:3.1f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">expTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:7.2e}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">tick_formats</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;int&#39;</span><span class="p">:</span> <span class="n">intTickFormat</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="n">floatTickFormat</span><span class="p">,</span>
                    <span class="s1">&#39;exp&#39;</span><span class="p">:</span> <span class="n">expTickFormat</span><span class="p">}</span>
    <span class="c1"># Set axes tick formats</span>
    <span class="k">if</span> <span class="n">x_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">x_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">x_tick_format</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">y_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">y_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">y_tick_format</span><span class="p">]))</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Configure grid major lines</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1"># Configure grid minor lines</span>
    <span class="n">axis_option</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;log-log&#39;</span><span class="p">:</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="s1">&#39;log-linear&#39;</span><span class="p">:</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;linear-log&#39;</span><span class="p">:</span> <span class="s1">&#39;y&#39;</span><span class="p">}</span>
    <span class="n">xy_scale</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x_scale</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y_scale</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">if</span> <span class="n">xy_scale</span> <span class="ow">in</span> <span class="n">axis_option</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis_option</span><span class="p">[</span><span class="n">xy_scale</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                  <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Loop over data sets</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_datasets</span><span class="p">):</span>
        <span class="c1"># Get data array</span>
        <span class="n">data_xy</span> <span class="o">=</span> <span class="n">data_xy_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Plot data</span>
        <span class="k">if</span> <span class="n">is_reference_data</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Plot reference data set</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">],</span> <span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
                      <span class="n">label</span><span class="o">=</span><span class="n">tex_str</span><span class="p">(</span><span class="n">data_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">is_latex</span><span class="p">),</span>
                      <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Get x-values</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="c1"># Get y-values mean</span>
            <span class="n">y_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Get y-values range</span>
            <span class="k">if</span> <span class="n">range_type</span> <span class="o">==</span> <span class="s1">&#39;min-max&#39;</span><span class="p">:</span>
                <span class="c1"># Set lower and upper errors: [|mean - min|, |mean - max|]</span>
                <span class="n">y_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">y_mean</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:],</span>
                                                 <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                     <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">y_mean</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:],</span>
                                                 <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))),</span>
                    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">range_type</span> <span class="o">==</span> <span class="s1">&#39;mean-std&#39;</span><span class="p">:</span>
                <span class="c1"># Set lower and upper errors: [1.96*std, 1.96*std]</span>
                <span class="n">y_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                    <span class="p">(</span><span class="mf">1.96</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
                                 <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                     <span class="mf">1.96</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
                                 <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Skip range computation</span>
                <span class="n">y_err</span> <span class="o">=</span> <span class="kc">None</span>                
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Set plot formatting</span>
            <span class="k">if</span> <span class="n">is_error_bar</span> <span class="ow">and</span> <span class="n">y_err</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;-o&#39;</span>
                <span class="n">yerr</span> <span class="o">=</span> <span class="n">y_err</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
                <span class="n">yerr</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Plot data mean and error bar</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_mean</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">yerr</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                          <span class="n">capsize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">tex_str</span><span class="p">(</span><span class="n">data_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">is_latex</span><span class="p">))</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Plot data error shaded area</span>
            <span class="k">if</span> <span class="n">is_error_shading</span> <span class="ow">and</span> <span class="n">y_err</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
                                  <span class="p">(</span><span class="n">y_mean</span> <span class="o">-</span> <span class="n">y_err</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
                                  <span class="p">(</span><span class="n">y_mean</span> <span class="o">+</span> <span class="n">y_err</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
                                  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set legend</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_labels</span><span class="p">]):</span>
        <span class="c1"># Set legend position and number of columns</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;best&#39;</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;best&#39;</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1"># Plot legend</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;inherit&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;inherit&#39;</span><span class="p">,</span>
                             <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="n">legend</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set axes limits</span>
    <span class="k">if</span> <span class="n">x_lims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_lims</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y_lims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lims</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Return figure and axes handlers</span>
    <span class="k">return</span> <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="plot_xyz_data"><a class="viewcode-back" href="../../../_autosummary/hookeai.ioput.plots.plot_xyz_data.html#hookeai.ioput.plots.plot_xyz_data">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">plot_xyz_data</span><span class="p">(</span><span class="n">data_xyz</span><span class="p">,</span> <span class="n">data_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                  <span class="n">y_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">z_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">x_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">x_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">y_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">z_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                  <span class="n">x_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">view_angles_deg</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">is_latex</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot data in xyz axes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_xyz : numpy.ndarray(2d)</span>
<span class="sd">        Data array where the plot data is stored columnwise such that the i-th</span>
<span class="sd">        data set (x_i, y_i, z_i) is stored in columns (3*i, 3*i + 1, 3*i + 2),</span>
<span class="sd">        respectively.</span>
<span class="sd">    data_labels : list, default=None</span>
<span class="sd">        Labels of data sets (x_i, y_i, z_i) provided in data_xyz and sorted</span>
<span class="sd">        accordingly. If None, then no labels are displayed.</span>
<span class="sd">    x_lims : tuple, default=(None, None)</span>
<span class="sd">        x-axis limits in data coordinates.</span>
<span class="sd">    y_lims : tuple, default=(None, None)</span>
<span class="sd">        y-axis limits in data coordinates.</span>
<span class="sd">    z_lims : tuple, default=(None, None)</span>
<span class="sd">        z-axis limits in data coordinates.</span>
<span class="sd">    title : str, default=None</span>
<span class="sd">        Plot title.</span>
<span class="sd">    x_label : str, default=None</span>
<span class="sd">        x-axis label.</span>
<span class="sd">    y_label : str, default=None</span>
<span class="sd">        y-axis label.</span>
<span class="sd">    z_label : str, default=None</span>
<span class="sd">        z-axis label.</span>
<span class="sd">    x_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        x-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any x-axis ticks formatting.</span>
<span class="sd">    y_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        y-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any y-axis ticks formatting.</span>
<span class="sd">    z_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        z-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any y-axis ticks formatting.</span>
<span class="sd">    x_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        x-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    y_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        y-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    z_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        z-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    view_angles_deg : tuple[float], default=(30, 30, 0)</span>
<span class="sd">        Elevation (0), aximuth (1) and roll angles (2) that define the view</span>
<span class="sd">        angle of the 3D plot (defined in degrees).</span>
<span class="sd">    marker : str, default=None</span>
<span class="sd">        Marker type.</span>
<span class="sd">    markersize : float, default=None</span>
<span class="sd">        Marker size in points.</span>
<span class="sd">    is_latex : bool, default=False</span>
<span class="sd">        If True, then render all strings in LaTeX. If LaTex is not available,</span>
<span class="sd">        then this option is silently set to False and all input strings are</span>
<span class="sd">        processed to remove $(...)$ enclosure.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    figure : Matplotlib Figure</span>
<span class="sd">        Figure.</span>
<span class="sd">    axes : Matplotlib Axes</span>
<span class="sd">        Axes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Reset matplotlib internal default style</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParamsDefault</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check data</span>
    <span class="k">if</span> <span class="n">data_xyz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Data array must have an even number of columns, &#39;</span>
                           <span class="s1">&#39;two for each dataset (x_i, y_i, z_i).&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Get number of data sets</span>
        <span class="n">n_datasets</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data_xyz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check datasets labels</span>
    <span class="k">if</span> <span class="n">data_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_labels</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_datasets</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Number of data set labels is not consistent &#39;</span>
                               <span class="s1">&#39;with number of data sets.&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_labels</span> <span class="o">=</span> <span class="n">n_datasets</span><span class="o">*</span><span class="p">[</span><span class="kc">None</span><span class="p">,]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set default color cycle</span>
    <span class="n">cycler_color</span> <span class="o">=</span> <span class="n">cycler</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,[</span><span class="s1">&#39;#4477AA&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE6677&#39;</span><span class="p">,</span> <span class="s1">&#39;#228833&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CCBB44&#39;</span><span class="p">,</span> <span class="s1">&#39;#66CCEE&#39;</span><span class="p">,</span> <span class="s1">&#39;#AA3377&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#BBBBBB&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE7733&#39;</span><span class="p">,</span> <span class="s1">&#39;#009988&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CC3311&#39;</span><span class="p">,</span> <span class="s1">&#39;#DDAA33&#39;</span><span class="p">,</span> <span class="s1">&#39;#999933&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#DDCC77&#39;</span><span class="p">,</span> <span class="s1">&#39;#882255&#39;</span><span class="p">])</span>
    <span class="c1"># Set default linestyle cycle</span>
    <span class="n">cycler_linestyle</span> <span class="o">=</span> <span class="n">cycler</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;linestyle&#39;</span><span class="p">,[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;-.&#39;</span><span class="p">])</span>
    <span class="c1"># Set default cycler</span>
    <span class="n">default_cycler</span> <span class="o">=</span> <span class="n">cycler_linestyle</span><span class="o">*</span><span class="n">cycler_color</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">prop_cycle</span> <span class="o">=</span> <span class="n">default_cycler</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    </span>
    <span class="c1"># Check LaTeX availability</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;latex&#39;</span><span class="p">)):</span>
        <span class="n">is_latex</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># Set LaTeX font</span>
    <span class="k">if</span> <span class="n">is_latex</span><span class="p">:</span>
        <span class="c1"># Default LaTeX Computer Modern Roman</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;serif&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Computer Modern Roman&#39;</span><span class="p">]})</span>        
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create figure</span>
    <span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="c1"># Set figure size (inches) - stdout print purpose</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create axes</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="c1"># Set view angle</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="n">view_angles_deg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">azim</span><span class="o">=</span><span class="n">view_angles_deg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                   <span class="n">roll</span><span class="o">=</span><span class="n">view_angles_deg</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="c1"># Set zoom</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_box_aspect</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
    <span class="c1"># Set title</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># Set axes labels</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">z_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set axes scales</span>
    <span class="k">if</span> <span class="n">x_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">x_scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">y_scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">z_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_zscale</span><span class="p">(</span><span class="n">z_scale</span><span class="p">)</span>
    <span class="c1"># Set tick formatting functions</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">intTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:2d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">floatTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:3.1f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">expTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:7.2e}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">tick_formats</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;int&#39;</span><span class="p">:</span> <span class="n">intTickFormat</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="n">floatTickFormat</span><span class="p">,</span>
                    <span class="s1">&#39;exp&#39;</span><span class="p">:</span> <span class="n">expTickFormat</span><span class="p">}</span>
    <span class="c1"># Set axes tick formats</span>
    <span class="k">if</span> <span class="n">x_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">x_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">x_tick_format</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">y_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">y_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">y_tick_format</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">z_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">z_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">zaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">z_tick_format</span><span class="p">]))</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Configure grid major lines</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Loop over data sets</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_datasets</span><span class="p">):</span>
        <span class="c1"># Plot dataset</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_xyz</span><span class="p">[:,</span> <span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">],</span> <span class="n">data_xyz</span><span class="p">[:,</span> <span class="mi">3</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">data_xyz</span><span class="p">[:,</span> <span class="mi">3</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span>
                  <span class="n">label</span><span class="o">=</span><span class="n">tex_str</span><span class="p">(</span><span class="n">data_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">is_latex</span><span class="p">),</span>
                  <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set legend</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_labels</span><span class="p">]):</span>
        <span class="c1"># Set legend position and number of columns</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper center&#39;</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper left&#39;</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1"># Plot legend</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;inherit&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;inherit&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                    <span class="n">framealpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set axes limits</span>
    <span class="k">if</span> <span class="n">x_lims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_lims</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y_lims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lims</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">z_lims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="n">z_lims</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Return figure and axes handlers</span>
    <span class="k">return</span> <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="plot_surface_xyz_data"><a class="viewcode-back" href="../../../_autosummary/hookeai.ioput.plots.plot_surface_xyz_data.html#hookeai.ioput.plots.plot_surface_xyz_data">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">plot_surface_xyz_data</span><span class="p">(</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">y_mesh</span><span class="p">,</span> <span class="n">z_mesh</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
                          <span class="n">x_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">y_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                          <span class="n">z_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">x_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">x_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">z_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">view_angles_deg</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                          <span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_latex</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot surface data in xyz axes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x_mesh : numpy.ndarray(2d)</span>
<span class="sd">        Mesh grid x-coordinates.</span>
<span class="sd">    y_mesh : numpy.ndarray(2d)</span>
<span class="sd">        Mesh grid y-coordinates.</span>
<span class="sd">    z_mesh : numpy.ndarray(2d)</span>
<span class="sd">        Mesh grid z-coordinates.</span>
<span class="sd">    colormap : str, default=&#39;viridis&#39;</span>
<span class="sd">        Surface plot colormap.</span>
<span class="sd">    x_lims : tuple, default=(None, None)</span>
<span class="sd">        x-axis limits in data coordinates.</span>
<span class="sd">    y_lims : tuple, default=(None, None)</span>
<span class="sd">        y-axis limits in data coordinates.</span>
<span class="sd">    z_lims : tuple, default=(None, None)</span>
<span class="sd">        z-axis limits in data coordinates.</span>
<span class="sd">    title : str, default=None</span>
<span class="sd">        Plot title.</span>
<span class="sd">    x_label : str, default=None</span>
<span class="sd">        x-axis label.</span>
<span class="sd">    y_label : str, default=None</span>
<span class="sd">        y-axis label.</span>
<span class="sd">    z_label : str, default=None</span>
<span class="sd">        z-axis label.</span>
<span class="sd">    x_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        x-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    y_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        y-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    z_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        z-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    view_angles_deg : tuple[float], default=(30, 30, 0)</span>
<span class="sd">        Elevation (0), aximuth (1) and roll angles (2) that define the view</span>
<span class="sd">        angle of the 3D plot (defined in degrees).</span>
<span class="sd">    marker : str, default=None</span>
<span class="sd">        Marker type.</span>
<span class="sd">    markersize : float, default=None</span>
<span class="sd">        Marker size in points.</span>
<span class="sd">    is_latex : bool, default=False</span>
<span class="sd">        If True, then render all strings in LaTeX. If LaTex is not available,</span>
<span class="sd">        then this option is silently set to False and all input strings are</span>
<span class="sd">        processed to remove $(...)$ enclosure.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    figure : Matplotlib Figure</span>
<span class="sd">        Figure.</span>
<span class="sd">    axes : Matplotlib Axes</span>
<span class="sd">        Axes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Reset matplotlib internal default style</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParamsDefault</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check data</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_mesh</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_mesh</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> \
            <span class="nb">len</span><span class="p">(</span><span class="n">z_mesh</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Mesh grid data arrays must be provided as &#39;</span>
                           <span class="s1">&#39;numpy.ndarray(2d).&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">x_mesh</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">y_mesh</span><span class="o">.</span><span class="n">shape</span> <span class="ow">or</span> <span class="n">x_mesh</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">z_mesh</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Mesh grid data arrays must have the same shape.&#39;</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set surface colormap</span>
    <span class="k">if</span> <span class="n">colormap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Set default colormap</span>
        <span class="n">colormap</span> <span class="o">=</span> <span class="s1">&#39;viridis&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Check colormap</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colormap</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Colormap must be provided as a string.&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">colormap</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">plt</span><span class="o">.</span><span class="n">colormaps</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Colormap </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">colormap</span><span class="si">}</span><span class="se">\&#39;</span><span class="s1"> is not available. &#39;</span>
                               <span class="sa">f</span><span class="s1">&#39;Check available Matplotlib colormaps.&#39;</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    </span>
    <span class="c1"># Check LaTeX availability</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;latex&#39;</span><span class="p">)):</span>
        <span class="n">is_latex</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># Set LaTeX font</span>
    <span class="k">if</span> <span class="n">is_latex</span><span class="p">:</span>
        <span class="c1"># Default LaTeX Computer Modern Roman</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;serif&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Computer Modern Roman&#39;</span><span class="p">]})</span>        
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create figure</span>
    <span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="c1"># Set figure size (inches) - stdout print purpose</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create axes</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="c1"># Set view angle</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="n">view_angles_deg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">azim</span><span class="o">=</span><span class="n">view_angles_deg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                   <span class="n">roll</span><span class="o">=</span><span class="n">view_angles_deg</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="c1"># Set zoom</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_box_aspect</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
    <span class="c1"># Set title</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># Set axes labels</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">z_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set tick formatting functions</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">intTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:2d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">floatTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:3.1f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">expTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:7.2e}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">tick_formats</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;int&#39;</span><span class="p">:</span> <span class="n">intTickFormat</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="n">floatTickFormat</span><span class="p">,</span>
                    <span class="s1">&#39;exp&#39;</span><span class="p">:</span> <span class="n">expTickFormat</span><span class="p">}</span>
    <span class="c1"># Set axes tick formats</span>
    <span class="k">if</span> <span class="n">x_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">x_tick_format</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">y_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">y_tick_format</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">z_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">zaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">z_tick_format</span><span class="p">]))</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Configure grid major lines</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Plot surface data</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">y_mesh</span><span class="p">,</span> <span class="n">z_mesh</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
                      <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">shade</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Overlay mesh grid points</span>
    <span class="k">if</span> <span class="n">marker</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Set marker size</span>
        <span class="k">if</span> <span class="n">markersize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">markersize</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="c1"># Plot mesh grid points</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">y_mesh</span><span class="p">,</span> <span class="n">z_mesh</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">markersize</span><span class="p">,</span>
                     <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set axes limits</span>
    <span class="k">if</span> <span class="n">x_lims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_lims</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y_lims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lims</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">z_lims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="n">z_lims</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Return figure and axes handlers</span>
    <span class="k">return</span> <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="scatter_xy_data"><a class="viewcode-back" href="../../../_autosummary/hookeai.ioput.plots.scatter_xy_data.html#hookeai.ioput.plots.scatter_xy_data">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">scatter_xy_data</span><span class="p">(</span><span class="n">data_xy</span><span class="p">,</span> <span class="n">data_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_identity_line</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">identity_error</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_r2_coefficient</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">is_direct_loss_estimator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_marginal_dists</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">is_error_bar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">range_type</span><span class="o">=</span><span class="s1">&#39;min-max&#39;</span><span class="p">,</span>
                    <span class="n">x_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">y_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">x_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                    <span class="n">y_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">x_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">is_latex</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scatter data in xy axes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_xy : numpy.ndarray(2d)</span>
<span class="sd">        Data array where the plot data is stored columnwise such that the i-th</span>
<span class="sd">        data set (x_i, y_i) is stored in columns (2*i, 2*i + 1), respectively.</span>
<span class="sd">    data_labels : list, default=None</span>
<span class="sd">        Labels of data sets (x_i, y_i) provided in data_xy and sorted</span>
<span class="sd">        accordingly. If None, then no labels are displayed.</span>
<span class="sd">    is_identity_line : bool, default=False</span>
<span class="sd">        Plot identity line.</span>
<span class="sd">    identity_error : float, default=None</span>
<span class="sd">        Relative error between x-data and y-data defining a symmetric</span>
<span class="sd">        error-based shaded area with respect to the identity line.</span>
<span class="sd">    is_r2_coefficient : bool, default=False</span>
<span class="sd">        Plot coefficient of determination. Only effective if plotting a single</span>
<span class="sd">        data set: reference data stored in data_xy[:, 0] and prediction data</span>
<span class="sd">        stored in data_xy[:, 1].</span>
<span class="sd">    is_direct_loss_estimator : bool, default=False</span>
<span class="sd">        Plot Direct Loss Estimator (DLE) based on Linear Regression model.</span>
<span class="sd">        Only effective if plotting a single data set: reference data stored in</span>
<span class="sd">        data_xy[:, 0] and prediction data stored in data_xy[:, 1].</span>
<span class="sd">    is_marginal_dists : bool, default=False</span>
<span class="sd">        Plot marginal distributions along both dimensions. Multiple data sets</span>
<span class="sd">        are concatenated along each dimension.</span>
<span class="sd">    is_error_bar : bool, default=False</span>
<span class="sd">        If True, then plot error bar according with range type. Multiple data</span>
<span class="sd">        sets are concatenated and the x values are assumed common between all</span>
<span class="sd">        data sets. Data labels are suppressed.</span>
<span class="sd">    range_type : {&#39;min-max&#39;, &#39;mean-std&#39;, None}, default=&#39;min-max&#39;</span>
<span class="sd">        Type of range of y-values to be plotted for each x-value around the</span>
<span class="sd">        mean. If None, only the mean is plotted. Only effective if is_error_bar</span>
<span class="sd">        is set to True.</span>
<span class="sd">    x_lims : tuple, default=(None, None)</span>
<span class="sd">        x-axis limits in data coordinates.</span>
<span class="sd">    y_lims : tuple, default=(None, None)</span>
<span class="sd">        y-axis limits in data coordinates.</span>
<span class="sd">    title : str, default=None</span>
<span class="sd">        Plot title.</span>
<span class="sd">    x_label : str, default=None</span>
<span class="sd">        x-axis label.</span>
<span class="sd">    y_label : str, default=None</span>
<span class="sd">        y-axis label.</span>
<span class="sd">    x_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        x-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any x-axis ticks formatting.</span>
<span class="sd">    y_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        y-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any y-axis ticks formatting.</span>
<span class="sd">    x_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        x-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    y_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        y-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    is_latex : bool, default=False</span>
<span class="sd">        If True, then render all strings in LaTeX. If LaTex is not available,</span>
<span class="sd">        then this option is silently set to False and all input strings are</span>
<span class="sd">        processed to remove $(...)$ enclosure.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    figure : Matplotlib Figure</span>
<span class="sd">        Figure.</span>
<span class="sd">    axes : Matplotlib Axes</span>
<span class="sd">        Axes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Reset matplotlib internal default style</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParamsDefault</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check data</span>
    <span class="k">if</span> <span class="n">data_xy</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Data array must have an even number of columns, &#39;</span>
                           <span class="s1">&#39;two for each dataset (x_i, y_i).&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Get number of data sets</span>
        <span class="n">n_datasets</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data_xy</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check datasets labels</span>
    <span class="k">if</span> <span class="n">data_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_labels</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_datasets</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Number of data set labels is not consistent &#39;</span>
                               <span class="s1">&#39;with number of data sets.&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_labels</span> <span class="o">=</span> <span class="n">n_datasets</span><span class="o">*</span><span class="p">[</span><span class="kc">None</span><span class="p">,]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set default color cycle</span>
    <span class="n">cycler_color</span> <span class="o">=</span> <span class="n">cycler</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,[</span><span class="s1">&#39;#4477AA&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE6677&#39;</span><span class="p">,</span> <span class="s1">&#39;#228833&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CCBB44&#39;</span><span class="p">,</span> <span class="s1">&#39;#66CCEE&#39;</span><span class="p">,</span> <span class="s1">&#39;#AA3377&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#BBBBBB&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE7733&#39;</span><span class="p">,</span> <span class="s1">&#39;#009988&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CC3311&#39;</span><span class="p">,</span> <span class="s1">&#39;#DDAA33&#39;</span><span class="p">,</span> <span class="s1">&#39;#999933&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#DDCC77&#39;</span><span class="p">,</span> <span class="s1">&#39;#882255&#39;</span><span class="p">])</span>
    <span class="c1"># Set default linestyle cycle</span>
    <span class="n">cycler_linestyle</span> <span class="o">=</span> <span class="n">cycler</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;linestyle&#39;</span><span class="p">,[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;-.&#39;</span><span class="p">])</span>
    <span class="c1"># Set default cycler</span>
    <span class="n">default_cycler</span> <span class="o">=</span> <span class="n">cycler_linestyle</span><span class="o">*</span><span class="n">cycler_color</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">prop_cycle</span> <span class="o">=</span> <span class="n">default_cycler</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check LaTeX availability</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;latex&#39;</span><span class="p">)):</span>
        <span class="n">is_latex</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># Set LaTeX font</span>
    <span class="k">if</span> <span class="n">is_latex</span><span class="p">:</span>
        <span class="c1"># Default LaTeX Computer Modern Roman</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;serif&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Computer Modern Roman&#39;</span><span class="p">]})</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create figure</span>
    <span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="c1"># Set figure size (inches) - stdout print purpose</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create axes</span>
    <span class="k">if</span> <span class="n">is_marginal_dists</span><span class="p">:</span>
        <span class="c1"># Create grid layout to place subplots</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> 
                                 <span class="n">width_ratios</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                                 <span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
                                 <span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
        <span class="c1"># Set main axes</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="c1"># Set marginal distributions axes</span>
        <span class="n">axes_hist_x</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
        <span class="n">axes_hist_y</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">sharey</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
        <span class="c1"># Supress marginal distributions tick labels</span>
        <span class="n">axes_hist_x</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                                <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">axes_hist_y</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                                <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Set main axes</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set title</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># Set axes labels</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set axes scales</span>
    <span class="k">if</span> <span class="n">x_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">x_scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">y_scale</span><span class="p">)</span>
    <span class="c1"># Set tick formatting functions</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">intTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:2d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">floatTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:3.1f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">expTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:7.2e}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">tick_formats</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;int&#39;</span><span class="p">:</span> <span class="n">intTickFormat</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="n">floatTickFormat</span><span class="p">,</span>
                    <span class="s1">&#39;exp&#39;</span><span class="p">:</span> <span class="n">expTickFormat</span><span class="p">}</span>
    <span class="c1"># Set axes tick formats</span>
    <span class="k">if</span> <span class="n">x_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">x_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">x_tick_format</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">y_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">y_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">y_tick_format</span><span class="p">]))</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Configure grid major lines</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># Configure grid minor lines</span>
    <span class="n">axis_option</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;log-log&#39;</span><span class="p">:</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="s1">&#39;log-linear&#39;</span><span class="p">:</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;linear-log&#39;</span><span class="p">:</span> <span class="s1">&#39;y&#39;</span><span class="p">}</span>
    <span class="n">xy_scale</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x_scale</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y_scale</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">if</span> <span class="n">xy_scale</span> <span class="ow">in</span> <span class="n">axis_option</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis_option</span><span class="p">[</span><span class="n">xy_scale</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                  <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>        
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Plot data</span>
    <span class="k">if</span> <span class="n">is_error_bar</span><span class="p">:</span>
        <span class="c1"># Get x-values</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Get y-values mean</span>
        <span class="n">y_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Get y-values range</span>
        <span class="k">if</span> <span class="n">range_type</span> <span class="o">==</span> <span class="s1">&#39;min-max&#39;</span><span class="p">:</span>
            <span class="c1"># Set lower and upper errors: [|mean - min|, |mean - max|]</span>
            <span class="n">y_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">y_mean</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span>
                                             <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                 <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">y_mean</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span>
                                             <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">range_type</span> <span class="o">==</span> <span class="s1">&#39;mean-std&#39;</span><span class="p">:</span>
            <span class="c1"># Set lower and upper errors: [1.96*std, 1.96*std]</span>
            <span class="n">y_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">(</span><span class="mf">1.96</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
                             <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                 <span class="mf">1.96</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
                             <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Skip range computation</span>
            <span class="n">y_err</span> <span class="o">=</span> <span class="kc">None</span>            
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Plot data (concatenating data from all data sets)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_mean</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">y_err</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                      <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                      <span class="n">elinewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Suppress data labels</span>
        <span class="n">data_labels</span> <span class="o">=</span> <span class="n">n_datasets</span><span class="o">*</span><span class="p">[</span><span class="kc">None</span><span class="p">,]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Loop over data sets</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_datasets</span><span class="p">):</span>
            <span class="c1"># Plot data set</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">],</span> <span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
                         <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                         <span class="n">label</span><span class="o">=</span><span class="n">tex_str</span><span class="p">(</span><span class="n">data_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">is_latex</span><span class="p">),</span>
                         <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set axes limits</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_lims</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lims</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Plot identity line and identity error bounds</span>
    <span class="k">if</span> <span class="n">is_identity_line</span><span class="p">:</span>
        <span class="c1"># Plot identity line</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">axline</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">slope</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="c1"># Identity error bounds</span>
        <span class="k">if</span> <span class="n">identity_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Set identity error bounds label</span>
            <span class="k">if</span> <span class="n">is_latex</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">identity_error</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="se">\\</span><span class="s1">% error&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">identity_error</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">% error&#39;</span>
            <span class="c1"># Plot identity error bounds</span>
            <span class="k">if</span> <span class="n">identity_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>            
                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">axis</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axes</span><span class="o">.</span><span class="n">axis</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">identity_error</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">,</span>
                                  <span class="n">y2</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">identity_error</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">,</span>
                                  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#BBBBBB&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                                  <span class="n">zorder</span><span class="o">=-</span><span class="mi">15</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Compute and plot coefficient of determination</span>
    <span class="k">if</span> <span class="n">is_r2_coefficient</span> <span class="ow">and</span> <span class="n">n_datasets</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Get reference and predicted data</span>
        <span class="n">ref_data</span> <span class="o">=</span> <span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">pred_data</span> <span class="o">=</span> <span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="c1"># Compute mean of reference data</span>
        <span class="n">data_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ref_data</span><span class="p">)</span>
        <span class="c1"># Compute sum of squares of residuals</span>
        <span class="n">ssres</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">ref_data</span> <span class="o">-</span> <span class="n">pred_data</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1"># Compute total sum of squares</span>
        <span class="n">sstot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">ref_data</span> <span class="o">-</span> <span class="n">data_mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1"># Avoid division by zero</span>
        <span class="n">tolerance</span> <span class="o">=</span> <span class="mf">1e-8</span>
        <span class="k">if</span> <span class="n">sstot</span> <span class="o">&lt;</span> <span class="n">tolerance</span><span class="o">*</span><span class="n">ssres</span><span class="p">:</span>
            <span class="n">sstot</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="c1"># Compute coefficient of determination</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">ssres</span><span class="o">/</span><span class="n">sstot</span>
        <span class="c1"># Get coefficient of determination string</span>
        <span class="n">r2_str</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$R^2=&#39;</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;$&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="c1"># Set text box properties</span>
        <span class="n">text_box_props</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;#ffffff&#39;</span><span class="p">,</span>
                              <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;#000000&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="c1"># Plot coefficient of determination</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.97</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="n">r2_str</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                  <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">text_box_props</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="k">if</span> <span class="n">is_direct_loss_estimator</span> <span class="ow">and</span> <span class="n">n_datasets</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Get reference and predicted data</span>
        <span class="n">ref_data</span> <span class="o">=</span> <span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">pred_data</span> <span class="o">=</span> <span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># Fit linear regression model (monitored model)</span>
        <span class="n">monitored_model</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
        <span class="n">monitored_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">pred_data</span><span class="p">)</span>
        <span class="c1"># Get monitored model predicted data</span>
        <span class="n">pred_data_monitored</span> <span class="o">=</span> <span class="n">monitored_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">ref_data</span><span class="p">)</span>
        <span class="c1"># Compute absolute error between predicted data and monitored model</span>
        <span class="c1"># predictions</span>
        <span class="n">abs_error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pred_data</span> <span class="o">-</span> <span class="n">pred_data_monitored</span><span class="p">)</span>
        <span class="c1"># Build input features and targets to predict absolute error</span>
        <span class="n">features_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">pred_data_monitored</span><span class="p">))</span>
        <span class="n">targets_matrix</span> <span class="o">=</span> <span class="n">abs_error</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># Fit linear regression model (predict absolute error)</span>
        <span class="n">abs_error_model</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
        <span class="n">abs_error_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features_matrix</span><span class="p">,</span> <span class="n">targets_matrix</span><span class="p">)</span>
        <span class="n">abs_error_estimate</span> <span class="o">=</span> <span class="n">abs_error_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features_matrix</span><span class="p">)</span>
        <span class="c1"># Build monitored model prediction bounds</span>
        <span class="n">pred_data_monitored_lbound</span> <span class="o">=</span> <span class="n">pred_data_monitored</span> <span class="o">-</span> <span class="n">abs_error_estimate</span>
        <span class="n">pred_data_monitored_ubound</span> <span class="o">=</span> <span class="n">pred_data_monitored</span> <span class="o">+</span> <span class="n">abs_error_estimate</span>
        <span class="c1"># Set label for monitored model predicted data and error bounds</span>
        <span class="k">if</span> <span class="n">is_latex</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$\mathrm{DLE: LR} \pm \epsilon_{\mathrm</span><span class="si">{LR}</span><span class="s1">}$&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;DLE-LR &#39;</span> <span class="o">+</span> <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u00B1</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39; error_</span><span class="si">{LR}</span><span class="s1">&#39;</span>
        <span class="c1"># Plot monitored model predicted data and corresponding bounds</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">pred_data_monitored</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#EE7733&#39;</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">pred_data_monitored_lbound</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#EE7733&#39;</span><span class="p">,</span>
                  <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">pred_data_monitored_ubound</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#EE7733&#39;</span><span class="p">,</span>
                  <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Plot marginal distributions</span>
    <span class="k">if</span> <span class="n">is_marginal_dists</span><span class="p">:</span>
        <span class="c1"># Set marginal distributions (concatenating data from all data sets)</span>
        <span class="n">hist_x_data</span> <span class="o">=</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_datasets</span><span class="p">)])</span>
        <span class="n">hist_y_data</span> <span class="o">=</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_datasets</span><span class="p">)])</span>
        <span class="c1"># Plot marginal distributions</span>
        <span class="n">axes_hist_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">hist_x_data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#EE7733&#39;</span><span class="p">)</span>
        <span class="n">axes_hist_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">hist_y_data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#EE7733&#39;</span><span class="p">,</span>
                         <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set legend</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_labels</span><span class="p">])</span> <span class="ow">or</span> <span class="n">identity_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Set legend position and number of columns</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper left&#39;</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper left&#39;</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1"># Plot legend</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;inherit&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;inherit&#39;</span><span class="p">,</span>
                             <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="n">legend</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Return figure and axes handlers</span>
    <span class="k">return</span> <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="scatter_xny_data"><a class="viewcode-back" href="../../../_autosummary/hookeai.ioput.plots.scatter_xny_data.html#hookeai.ioput.plots.scatter_xny_data">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">scatter_xny_data</span><span class="p">(</span>
    <span class="n">data_xy_list</span><span class="p">,</span> <span class="n">data_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_error_bar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">range_type</span><span class="o">=</span><span class="s1">&#39;min-max&#39;</span><span class="p">,</span>
    <span class="n">x_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">y_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">y_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">y_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">x_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">y_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_latex</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scatter data in xy axes with given range of y-values for each x-value.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_xy_list : list[np.ndarray(2d)]</span>
<span class="sd">        List of data arrays. Each data array contains plot data stored</span>
<span class="sd">        columnwise such that data_array[:, 0] holds the x-axis data and</span>
<span class="sd">        data_array[:, 1:] holds the y-axis data.</span>
<span class="sd">    data_labels : list, default=None</span>
<span class="sd">        Labels of data sets (x_i, y_i) provided in data_xy and sorted</span>
<span class="sd">        accordingly. If None, then no labels are displayed.</span>
<span class="sd">    is_error_bar : bool, default=False</span>
<span class="sd">        If True, then plot error bar according with range type.</span>
<span class="sd">    range_type : {&#39;min-max&#39;, &#39;mean-std&#39;, None}, default=&#39;min-max&#39;</span>
<span class="sd">        Type of range of y-values to be plotted for each x-value around the</span>
<span class="sd">        mean. If None, only the mean is plotted. Only effective if is_error_bar</span>
<span class="sd">        is set to True.</span>
<span class="sd">    x_lims : tuple, default=(None, None)</span>
<span class="sd">        x-axis limits in data coordinates.</span>
<span class="sd">    y_lims : tuple, default=(None, None)</span>
<span class="sd">        y-axis limits in data coordinates.</span>
<span class="sd">    title : str, default=None</span>
<span class="sd">        Plot title.</span>
<span class="sd">    x_label : str, default=None</span>
<span class="sd">        x-axis label.</span>
<span class="sd">    y_label : str, default=None</span>
<span class="sd">        y-axis label.</span>
<span class="sd">    x_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        x-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any x-axis ticks formatting.</span>
<span class="sd">    y_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        y-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any y-axis ticks formatting.</span>
<span class="sd">    x_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        x-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    y_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        y-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    is_latex : bool, default=False</span>
<span class="sd">        If True, then render all strings in LaTeX. If LaTex is not available,</span>
<span class="sd">        then this option is silently set to False and all input strings are</span>
<span class="sd">        processed to remove $(...)$ enclosure.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    figure : Matplotlib Figure</span>
<span class="sd">        Figure.</span>
<span class="sd">    axes : Matplotlib Axes</span>
<span class="sd">        Axes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Reset matplotlib internal default style</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParamsDefault</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check data</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_xy_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Data must be provided as a list of data arrays &#39;</span>
                           <span class="s1">&#39;stored as numpy.ndarray(2d).&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_xy_list</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Data must be provided as a list of data arrays &#39;</span>
                           <span class="s1">&#39;stored as numpy.ndarray(2d).&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_xy_list</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Data must be provided as a list of data arrays &#39;</span>
                           <span class="s1">&#39;stored as numpy.ndarray(2d).&#39;</span><span class="p">)</span>
    <span class="c1"># Get number of data sets</span>
    <span class="n">n_datasets</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_xy_list</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check datasets labels</span>
    <span class="k">if</span> <span class="n">data_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_labels</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_datasets</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Number of data set labels is not consistent &#39;</span>
                               <span class="s1">&#39;with list of data arrays.&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_labels</span> <span class="o">=</span> <span class="n">n_datasets</span><span class="o">*</span><span class="p">[</span><span class="kc">None</span><span class="p">,]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set default color cycle</span>
    <span class="n">cycler_color</span> <span class="o">=</span> <span class="n">cycler</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,[</span><span class="s1">&#39;#4477AA&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE6677&#39;</span><span class="p">,</span> <span class="s1">&#39;#228833&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CCBB44&#39;</span><span class="p">,</span> <span class="s1">&#39;#66CCEE&#39;</span><span class="p">,</span> <span class="s1">&#39;#AA3377&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#BBBBBB&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE7733&#39;</span><span class="p">,</span> <span class="s1">&#39;#009988&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CC3311&#39;</span><span class="p">,</span> <span class="s1">&#39;#DDAA33&#39;</span><span class="p">,</span> <span class="s1">&#39;#999933&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#DDCC77&#39;</span><span class="p">,</span> <span class="s1">&#39;#882255&#39;</span><span class="p">])</span>
    <span class="c1"># Set default linestyle cycle</span>
    <span class="n">cycler_linestyle</span> <span class="o">=</span> <span class="n">cycler</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;linestyle&#39;</span><span class="p">,[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;-.&#39;</span><span class="p">])</span>
    <span class="c1"># Set default cycler</span>
    <span class="n">default_cycler</span> <span class="o">=</span> <span class="n">cycler_linestyle</span><span class="o">*</span><span class="n">cycler_color</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">prop_cycle</span> <span class="o">=</span> <span class="n">default_cycler</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check LaTeX availability</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;latex&#39;</span><span class="p">)):</span>
        <span class="n">is_latex</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># Set LaTeX font</span>
    <span class="k">if</span> <span class="n">is_latex</span><span class="p">:</span>
        <span class="c1"># Default LaTeX Computer Modern Roman</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;serif&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Computer Modern Roman&#39;</span><span class="p">]})</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create figure</span>
    <span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="c1"># Set figure size (inches) - stdout print purpose</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set main axes</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set title</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># Set axes labels</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set axes scales</span>
    <span class="k">if</span> <span class="n">x_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">x_scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">y_scale</span><span class="p">)</span>
    <span class="c1"># Set tick formatting functions</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">intTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:2d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">floatTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:3.1f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">expTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:7.2e}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">tick_formats</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;int&#39;</span><span class="p">:</span> <span class="n">intTickFormat</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="n">floatTickFormat</span><span class="p">,</span>
                    <span class="s1">&#39;exp&#39;</span><span class="p">:</span> <span class="n">expTickFormat</span><span class="p">}</span>
    <span class="c1"># Set axes tick formats</span>
    <span class="k">if</span> <span class="n">x_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">x_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">x_tick_format</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">y_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">y_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">y_tick_format</span><span class="p">]))</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Configure grid major lines</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># Configure grid minor lines</span>
    <span class="n">axis_option</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;log-log&#39;</span><span class="p">:</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="s1">&#39;log-linear&#39;</span><span class="p">:</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;linear-log&#39;</span><span class="p">:</span> <span class="s1">&#39;y&#39;</span><span class="p">}</span>
    <span class="n">xy_scale</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x_scale</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y_scale</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">if</span> <span class="n">xy_scale</span> <span class="ow">in</span> <span class="n">axis_option</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis_option</span><span class="p">[</span><span class="n">xy_scale</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                  <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>        
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Loop over data sets</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_datasets</span><span class="p">):</span>
        <span class="c1"># Get data array</span>
        <span class="n">data_xy</span> <span class="o">=</span> <span class="n">data_xy_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Plot data</span>
        <span class="k">if</span> <span class="n">is_error_bar</span><span class="p">:</span>
            <span class="c1"># Get x-values</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="c1"># Get y-values mean</span>
            <span class="n">y_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Get y-values range</span>
            <span class="k">if</span> <span class="n">range_type</span> <span class="o">==</span> <span class="s1">&#39;min-max&#39;</span><span class="p">:</span>
                <span class="c1"># Set lower and upper errors: [|mean - min|, |mean - max|]</span>
                <span class="n">y_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">y_mean</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:],</span>
                                                 <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                     <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">y_mean</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:],</span>
                                                 <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))),</span>
                    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">range_type</span> <span class="o">==</span> <span class="s1">&#39;mean-std&#39;</span><span class="p">:</span>
                <span class="c1"># Set lower and upper errors: [1.96*std, 1.96*std]</span>
                <span class="n">y_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                    <span class="p">(</span><span class="mf">1.96</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
                                 <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                    <span class="mf">1.96</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data_xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
                                <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Skip range computation</span>
                <span class="n">y_err</span> <span class="o">=</span> <span class="kc">None</span>  
            <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c1"># Plot data (concatenating data from all data sets)</span>
            <span class="n">error_bar_option</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">error_bar_option</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_mean</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">y_err</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                              <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                              <span class="n">elinewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                              <span class="n">label</span><span class="o">=</span><span class="n">tex_str</span><span class="p">(</span><span class="n">data_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">is_latex</span><span class="p">),</span>
                              <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="o">-</span><span class="n">i</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">error_bar_option</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_mean</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">y_err</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                              <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                              <span class="n">elinewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                              <span class="n">label</span><span class="o">=</span><span class="n">tex_str</span><span class="p">(</span><span class="n">data_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">is_latex</span><span class="p">),</span>
                              <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="o">-</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_mean</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">y_err</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                              <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                              <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                              <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                              <span class="n">label</span><span class="o">=</span><span class="n">tex_str</span><span class="p">(</span><span class="n">data_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">is_latex</span><span class="p">))</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set axes limits</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_lims</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lims</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set legend</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_labels</span><span class="p">]):</span>
        <span class="c1"># Set legend position and number of columns</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;best&#39;</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;best&#39;</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1"># Plot legend</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;inherit&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;inherit&#39;</span><span class="p">,</span>
                             <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="n">legend</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Return figure and axes handlers</span>
    <span class="k">return</span> <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="grouped_bar_chart"><a class="viewcode-back" href="../../../_autosummary/hookeai.ioput.plots.grouped_bar_chart.html#hookeai.ioput.plots.grouped_bar_chart">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">grouped_bar_chart</span><span class="p">(</span><span class="n">groups_labels</span><span class="p">,</span> <span class="n">groups_data</span><span class="p">,</span> <span class="n">bar_width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">is_avg_hline</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">y_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">x_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                      <span class="n">y_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_latex</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot grouped bar chart.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    groups_labels = tuple[str]</span>
<span class="sd">        Bar groups labels.</span>
<span class="sd">    groups_data = dict</span>
<span class="sd">        Store groups data (item, tuple) for data set (key, str). Dictionary</span>
<span class="sd">        keys are taken as labels for each data set.</span>
<span class="sd">    bar_width : float, default=None</span>
<span class="sd">        Width of bars.</span>
<span class="sd">    is_avg_hline, default=False</span>
<span class="sd">        Plot horizontal line for average value of each data set.</span>
<span class="sd">    y_lims : tuple, default=(None, None)</span>
<span class="sd">        y-axis limits in data coordinates.</span>
<span class="sd">    title : str, default=None</span>
<span class="sd">        Plot title.</span>
<span class="sd">    x_label : str, default=None</span>
<span class="sd">        x-axis label.</span>
<span class="sd">    y_label : str, default=None</span>
<span class="sd">        y-axis label.</span>
<span class="sd">    y_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        y-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any y-axis ticks formatting.</span>
<span class="sd">    is_latex : bool, default=False</span>
<span class="sd">        If True, then render all strings in LaTeX. If LaTex is not available,</span>
<span class="sd">        then this option is silently set to False and all input strings are</span>
<span class="sd">        processed to remove $(...)$ enclosure.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    figure : Matplotlib Figure</span>
<span class="sd">        Figure.</span>
<span class="sd">    axes : Matplotlib Axes</span>
<span class="sd">        Axes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Reset matplotlib internal default style</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParamsDefault</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check bar groups labels</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">groups_labels</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Bar groups labels must be provided as a tuple of &#39;</span>
                           <span class="s1">&#39;strings.&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Get number of bar groups</span>
        <span class="n">n_groups</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups_labels</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check bar groups data</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">groups_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Bar groups data must be provided as a dictionary &#39;</span>
                           <span class="s1">&#39;of tuples.&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_groups</span>
                  <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">groups_data</span><span class="o">.</span><span class="n">values</span><span class="p">()]):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Bar groups data must be provided as a dictionary &#39;</span>
                           <span class="s1">&#39;of tuples with size (n_groups,).&#39;</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set bar width</span>
    <span class="k">if</span> <span class="n">bar_width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">bar_width</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set default color cycle</span>
    <span class="n">cycler_color</span> <span class="o">=</span> <span class="n">cycler</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,[</span><span class="s1">&#39;#4477AA&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE6677&#39;</span><span class="p">,</span> <span class="s1">&#39;#228833&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CCBB44&#39;</span><span class="p">,</span> <span class="s1">&#39;#66CCEE&#39;</span><span class="p">,</span> <span class="s1">&#39;#AA3377&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#BBBBBB&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE7733&#39;</span><span class="p">,</span> <span class="s1">&#39;#009988&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CC3311&#39;</span><span class="p">,</span> <span class="s1">&#39;#DDAA33&#39;</span><span class="p">,</span> <span class="s1">&#39;#999933&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#DDCC77&#39;</span><span class="p">,</span> <span class="s1">&#39;#882255&#39;</span><span class="p">])</span>
    <span class="c1"># Set default linestyle cycle</span>
    <span class="n">cycler_linestyle</span> <span class="o">=</span> <span class="n">cycler</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;linestyle&#39;</span><span class="p">,[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;-.&#39;</span><span class="p">])</span>
    <span class="c1"># Set default cycler</span>
    <span class="n">default_cycler</span> <span class="o">=</span> <span class="n">cycler_linestyle</span><span class="o">*</span><span class="n">cycler_color</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">prop_cycle</span> <span class="o">=</span> <span class="n">default_cycler</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check LaTeX availability</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;latex&#39;</span><span class="p">)):</span>
        <span class="n">is_latex</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># Set LaTeX font</span>
    <span class="k">if</span> <span class="n">is_latex</span><span class="p">:</span>
        <span class="c1"># Default LaTeX Computer Modern Roman</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;serif&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Computer Modern Roman&#39;</span><span class="p">]})</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create figure</span>
    <span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="c1"># Set figure size (inches) - stdout print purpose</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create axes</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Set title</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># Set axes labels</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set axes scales</span>
    <span class="k">if</span> <span class="n">y_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">y_scale</span><span class="p">)</span>
    <span class="c1"># Set tick formatting functions</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">intTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:2d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">floatTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:3.1f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">expTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:7.2e}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">tick_formats</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;int&#39;</span><span class="p">:</span> <span class="n">intTickFormat</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="n">floatTickFormat</span><span class="p">,</span>
                    <span class="s1">&#39;exp&#39;</span><span class="p">:</span> <span class="n">expTickFormat</span><span class="p">}</span>
    <span class="c1"># Set groups labels locations</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_groups</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">groups_labels</span><span class="p">)</span>
    <span class="c1"># Set axes tick formats</span>
    <span class="k">if</span> <span class="n">y_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">y_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">y_tick_format</span><span class="p">]))</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Configure grid major lines</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Initialize bar groups position counter</span>
    <span class="n">group_id</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Loop over data sets</span>
    <span class="k">for</span> <span class="n">ds_label</span><span class="p">,</span> <span class="n">ds_values</span> <span class="ow">in</span> <span class="n">groups_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Set data set bar offset</span>
        <span class="n">ds_offset</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">group_id</span><span class="p">)</span><span class="o">*</span><span class="n">bar_width</span>
        <span class="c1"># Plot data set bars</span>
        <span class="n">dataset_bars</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">ds_offset</span><span class="p">,</span> <span class="n">ds_values</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">bar_width</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="n">tex_str</span><span class="p">(</span><span class="n">ds_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span>
                                <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="c1"># Plot data set average line</span>
        <span class="k">if</span> <span class="n">is_avg_hline</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ds_values</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                         <span class="n">color</span><span class="o">=</span><span class="n">dataset_bars</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_facecolor</span><span class="p">())</span>
        <span class="c1"># Increment position counter</span>
        <span class="n">group_id</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Add average line to legend (dummy plot)</span>
    <span class="k">if</span> <span class="n">is_avg_hline</span><span class="p">:</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">groups_data</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]),</span>
                  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average&#39;</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set axes limits</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lims</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set legend</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;inherit&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;inherit&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                <span class="n">framealpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Return figure and axes handlers</span>
    <span class="k">return</span> <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="plot_boxplots"><a class="viewcode-back" href="../../../_autosummary/hookeai.ioput.plots.plot_boxplots.html#hookeai.ioput.plots.plot_boxplots">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">plot_boxplots</span><span class="p">(</span><span class="n">data_boxplots</span><span class="p">,</span> <span class="n">data_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_mean_line</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">y_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">y_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">y_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">is_multiple_subplots</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_latex</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot set of box plots.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_boxplots : numpy.ndarray(2d)</span>
<span class="sd">        Data array where each box plot data is stored columnwise such that the</span>
<span class="sd">        i-th boxplot is stored in the i-th column.</span>
<span class="sd">    data_labels : list, default=None</span>
<span class="sd">        Labels of each box plot provided in data_boxplots and sorted</span>
<span class="sd">        accordingly. If None, then no labels are displayed.</span>
<span class="sd">    is_mean_line : bool, default=False</span>
<span class="sd">        If True, then plot mean line for each boxplot.</span>
<span class="sd">    y_lims : tuple, default=(None, None)</span>
<span class="sd">        y-axis limits in data coordinates.</span>
<span class="sd">    title : str, default=None</span>
<span class="sd">        Plot title.</span>
<span class="sd">    x_label : str, default=None</span>
<span class="sd">        x-axis label.</span>
<span class="sd">    y_label : str, default=None</span>
<span class="sd">        y-axis label.</span>
<span class="sd">    y_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        y-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any y-axis ticks formatting.</span>
<span class="sd">    y_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        y-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    is_latex : bool, default=False</span>
<span class="sd">        If True, then render all strings in LaTeX. If LaTex is not available,</span>
<span class="sd">        then this option is silently set to False and all input strings are</span>
<span class="sd">        processed to remove $(...)$ enclosure.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    figure : Matplotlib Figure</span>
<span class="sd">        Figure.</span>
<span class="sd">    axes : Matplotlib Axes</span>
<span class="sd">        Axes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Reset matplotlib internal default style</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParamsDefault</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Get number of boxplots</span>
    <span class="n">n_boxplots</span> <span class="o">=</span> <span class="n">data_boxplots</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check datasets labels</span>
    <span class="k">if</span> <span class="n">data_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_labels</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_boxplots</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Number of labels is not consistent with &#39;</span>
                               <span class="s1">&#39;number of boxplots.&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_labels</span> <span class="o">=</span> <span class="n">n_boxplots</span><span class="o">*</span><span class="p">[</span><span class="kc">None</span><span class="p">,]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set default color cycle</span>
    <span class="n">cycler_color</span> <span class="o">=</span> <span class="n">cycler</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,[</span><span class="s1">&#39;#4477AA&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE6677&#39;</span><span class="p">,</span> <span class="s1">&#39;#228833&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CCBB44&#39;</span><span class="p">,</span> <span class="s1">&#39;#66CCEE&#39;</span><span class="p">,</span> <span class="s1">&#39;#AA3377&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#BBBBBB&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE7733&#39;</span><span class="p">,</span> <span class="s1">&#39;#009988&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CC3311&#39;</span><span class="p">,</span> <span class="s1">&#39;#DDAA33&#39;</span><span class="p">,</span> <span class="s1">&#39;#999933&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#DDCC77&#39;</span><span class="p">,</span> <span class="s1">&#39;#882255&#39;</span><span class="p">])</span>
    <span class="c1"># Set default linestyle cycle</span>
    <span class="n">cycler_linestyle</span> <span class="o">=</span> <span class="n">cycler</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;linestyle&#39;</span><span class="p">,[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;-.&#39;</span><span class="p">])</span>
    <span class="c1"># Set default cycler</span>
    <span class="n">default_cycler</span> <span class="o">=</span> <span class="n">cycler_linestyle</span><span class="o">*</span><span class="n">cycler_color</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">prop_cycle</span> <span class="o">=</span> <span class="n">default_cycler</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check LaTeX availability</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;latex&#39;</span><span class="p">)):</span>
        <span class="n">is_latex</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># Set LaTeX font</span>
    <span class="k">if</span> <span class="n">is_latex</span><span class="p">:</span>
        <span class="c1"># Default LaTeX Computer Modern Roman</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;serif&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Computer Modern Roman&#39;</span><span class="p">]})</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set number of subplots</span>
    <span class="k">if</span> <span class="n">is_multiple_subplots</span><span class="p">:</span>
        <span class="n">n_subplots</span> <span class="o">=</span> <span class="n">n_boxplots</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_subplots</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create figure</span>
    <span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="c1"># Set figure size (inches) - stdout print purpose</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n_subplots</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">figure</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">((</span><span class="mi">6</span> <span class="o">+</span> <span class="n">n_subplots</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">figure</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Loop over subplots</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_subplots</span><span class="p">):</span>
        <span class="c1"># Create axes</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_subplots</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># Set title</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="c1"># Set axes labels</span>
        <span class="k">if</span> <span class="n">n_subplots</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                            <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                            <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set axes scales</span>
        <span class="k">if</span> <span class="n">y_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="s1">&#39;symlog&#39;</span><span class="p">):</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">y_scale</span><span class="p">)</span>
        <span class="c1"># Set tick formatting functions</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">intTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
            <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:2d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">floatTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
            <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:3.1f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">expTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
            <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:7.2e}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">tick_formats</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;int&#39;</span><span class="p">:</span> <span class="n">intTickFormat</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="n">floatTickFormat</span><span class="p">,</span>
                        <span class="s1">&#39;exp&#39;</span><span class="p">:</span> <span class="n">expTickFormat</span><span class="p">}</span>
        <span class="c1"># Set axes tick formats</span>
        <span class="k">if</span> <span class="n">y_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">y_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
                <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">y_tick_format</span><span class="p">]))</span>
        <span class="c1"># Set axes tick parameters</span>
        <span class="k">if</span> <span class="n">n_subplots</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Configure grid major lines</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>     
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set median line properties</span>
        <span class="n">medianprops</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="c1"># Set outliers properties</span>
        <span class="n">flierprops</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="c1"># Set mean line properties</span>
        <span class="n">meanlineprops</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">is_mean_line</span><span class="p">:</span>
            <span class="n">meanlineprops</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#d62728&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Plot set of box plots</span>
        <span class="k">if</span> <span class="n">is_multiple_subplots</span><span class="p">:</span>
            <span class="n">bp</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data_boxplots</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                              <span class="n">labels</span><span class="o">=</span><span class="p">(</span><span class="n">data_labels</span><span class="p">[</span><span class="n">k</span><span class="p">],),</span> <span class="n">flierprops</span><span class="o">=</span><span class="n">flierprops</span><span class="p">,</span>
                              <span class="n">medianprops</span><span class="o">=</span><span class="n">medianprops</span><span class="p">,</span> <span class="n">showmeans</span><span class="o">=</span><span class="n">is_mean_line</span><span class="p">,</span>
                              <span class="n">meanline</span><span class="o">=</span><span class="n">is_mean_line</span><span class="p">,</span> <span class="n">meanprops</span><span class="o">=</span><span class="n">meanlineprops</span><span class="p">,</span>
                              <span class="n">patch_artist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bp</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data_boxplots</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">data_labels</span><span class="p">,</span>
                              <span class="n">flierprops</span><span class="o">=</span><span class="n">flierprops</span><span class="p">,</span> <span class="n">medianprops</span><span class="o">=</span><span class="n">medianprops</span><span class="p">,</span>
                              <span class="n">showmeans</span><span class="o">=</span><span class="n">is_mean_line</span><span class="p">,</span> <span class="n">meanline</span><span class="o">=</span><span class="n">is_mean_line</span><span class="p">,</span>
                              <span class="n">meanprops</span><span class="o">=</span><span class="n">meanlineprops</span><span class="p">,</span> <span class="n">patch_artist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set box plots face color</span>
        <span class="k">for</span> <span class="n">patch</span> <span class="ow">in</span> <span class="n">bp</span><span class="p">[</span><span class="s1">&#39;boxes&#39;</span><span class="p">]:</span>
            <span class="n">patch</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;#4477AA&#39;</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Plot mean line annotation</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bp</span><span class="p">[</span><span class="s1">&#39;means&#39;</span><span class="p">]):</span>
            <span class="c1"># Get mean line coordinates</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_xydata</span><span class="p">()[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_xydata</span><span class="p">()[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
            <span class="c1"># Set annotation text coordinates</span>
            <span class="n">x_text</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span>
            <span class="n">y_text</span> <span class="o">=</span> <span class="n">y1</span>
            <span class="c1"># Set annotation text</span>
            <span class="k">if</span> <span class="n">is_latex</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;$\mu$&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="c1"># Plot mean line annotation</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x_text</span><span class="p">,</span> <span class="n">y_text</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#d62728&#39;</span><span class="p">,</span>
                          <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c1"># Set axes limits</span>
        <span class="k">if</span> <span class="n">y_lims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lims</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Adjust spacing to avoid overlaps between multiple subplots</span>
    <span class="k">if</span> <span class="n">n_subplots</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">figure</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Return figure and axes handlers</span>
    <span class="k">return</span> <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="plot_histogram"><a class="viewcode-back" href="../../../_autosummary/hookeai.ioput.plots.plot_histogram.html#hookeai.ioput.plots.plot_histogram">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">plot_histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bins_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">x_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">y_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                   <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">x_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">y_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">x_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">y_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_latex</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot 1D histogram.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : tuple[numpy.ndarray(1d)]</span>
<span class="sd">        Histogram data set.</span>
<span class="sd">    data_labels : tuple[str], default=None</span>
<span class="sd">        Histogram data sets labels. If None, then no labels are displayed.</span>
<span class="sd">    bins : {int, tuple, str}, default=None</span>
<span class="sd">        Histogram bins, provided either as an integer (number of equal-width</span>
<span class="sd">        bins in the range) or as a sequence (bins edges). Some binning</span>
<span class="sd">        strategies are also available (e.g., &#39;auto&#39;, &#39;fd&#39;).</span>
<span class="sd">    bins_range : tuple, default=None</span>
<span class="sd">        The lower (bins_range[0]) and upper (bins_range[1]) range of the bins,</span>
<span class="sd">        ignoring outliers outside the provided range. Not effective if bins</span>
<span class="sd">        sequence is provided.</span>
<span class="sd">    density : bool, default=False</span>
<span class="sd">        If True, draw and return a probability density (area under the</span>
<span class="sd">        histogram integrates to 1).</span>
<span class="sd">    title : str, default=None</span>
<span class="sd">        Plot title.</span>
<span class="sd">    x_label : str, default=None</span>
<span class="sd">        x-axis label.</span>
<span class="sd">    y_label : str, default=None</span>
<span class="sd">        y-axis label.</span>
<span class="sd">    x_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        x-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any x-axis ticks formatting.</span>
<span class="sd">    y_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        y-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any y-axis ticks formatting.</span>
<span class="sd">    x_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        x-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    y_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        y-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    is_latex : bool, default=False</span>
<span class="sd">        If True, then render all strings in LaTeX. If LaTex is not available,</span>
<span class="sd">        then this option is silently set to False and all input strings are</span>
<span class="sd">        processed to remove $(...)$ enclosure.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    figure : Matplotlib Figure</span>
<span class="sd">        Figure.</span>
<span class="sd">    axes : Matplotlib Axes</span>
<span class="sd">        Axes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Reset matplotlib internal default style</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParamsDefault</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check data</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Histogram data sets must be provided as a tuple &#39;</span>
                           <span class="s1">&#39;of numpy 1d array.&#39;</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Get number of data sets</span>
    <span class="n">n_datasets</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="c1"># Check data sets</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_datasets</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Each histogram data set must be stored as &#39;</span>
                               <span class="s1">&#39;a numpy 1d array.&#39;</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check datasets labels</span>
    <span class="k">if</span> <span class="n">data_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_labels</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_datasets</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Number of data set labels is not consistent &#39;</span>
                               <span class="s1">&#39;with number of data sets.&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_labels</span> <span class="o">=</span> <span class="n">n_datasets</span><span class="o">*</span><span class="p">[</span><span class="kc">None</span><span class="p">,]</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set default color cycle</span>
    <span class="n">cycler_color</span> <span class="o">=</span> <span class="n">cycler</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,[</span><span class="s1">&#39;#4477AA&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE6677&#39;</span><span class="p">,</span> <span class="s1">&#39;#228833&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CCBB44&#39;</span><span class="p">,</span> <span class="s1">&#39;#66CCEE&#39;</span><span class="p">,</span> <span class="s1">&#39;#AA3377&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#BBBBBB&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE7733&#39;</span><span class="p">,</span> <span class="s1">&#39;#009988&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CC3311&#39;</span><span class="p">,</span> <span class="s1">&#39;#DDAA33&#39;</span><span class="p">,</span> <span class="s1">&#39;#999933&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#DDCC77&#39;</span><span class="p">,</span> <span class="s1">&#39;#882255&#39;</span><span class="p">])</span>
    <span class="c1"># Set default cycler</span>
    <span class="n">default_cycler</span> <span class="o">=</span> <span class="n">cycler_color</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">prop_cycle</span> <span class="o">=</span> <span class="n">cycler_color</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    </span>
    <span class="c1"># Check LaTeX availability</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;latex&#39;</span><span class="p">)):</span>
        <span class="n">is_latex</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># Set LaTeX font</span>
    <span class="k">if</span> <span class="n">is_latex</span><span class="p">:</span>
        <span class="c1"># Default LaTeX Computer Modern Roman</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;serif&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Computer Modern Roman&#39;</span><span class="p">]})</span>        
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create figure</span>
    <span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="c1"># Set figure size (inches) - stdout print purpose</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create axes</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Set title</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># Set axes labels</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set axes scales</span>
    <span class="k">if</span> <span class="n">x_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">x_scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">y_scale</span><span class="p">)</span>
    <span class="c1"># Set tick formatting functions</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">intTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:2d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">floatTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:3.1f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">expTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:7.2e}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">tick_formats</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;int&#39;</span><span class="p">:</span> <span class="n">intTickFormat</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="n">floatTickFormat</span><span class="p">,</span>
                    <span class="s1">&#39;exp&#39;</span><span class="p">:</span> <span class="n">expTickFormat</span><span class="p">}</span>
    <span class="c1"># Set axes tick formats</span>
    <span class="k">if</span> <span class="n">x_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">x_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">x_tick_format</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">y_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">y_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">y_tick_format</span><span class="p">]))</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Configure grid major lines</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1"># Configure grid minor lines</span>
    <span class="n">axis_option</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;log-log&#39;</span><span class="p">:</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="s1">&#39;log-linear&#39;</span><span class="p">:</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;linear-log&#39;</span><span class="p">:</span> <span class="s1">&#39;y&#39;</span><span class="p">}</span>
    <span class="n">xy_scale</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x_scale</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y_scale</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">if</span> <span class="n">xy_scale</span> <span class="ow">in</span> <span class="n">axis_option</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis_option</span><span class="p">[</span><span class="n">xy_scale</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                  <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Plot histogram</span>
    <span class="n">bins_vals</span><span class="p">,</span> <span class="n">bins_edges</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">bins_range</span><span class="p">,</span>
                                         <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set legend</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_labels</span><span class="p">]):</span>
        <span class="c1"># Set legend position and number of columns</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;best&#39;</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;best&#39;</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1"># Plot legend</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;inherit&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;inherit&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                    <span class="n">framealpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set axes limits</span>
    <span class="k">if</span> <span class="n">x_lims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_lims</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y_lims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lims</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Return figure and axes handlers</span>
    <span class="k">return</span> <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="plot_histogram_2d"><a class="viewcode-back" href="../../../_autosummary/hookeai.ioput.plots.plot_histogram_2d.html#hookeai.ioput.plots.plot_histogram_2d">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">plot_histogram_2d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">bins_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">x_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">y_lims</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                      <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">x_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">y_scale</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">x_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">y_tick_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_latex</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot 2D histogram.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : numpy.ndarray(2d)</span>
<span class="sd">        Histogram data set provided as a numpy.ndarray(2d) of shape</span>
<span class="sd">        (n_points, 2).</span>
<span class="sd">    bins : {int, [int, int]}, default=10</span>
<span class="sd">        Histogram bins for each dimension.</span>
<span class="sd">    bins_range : np.ndarray(2d), default=None</span>
<span class="sd">        The lower and upper range of the bins along each dimension, ignoring</span>
<span class="sd">        outliers outside the provided range. The bounds for the i-th dimension</span>
<span class="sd">        are stored as [min, max] in bins_range[i, :].</span>
<span class="sd">    density : bool, default=False</span>
<span class="sd">        If True, draw and return a probability density (area under the</span>
<span class="sd">        histogram integrates to 1).</span>
<span class="sd">    title : str, default=None</span>
<span class="sd">        Plot title.</span>
<span class="sd">    x_label : str, default=None</span>
<span class="sd">        x-axis label.</span>
<span class="sd">    y_label : str, default=None</span>
<span class="sd">        y-axis label.</span>
<span class="sd">    x_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        x-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any x-axis ticks formatting.</span>
<span class="sd">    y_scale : str {&#39;linear&#39;, &#39;log&#39;}, default=&#39;linear&#39;</span>
<span class="sd">        y-axis scale. If None or invalid format, then default scale is set.</span>
<span class="sd">        Scale &#39;log&#39; overrides any y-axis ticks formatting.</span>
<span class="sd">    x_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        x-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    y_tick_format : {&#39;int&#39;, &#39;float&#39;, &#39;exp&#39;}, default=None</span>
<span class="sd">        y-axis ticks formatting. If None or invalid format, then default</span>
<span class="sd">        formatting is set.</span>
<span class="sd">    is_latex : bool, default=False</span>
<span class="sd">        If True, then render all strings in LaTeX. If LaTex is not available,</span>
<span class="sd">        then this option is silently set to False and all input strings are</span>
<span class="sd">        processed to remove $(...)$ enclosure.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    figure : Matplotlib Figure</span>
<span class="sd">        Figure.</span>
<span class="sd">    axes : Matplotlib Axes</span>
<span class="sd">        Axes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Reset matplotlib internal default style</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParamsDefault</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Check data</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Histogram data set must be provided as a &#39;</span>
                           <span class="s1">&#39;numpy.ndarray(2d) of shape (n_points, 2).&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Histogram data set must be provided as a &#39;</span>
                           <span class="s1">&#39;numpy.ndarray(2d) of shape (n_points, 2).&#39;</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set default color cycle</span>
    <span class="n">cycler_color</span> <span class="o">=</span> <span class="n">cycler</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,[</span><span class="s1">&#39;#4477AA&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE6677&#39;</span><span class="p">,</span> <span class="s1">&#39;#228833&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CCBB44&#39;</span><span class="p">,</span> <span class="s1">&#39;#66CCEE&#39;</span><span class="p">,</span> <span class="s1">&#39;#AA3377&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#BBBBBB&#39;</span><span class="p">,</span> <span class="s1">&#39;#EE7733&#39;</span><span class="p">,</span> <span class="s1">&#39;#009988&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#CC3311&#39;</span><span class="p">,</span> <span class="s1">&#39;#DDAA33&#39;</span><span class="p">,</span> <span class="s1">&#39;#999933&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;#DDCC77&#39;</span><span class="p">,</span> <span class="s1">&#39;#882255&#39;</span><span class="p">])</span>
    <span class="c1"># Set default cycler</span>
    <span class="n">default_cycler</span> <span class="o">=</span> <span class="n">cycler_color</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">prop_cycle</span> <span class="o">=</span> <span class="n">cycler_color</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    </span>
    <span class="c1"># Check LaTeX availability</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;latex&#39;</span><span class="p">)):</span>
        <span class="n">is_latex</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># Set LaTeX font</span>
    <span class="k">if</span> <span class="n">is_latex</span><span class="p">:</span>
        <span class="c1"># Default LaTeX Computer Modern Roman</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;serif&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Computer Modern Roman&#39;</span><span class="p">]})</span>        
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create figure</span>
    <span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="c1"># Set figure size (inches) - stdout print purpose</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Create axes</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Set title</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># Set axes labels</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">tex_str</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set axes scales</span>
    <span class="k">if</span> <span class="n">x_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">x_scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y_scale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">y_scale</span><span class="p">)</span>
    <span class="c1"># Set tick formatting functions</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">intTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:2d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">floatTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:3.1f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">expTickFormat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">tex_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:7.2e}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">tick_formats</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;int&#39;</span><span class="p">:</span> <span class="n">intTickFormat</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="n">floatTickFormat</span><span class="p">,</span>
                    <span class="s1">&#39;exp&#39;</span><span class="p">:</span> <span class="n">expTickFormat</span><span class="p">}</span>
    <span class="c1"># Set axes tick formats</span>
    <span class="k">if</span> <span class="n">x_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">x_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">x_tick_format</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">y_scale</span> <span class="o">!=</span> <span class="s1">&#39;log&#39;</span> <span class="ow">and</span> <span class="n">y_tick_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">tick_formats</span><span class="p">[</span><span class="n">y_tick_format</span><span class="p">]))</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Configure grid major lines</span>
    <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1"># Configure grid minor lines</span>
    <span class="n">axis_option</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;log-log&#39;</span><span class="p">:</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="s1">&#39;log-linear&#39;</span><span class="p">:</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;linear-log&#39;</span><span class="p">:</span> <span class="s1">&#39;y&#39;</span><span class="p">}</span>
    <span class="n">xy_scale</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x_scale</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y_scale</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">if</span> <span class="n">xy_scale</span> <span class="ow">in</span> <span class="n">axis_option</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis_option</span><span class="p">[</span><span class="n">xy_scale</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                  <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Plot 2D histogram</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">x_bins_edges</span><span class="p">,</span> <span class="n">y_bins_edges</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> \
        <span class="n">axes</span><span class="o">.</span><span class="n">hist2d</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">bins_range</span><span class="p">,</span>
                    <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
    <span class="c1"># Plot colorbar</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set colobar label</span>
    <span class="k">if</span> <span class="n">density</span><span class="p">:</span>
        <span class="n">colorbar_label</span> <span class="o">=</span> <span class="s1">&#39;Probability density&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colorbar_label</span> <span class="o">=</span> <span class="s1">&#39;Frequency&#39;</span>
    <span class="c1"># Plot colorbar label</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">colorbar_label</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set axes limits</span>
    <span class="k">if</span> <span class="n">x_lims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x_lims</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y_lims</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lims</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Return figure and axes handlers</span>
    <span class="k">return</span> <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="save_figure"><a class="viewcode-back" href="../../../_autosummary/hookeai.ioput.plots.save_figure.html#hookeai.ioput.plots.save_figure">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">save_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">3.6</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">save_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">is_tight_layout</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save Matplotlib figure.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    figure : Matplotlib Figure</span>
<span class="sd">        Figure.</span>
<span class="sd">    filename : str</span>
<span class="sd">        Figure name.</span>
<span class="sd">    height : float, default=3.6</span>
<span class="sd">        Figure height (inches).</span>
<span class="sd">    format : {&#39;pdf&#39;, &#39;png&#39;}, default=&#39;pdf&#39;</span>
<span class="sd">        File format.</span>
<span class="sd">    save_dir : str, default=None</span>
<span class="sd">        Directory where figure is saved. If None, then figure is saved in</span>
<span class="sd">        current working directory.</span>
<span class="sd">    is_tight_layout : bool, default=False</span>
<span class="sd">        Automatically adjust subplots to avoid overlaps.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Set figure directory</span>
    <span class="k">if</span> <span class="n">save_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">save_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">save_dir</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;The provided directory has not been found:&#39;</span>
                               <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">save_dir</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Set figure path</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="nb">format</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Get figure display size</span>
    <span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()</span>
    <span class="c1"># Get figure display size ratio</span>
    <span class="n">size_ratio</span> <span class="o">=</span> <span class="n">fig_width</span><span class="o">/</span><span class="n">fig_height</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    </span>
    <span class="c1"># Set figure size (inches)</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="n">height</span><span class="o">*</span><span class="n">size_ratio</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    </span>
    <span class="c1"># Adjust subplots to avoid overlaps</span>
    <span class="k">if</span> <span class="n">is_tight_layout</span><span class="p">:</span>
        <span class="n">figure</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Save figure</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span></div>
<span class="c1"># =============================================================================</span>
<div class="viewcode-block" id="tex_str"><a class="viewcode-back" href="../../../_autosummary/hookeai.ioput.plots.tex_str.html#hookeai.ioput.plots.tex_str">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">tex_str</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">is_latex</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Format string conveniently according with LaTeX rendering option.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : {str, None}</span>
<span class="sd">        String.</span>
<span class="sd">    is_latex : bool</span>
<span class="sd">        If False, then remove any leading or trailing dollar signs from string.</span>
<span class="sd">        If True, then keep string unchanged.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    new_x : {str, None}</span>
<span class="sd">        Formatted string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize formatted string</span>
    <span class="n">new_x</span> <span class="o">=</span> <span class="n">x</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="c1"># Format string according with LaTeX rendering option</span>
    <span class="k">if</span> <span class="n">new_x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Keep string unchanged</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">is_latex</span><span class="p">:</span>
            <span class="c1"># Keep string unchanged</span>
            <span class="n">new_x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Remove any leading or trailing dollar signs</span>
            <span class="n">new_x</span> <span class="o">=</span> <span class="n">new_x</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Input must be str or None, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
    <span class="c1"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
    <span class="k">return</span> <span class="n">new_x</span></div>




</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Bernardo Ferreira.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>